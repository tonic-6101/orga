var P=(S,f,b)=>new Promise((T,v)=>{var p=i=>{try{_(b.next(i))}catch(k){v(k)}},l=i=>{try{_(b.throw(i))}catch(k){v(k)}},_=i=>i.done?T(i.value):Promise.resolve(i.value).then(p,l);_((b=b.apply(S,f)).next())});import{d as Z,ab as Q,q as x,o as Y,b as d,c,e,i as g,t as r,u as a,_ as s,f as D,D as E,n as C,F as O,v as ee,s as $}from"./main-BV0KycqK.js";const te={class:"h-full flex flex-col bg-white dark:bg-gray-950"},ae={class:"flex justify-between items-center px-5 py-3 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900"},se={class:"text-sm font-semibold text-gray-800 dark:text-gray-100"},re={key:0,class:"flex-1 flex items-center justify-center"},oe={class:"text-center"},le={class:"text-gray-500 dark:text-gray-400"},ne={key:1,class:"flex-1 overflow-auto p-6"},ie={class:"max-w-2xl mx-auto space-y-8"},de={class:"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4 flex items-center gap-2"},ce={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4"},ue={class:"flex items-center gap-4"},ge=["disabled"],fe=["src","alt"],pe={key:1,class:"w-full h-full bg-orga-500 text-white flex items-center justify-center font-semibold text-xl"},ye={key:2,class:"absolute inset-0 bg-black/60 flex items-center justify-center"},me={key:3,class:"absolute inset-0 bg-black/50 flex flex-col items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"},xe={class:"text-white text-[9px] mt-0.5 font-medium"},be={class:"font-medium text-gray-800 dark:text-gray-100"},ve={class:"text-sm text-gray-500 dark:text-gray-400"},_e={class:"text-xs text-gray-400 dark:text-gray-500 mt-1"},ke={class:"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4 flex items-center gap-2"},he={class:"space-y-4"},we={class:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},Te={class:"font-medium text-gray-800 dark:text-gray-100"},Ue={class:"text-sm text-gray-500 dark:text-gray-400"},Ce={class:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},Fe={class:"font-medium text-gray-800 dark:text-gray-100"},Pe={class:"text-sm text-gray-500 dark:text-gray-400"},De={class:"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4 flex items-center gap-2"},Se={class:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg"},je={class:"font-medium text-gray-800 dark:text-gray-100 block mb-3"},Me={class:"grid grid-cols-3 gap-3"},Re={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Le={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Ne={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},ze={class:"text-xs text-gray-400 dark:text-gray-500 mt-3"},Ae={class:"text-gray-600 dark:text-gray-300"},Ie={class:"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4 flex items-center gap-2"},Ve={class:"space-y-4"},Be={class:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg"},Ee={class:"block"},Oe={class:"font-medium text-gray-800 dark:text-gray-100"},$e={value:"kanban"},qe={value:"list"},Xe={value:"gantt"},He={class:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg"},Je={class:"block"},Ge={class:"font-medium text-gray-800 dark:text-gray-100"},Ke={class:"text-sm text-gray-500 dark:text-gray-400 mb-2"},We={class:"text-xs text-gray-400 dark:text-gray-500"},Ze={class:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700"},Qe={key:1},Ye=["disabled"],at=Z({__name:"Preferences",setup(S){const{mode:f,isDark:b,setMode:T}=Q(),v=x(!0),p=x(!1),l=x(""),_=x(null),i=x(!1),k=x(null),y=x({notifications_enabled:!0,email_notifications:!0,default_view:"kanban",timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,language:"en"}),h=$(()=>{var t,n,U,w;const o=((n=(t=window.frappe)==null?void 0:t.boot)==null?void 0:n.user)||{};return{name:o.full_name||o.name||"User",email:o.email||o.name||"",avatar:(w=(U=k.value)!=null?U:o.user_image)!=null?w:null}}),q=$(()=>{const o=h.value.name;if(!o||o==="User")return"U";const t=o.split(" ");return t.length>=2?(t[0][0]+t[t.length-1][0]).toUpperCase():o.substring(0,2).toUpperCase()});function X(){var o;(o=_.value)==null||o.click()}function H(o){return P(this,null,function*(){var j,M,R,L,N,z;const t=o.target,n=(j=t.files)==null?void 0:j[0];if(!n)return;if(!n.type.startsWith("image/")){l.value=s("Please select an image file"),setTimeout(()=>{l.value=""},3e3),t.value="";return}if(n.size>5*1024*1024){l.value=s("Image must be smaller than 5 MB"),setTimeout(()=>{l.value=""},3e3),t.value="";return}const U=((R=(M=window.frappe)==null?void 0:M.boot)==null?void 0:R.user)||{},w=U.name||U.email;if(w){i.value=!0,l.value="";try{const m=new FormData;m.append("file",n),m.append("doctype","User"),m.append("docname",w),m.append("is_private","0");const F=yield new Promise((K,I)=>{var V;const u=new XMLHttpRequest;u.onload=()=>{var B;if(u.status>=200&&u.status<300){const W=JSON.parse(u.responseText);K(((B=W.message)==null?void 0:B.file_url)||"")}else I(new Error(`Upload failed: ${u.statusText}`))},u.onerror=()=>I(new Error("Upload failed")),u.open("POST","/api/method/upload_file"),u.setRequestHeader("X-Frappe-CSRF-Token",((V=window.frappe)==null?void 0:V.csrf_token)||""),u.send(m)});if(!F)throw new Error("No file URL returned");yield fetch("/api/method/frappe.client.set_value",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":((L=window.frappe)==null?void 0:L.csrf_token)||""},body:JSON.stringify({doctype:"User",name:w,fieldname:"user_image",value:F})}),k.value=F;const A=(z=(N=window.frappe)==null?void 0:N.boot)==null?void 0:z.user;A&&(A.user_image=F),l.value=s("Avatar updated successfully"),setTimeout(()=>{l.value=""},3e3)}catch(m){console.error("Failed to upload avatar:",m),l.value=s("Failed to upload avatar"),setTimeout(()=>{l.value=""},3e3)}finally{i.value=!1,t.value=""}}})}function J(){return P(this,null,function*(){v.value=!0;try{yield new Promise(o=>setTimeout(o,300))}catch(o){console.error("Failed to load preferences:",o)}finally{v.value=!1}})}function G(){return P(this,null,function*(){p.value=!0,l.value="";try{yield new Promise(o=>setTimeout(o,500)),l.value=s("Preferences saved successfully"),setTimeout(()=>{l.value=""},3e3)}catch(o){console.error("Failed to save preferences:",o),l.value=s("Failed to save preferences")}finally{p.value=!1}})}return Y(J),(o,t)=>(d(),c("div",te,[e("div",ae,[e("span",se,[t[6]||(t[6]=e("i",{class:"fa-solid fa-sliders text-orga-500 mr-2"},null,-1)),g(" "+r(a(s)("Preferences")),1)])]),v.value?(d(),c("div",re,[e("div",oe,[t[7]||(t[7]=e("i",{class:"fa-solid fa-spinner fa-spin text-3xl text-orga-500 mb-3"},null,-1)),e("p",le,r(a(s)("Loading preferences...")),1)])])):(d(),c("div",ne,[e("div",ie,[e("section",null,[e("h2",de,[t[8]||(t[8]=e("i",{class:"fa-solid fa-user text-orga-500"},null,-1)),g(" "+r(a(s)("Profile")),1)]),e("div",ce,[e("div",ue,[e("button",{onClick:X,disabled:i.value,class:"relative w-16 h-16 rounded-full overflow-hidden shrink-0 group cursor-pointer focus:outline-none focus:ring-2 focus:ring-orga-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 disabled:cursor-wait"},[h.value.avatar?(d(),c("img",{key:0,src:h.value.avatar,alt:h.value.name,class:"w-full h-full object-cover"},null,8,fe)):(d(),c("div",pe,r(q.value),1)),i.value?(d(),c("div",ye,[...t[9]||(t[9]=[e("i",{class:"fa-solid fa-spinner fa-spin text-white text-lg"},null,-1)])])):(d(),c("div",me,[t[10]||(t[10]=e("i",{class:"fa-solid fa-camera text-white text-sm"},null,-1)),e("span",xe,r(a(s)("Change")),1)]))],8,ge),e("input",{ref_key:"avatarInputRef",ref:_,type:"file",accept:"image/*",class:"hidden",onChange:H},null,544),e("div",null,[e("p",be,r(h.value.name),1),e("p",ve,r(h.value.email),1),e("p",_e,r(a(s)("Click the avatar to upload a new photo")),1)])])])]),e("section",null,[e("h2",ke,[t[11]||(t[11]=e("i",{class:"fa-solid fa-bell text-orga-500"},null,-1)),g(" "+r(a(s)("Notifications")),1)]),e("div",he,[e("label",we,[e("div",null,[e("p",Te,r(a(s)("In-app notifications")),1),e("p",Ue,r(a(s)("Receive notifications within the application")),1)]),D(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>y.value.notifications_enabled=n),type:"checkbox",class:"w-5 h-5 text-orga-500 rounded border-gray-300 dark:border-gray-600 focus:ring-orga-500"},null,512),[[E,y.value.notifications_enabled]])]),e("label",Ce,[e("div",null,[e("p",Fe,r(a(s)("Email notifications")),1),e("p",Pe,r(a(s)("Receive notifications via email")),1)]),D(e("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>y.value.email_notifications=n),type:"checkbox",class:"w-5 h-5 text-orga-500 rounded border-gray-300 dark:border-gray-600 focus:ring-orga-500"},null,512),[[E,y.value.email_notifications]])])])]),e("section",null,[e("h2",De,[t[12]||(t[12]=e("i",{class:"fa-solid fa-palette text-orga-500"},null,-1)),g(" "+r(a(s)("Appearance")),1)]),e("div",Se,[e("span",je,r(a(s)("Theme")),1),e("div",Me,[e("button",{onClick:t[2]||(t[2]=n=>a(T)("light")),class:C(["flex flex-col items-center gap-2 p-3 rounded-lg border-2 transition-all",a(f)==="light"?"border-orga-500 bg-orga-50 dark:bg-orga-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500"])},[t[13]||(t[13]=e("i",{class:"fa-solid fa-sun text-lg text-amber-500"},null,-1)),e("span",Re,r(a(s)("Light")),1)],2),e("button",{onClick:t[3]||(t[3]=n=>a(T)("dark")),class:C(["flex flex-col items-center gap-2 p-3 rounded-lg border-2 transition-all",a(f)==="dark"?"border-orga-500 bg-orga-50 dark:bg-orga-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500"])},[t[14]||(t[14]=e("i",{class:"fa-solid fa-moon text-lg text-indigo-400"},null,-1)),e("span",Le,r(a(s)("Dark")),1)],2),e("button",{onClick:t[4]||(t[4]=n=>a(T)("auto")),class:C(["flex flex-col items-center gap-2 p-3 rounded-lg border-2 transition-all",a(f)==="auto"?"border-orga-500 bg-orga-50 dark:bg-orga-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500"])},[t[15]||(t[15]=e("i",{class:"fa-solid fa-circle-half-stroke text-lg text-gray-500 dark:text-gray-400"},null,-1)),e("span",Ne,r(a(s)("Auto")),1)],2)]),e("p",ze,[a(f)==="auto"?(d(),c(O,{key:0},[g(r(a(s)("Follows your system preference. Currently:"))+" ",1),e("strong",Ae,r(a(b)?a(s)("Dark"):a(s)("Light")),1)],64)):(d(),c(O,{key:1},[g(r(a(s)("Theme is set to {0} mode",[a(f)])),1)],64))])])]),e("section",null,[e("h2",Ie,[t[16]||(t[16]=e("i",{class:"fa-solid fa-display text-orga-500"},null,-1)),g(" "+r(a(s)("Display")),1)]),e("div",Ve,[e("div",Be,[e("label",Ee,[e("span",Oe,r(a(s)("Default task view")),1),D(e("select",{"onUpdate:modelValue":t[5]||(t[5]=n=>y.value.default_view=n),class:"mt-2 block w-full px-3 py-2 border border-gray-200 dark:border-gray-600 rounded-lg text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:border-orga-500 focus:ring-1 focus:ring-orga-500"},[e("option",$e,r(a(s)("Kanban Board")),1),e("option",qe,r(a(s)("List View")),1),e("option",Xe,r(a(s)("Gantt Chart")),1)],512),[[ee,y.value.default_view]])])]),e("div",He,[e("label",Je,[e("span",Ge,r(a(s)("Timezone")),1),e("p",Ke,r(y.value.timezone),1),e("p",We,r(a(s)("Timezone is detected from your browser")),1)])])])]),e("div",Ze,[l.value?(d(),c("p",{key:0,class:C(["text-sm",l.value.includes("success")?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"])},r(l.value),3)):(d(),c("div",Qe)),e("button",{onClick:G,disabled:p.value,class:"px-4 py-2 bg-orga-500 text-white rounded-lg hover:bg-orga-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[e("i",{class:C(["fa-solid",p.value?"fa-spinner fa-spin":"fa-check"])},null,2),g(" "+r(p.value?a(s)("Saving..."):a(s)("Save Preferences")),1)],8,Ye)])])]))]))}});export{at as default};
