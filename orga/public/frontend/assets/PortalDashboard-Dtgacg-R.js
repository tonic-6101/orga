var D=(k,y,m)=>new Promise((p,b)=>{var _=c=>{try{d(m.next(c))}catch(f){b(f)}},x=c=>{try{d(m.throw(c))}catch(f){b(f)}},d=c=>c.done?p(c.value):Promise.resolve(c.value).then(_,x);d((m=m.apply(k,y)).next())});import{u as B}from"./usePortalApi-BiT1X6gW.js";import{d as E,o as H,b as a,c as n,u as l,e,t as s,_ as r,p as g,F as A,r as L,n as h,i as u,k as V,I as N,E as F,h as R,B as U,q as v,s as Y,P as $,H as z}from"./main-BV0KycqK.js";import{P as I,H as M}from"./portal-1JhjUazr.js";const q={key:0,class:"flex items-center justify-center py-12"},J={class:"text-center"},W={class:"text-gray-500"},G={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-6"},K={class:"flex items-center gap-3"},Q={class:"text-red-800 font-medium"},X={class:"text-red-600 text-sm"},Z={key:2},j={class:"mb-6"},ee={class:"text-2xl font-bold text-gray-800 mb-1"},te={key:0,class:"text-gray-500"},se={class:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8"},oe={class:"text-xs text-gray-500 uppercase mb-2"},ae={class:"mb-4"},le={class:"text-lg font-semibold text-gray-800 flex items-center gap-2"},re={key:0,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4"},ne={class:"p-4 pb-2"},ie={class:"flex items-start justify-between mb-2"},de={class:"text-base font-semibold text-gray-800 mb-1 line-clamp-1"},ce={key:0,class:"text-sm text-gray-500 line-clamp-2 mb-3"},ue={class:"px-4 pb-4"},me={class:"mb-3"},_e={class:"flex justify-between items-center mb-1"},ge={class:"text-xs text-gray-500"},xe={class:"text-sm font-semibold text-gray-700"},fe={class:"h-2 bg-gray-100 rounded-full overflow-hidden"},pe={class:"flex items-center justify-between text-sm text-gray-500 mb-2"},be={key:0},he={key:0,class:"bg-blue-50 border border-blue-100 rounded p-2 text-sm"},ye={class:"font-medium text-blue-700"},ve={class:"text-blue-600 ml-1"},ke={key:0,class:"text-blue-400 text-xs ml-1"},we={key:1,class:"text-center py-12 bg-white rounded-lg border border-gray-200"},Ce={class:"text-lg font-medium text-gray-800 mb-2"},Pe={class:"text-gray-500 mb-4"},Se=E({__name:"PortalDashboard",setup(k){const{getPortalDashboard:y,loading:m,error:p}=B(),{user:b}=U(),_=v(null),x=v([]),d=v(null);H(()=>D(null,null,function*(){try{const i=yield y();_.value=i.client,x.value=i.projects,d.value=i.stats}catch(i){console.error("Failed to load portal dashboard:",i)}}));function c(i){return I[i]||"bg-gray-100 text-gray-600"}function f(i){return i&&M[i]||"bg-gray-100 text-gray-500"}function w(i){return i?new Date(i).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):""}const O=Y(()=>d.value?[{label:r("Total Projects"),value:d.value.total_projects,icon:"fa-folder",color:"text-orga-500"},{label:r("Active"),value:d.value.active_projects,icon:"fa-play-circle",color:"text-blue-500"},{label:r("Completed"),value:d.value.completed_projects,icon:"fa-check-circle",color:"text-green-500"},{label:r("Overall Progress"),value:`${d.value.overall_progress}%`,icon:"fa-chart-line",color:"text-purple-500"}]:[]);return(i,o)=>{var P,S,T;const C=$("router-link");return a(),n("div",null,[l(m)?(a(),n("div",q,[e("div",J,[o[0]||(o[0]=e("i",{class:"fa-solid fa-spinner fa-spin text-3xl text-orga-500 mb-3"},null,-1)),e("p",W,s(l(r)("Loading your portal...")),1)])])):l(p)?(a(),n("div",G,[e("div",K,[o[1]||(o[1]=e("i",{class:"fa-solid fa-exclamation-triangle text-red-500 text-xl"},null,-1)),e("div",null,[e("h3",Q,s(l(r)("Error loading dashboard")),1),e("p",X,s(l(p)),1)])])])):(a(),n("div",Z,[e("div",j,[e("h1",ee,s(l(r)("Welcome, {0}",[((P=_.value)==null?void 0:P.client_name)||((S=l(b))==null?void 0:S.full_name)||l(r)("Client")])),1),(T=_.value)!=null&&T.company?(a(),n("p",te,s(_.value.company),1)):g("",!0)]),e("div",se,[(a(!0),n(A,null,L(O.value,t=>(a(),n("div",{key:t.label,class:"bg-white rounded-lg p-5 border border-gray-200 shadow-sm"},[e("i",{class:h(["fa-solid float-right text-2xl opacity-30",t.icon,t.color])},null,2),e("div",oe,s(t.label),1),e("div",{class:h(["text-3xl font-bold",t.color])},s(t.value),3)]))),128))]),e("div",ae,[e("h2",le,[o[2]||(o[2]=e("i",{class:"fa-solid fa-folder-open text-orga-500"},null,-1)),u(" "+s(l(r)("Your Projects")),1)])]),x.value.length?(a(),n("div",re,[(a(!0),n(A,null,L(x.value,t=>(a(),V(C,{key:t.name,to:`/orga/portal/project/${t.name}`,class:"block bg-white rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow no-underline"},{default:N(()=>[e("div",ne,[e("div",ie,[e("span",{class:h(["px-2 py-1 text-xs font-medium rounded-full",c(t.status)])},s(t.status),3),t.health_status?(a(),n("span",{key:0,class:h(["px-2 py-1 text-xs font-medium rounded-full",f(t.health_status)])},[o[3]||(o[3]=e("i",{class:"fa-solid fa-heart mr-1"},null,-1)),u(" "+s(t.health_status),1)],2)):g("",!0)]),e("h3",de,s(t.project_name),1),t.description?(a(),n("p",ce,s(t.description),1)):g("",!0)]),e("div",ue,[e("div",me,[e("div",_e,[e("span",ge,s(l(r)("Progress")),1),e("span",xe,s(Math.round(t.progress||0))+"%",1)]),e("div",fe,[e("div",{class:"h-full bg-orga-500 rounded-full transition-all",style:F({width:`${t.progress||0}%`})},null,4)])]),e("div",pe,[e("span",null,[o[4]||(o[4]=e("i",{class:"fa-solid fa-check-circle text-green-500 mr-1"},null,-1)),u(" "+s(l(r)("{0}/{1} tasks",[t.completed_tasks,t.task_count])),1)]),t.end_date?(a(),n("span",be,[o[5]||(o[5]=e("i",{class:"fa-regular fa-calendar mr-1"},null,-1)),u(" "+s(w(t.end_date)),1)])):g("",!0)]),t.upcoming_milestone?(a(),n("div",he,[o[6]||(o[6]=e("i",{class:"fa-solid fa-flag text-blue-500 mr-1"},null,-1)),e("span",ye,s(l(r)("Next:")),1),e("span",ve,s(t.upcoming_milestone.milestone_name),1),t.upcoming_milestone.due_date?(a(),n("span",ke," ("+s(w(t.upcoming_milestone.due_date))+") ",1)):g("",!0)])):g("",!0)])]),_:2},1032,["to"]))),128))])):(a(),n("div",we,[o[9]||(o[9]=e("i",{class:"fa-solid fa-folder-open text-5xl text-gray-300 mb-4"},null,-1)),e("h3",Ce,s(l(r)("No Projects Yet")),1),e("p",Pe,[u(s(l(r)("Your projects will appear here once they're assigned to you.")),1),o[7]||(o[7]=e("br",null,null,-1)),u(" "+s(l(r)("Contact your project manager for more information.")),1)]),R(C,{to:"/orga/portal/support",class:"inline-flex items-center gap-2 px-4 py-2 bg-orga-500 text-white rounded hover:bg-orga-600 no-underline"},{default:N(()=>[o[8]||(o[8]=e("i",{class:"fa-solid fa-headset"},null,-1)),u(" "+s(l(r)("Contact Support")),1)]),_:1})]))]))])}}}),Ne=z(Se,[["__scopeId","data-v-d90aa0f7"]]);export{Ne as default};
