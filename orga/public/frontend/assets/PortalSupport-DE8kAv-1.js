var w=(S,_,b)=>new Promise((h,x)=>{var d=a=>{try{i(b.next(a))}catch(n){x(n)}},c=a=>{try{i(b.throw(a))}catch(n){x(n)}},i=a=>a.done?h(a.value):Promise.resolve(a.value).then(d,c);i((b=b.apply(S,_)).next())});import{d as M,o as N,b as g,c as v,e,t as o,u as r,_ as s,p as j,i as p,f as k,v as T,F as A,r as E,g as P,n as U,h as z,I as D,j as O,O as W,q as m,s as C,P as H,B as I}from"./main-BV0KycqK.js";import{u as L}from"./usePortalApi-BiT1X6gW.js";const Y={class:"max-w-2xl mx-auto"},G={class:"text-center mb-8"},J={class:"text-2xl font-bold text-gray-800 mb-2"},K={class:"text-gray-500"},Q={key:0,class:"bg-green-50 border border-green-200 rounded-lg p-6 mb-6"},X={class:"flex items-center gap-3"},Z={class:"text-green-800 font-medium"},$={class:"text-green-600 text-sm"},ee={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},te={class:"flex items-center gap-3"},se={class:"text-red-600"},oe={key:2,class:"bg-white rounded-lg border border-gray-200 shadow-sm"},re={for:"project",class:"block text-sm font-medium text-gray-700 mb-1"},ae={class:"text-gray-400"},le={value:""},ne=["value"],ie={class:"text-xs text-gray-500 mt-1"},ue={for:"subject",class:"block text-sm font-medium text-gray-700 mb-1"},de=["placeholder"],ce={for:"message",class:"block text-sm font-medium text-gray-700 mb-1"},pe=["placeholder"],me={class:"bg-gray-50 rounded p-3"},be={class:"text-sm text-gray-500"},ge={class:"text-gray-700"},ve={class:"space-y-3 pt-4 border-t border-gray-200"},fe=["disabled"],xe={class:"text-center mt-8"},ye={class:"text-gray-500 text-sm mb-1"},_e={class:"text-gray-400 text-xs"},ke=M({__name:"PortalSupport",setup(S){const _=W(),{getClientProjects:b,submitSupportRequest:h}=L(),{user:x}=I(),d=m(""),c=m(""),i=m(""),a=m([]),n=m(!1),y=m(!1),f=m("");N(()=>w(null,null,function*(){try{a.value=yield b();const l=_.query.project;l&&a.value.some(t=>t.name===l)&&(i.value=l)}catch(l){console.error("Failed to load projects:",l)}}));const V=C(()=>{var l;return((l=x.value)==null?void 0:l.email)||s("your registered email")}),q=C(()=>d.value.trim().length>0&&c.value.trim().length>0);function F(){return w(this,null,function*(){if(!(!q.value||n.value)){n.value=!0,f.value="";try{yield h(d.value.trim(),c.value.trim(),i.value||void 0),y.value=!0,d.value="",c.value="",i.value="",window.scrollTo({top:0,behavior:"smooth"})}catch(l){f.value=s("Failed to submit request. Please try again."),console.error("Support request error:",l)}finally{n.value=!1}}})}function B(){y.value=!1,f.value=""}return(l,t)=>{const R=H("router-link");return g(),v("div",Y,[e("div",G,[t[3]||(t[3]=e("div",{class:"mb-4"},[e("i",{class:"fa-solid fa-headset text-5xl text-orga-500"})],-1)),e("h1",J,o(r(s)("Contact Support")),1),e("p",K,o(r(s)("Have a question or need assistance? Fill out the form below and our team will get back to you.")),1)]),y.value?(g(),v("div",Q,[e("div",X,[t[4]||(t[4]=e("i",{class:"fa-solid fa-check-circle text-green-500 text-2xl"},null,-1)),e("div",null,[e("h3",Z,o(r(s)("Request Submitted!")),1),e("p",$,o(r(s)("Your support request has been submitted successfully. We'll get back to you shortly.")),1)])]),e("button",{onClick:B,class:"mt-4 px-4 py-2 bg-green-100 text-green-700 rounded hover:bg-green-200"},o(r(s)("Submit Another Request")),1)])):j("",!0),f.value?(g(),v("div",ee,[e("div",te,[t[5]||(t[5]=e("i",{class:"fa-solid fa-exclamation-circle text-red-500"},null,-1)),e("span",se,o(f.value),1)])])):j("",!0),y.value?j("",!0):(g(),v("div",oe,[e("form",{onSubmit:O(F,["prevent"]),class:"p-6 space-y-6"},[e("div",null,[e("label",re,[p(o(r(s)("Related Project"))+" ",1),e("span",ae,"("+o(r(s)("optional"))+")",1)]),k(e("select",{id:"project","onUpdate:modelValue":t[0]||(t[0]=u=>i.value=u),class:"w-full px-3 py-2 border border-gray-200 rounded focus:border-orga-500 focus:outline-none"},[e("option",le,o(r(s)("-- Select a project --")),1),(g(!0),v(A,null,E(a.value,u=>(g(),v("option",{key:u.name,value:u.name},o(u.project_name),9,ne))),128))],512),[[T,i.value]]),e("p",ie,o(r(s)("Select a project if your request is related to a specific project.")),1)]),e("div",null,[e("label",ue,[p(o(r(s)("Subject"))+" ",1),t[6]||(t[6]=e("span",{class:"text-red-500"},"*",-1))]),k(e("input",{id:"subject","onUpdate:modelValue":t[1]||(t[1]=u=>d.value=u),type:"text",required:"",placeholder:r(s)("Brief description of your request"),class:"w-full px-3 py-2 border border-gray-200 rounded focus:border-orga-500 focus:outline-none"},null,8,de),[[P,d.value]])]),e("div",null,[e("label",ce,[p(o(r(s)("Message"))+" ",1),t[7]||(t[7]=e("span",{class:"text-red-500"},"*",-1))]),k(e("textarea",{id:"message","onUpdate:modelValue":t[2]||(t[2]=u=>c.value=u),rows:"6",required:"",placeholder:r(s)("Please describe your question or issue in detail..."),class:"w-full px-3 py-2 border border-gray-200 rounded focus:border-orga-500 focus:outline-none resize-none"},null,8,pe),[[P,c.value]])]),e("div",me,[e("p",be,[t[8]||(t[8]=e("i",{class:"fa-solid fa-info-circle mr-1"},null,-1)),p(" "+o(r(s)("We'll respond to:"))+" ",1),e("strong",ge,o(V.value),1)])]),e("div",ve,[e("button",{type:"submit",disabled:!q.value||n.value,class:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-orga-500 text-white rounded-lg hover:bg-orga-600 disabled:opacity-50 disabled:cursor-not-allowed"},[e("i",{class:U(["fa-solid",n.value?"fa-spinner fa-spin":"fa-paper-plane"])},null,2),p(" "+o(n.value?r(s)("Submitting..."):r(s)("Submit Request")),1)],8,fe),z(R,{to:"/orga/portal",class:"block w-full text-center px-4 py-2 text-gray-600 border border-gray-200 rounded-lg hover:bg-gray-50 no-underline"},{default:D(()=>[t[9]||(t[9]=e("i",{class:"fa-solid fa-arrow-left mr-2"},null,-1)),p(" "+o(r(s)("Back to Portal")),1)]),_:1})])],32)])),e("div",xe,[e("p",ye,[t[10]||(t[10]=e("i",{class:"fa-solid fa-envelope mr-1"},null,-1)),p(" "+o(r(s)("Or email us directly at"))+" ",1),t[11]||(t[11]=e("a",{href:"mailto:support@orga.localhost",class:"text-orga-500 hover:underline"}," support@orga.localhost ",-1))]),e("p",_e,o(r(s)("Typical response time: 1-2 business days")),1)])])}}});export{ke as default};
