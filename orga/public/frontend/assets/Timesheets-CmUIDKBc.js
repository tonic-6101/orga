var w=(V,j,m)=>new Promise(($,p)=>{var F=u=>{try{c(m.next(u))}catch(x){p(x)}},A=u=>{try{c(m.throw(u))}catch(x){p(x)}},c=u=>u.done?$(u.value):Promise.resolve(u.value).then(F,A);c((m=m.apply(V,j)).next())});import{d as ot,Q as nt,Y as lt,w as O,o as dt,b as d,c as i,e as t,t as o,u as l,_ as n,p as T,i as M,F as D,r as L,n as P,f as Y,v as q,h as it,a3 as ct,q as g,s as S,Z as ut,z as gt}from"./main-BV0KycqK.js";const xt={class:"p-6 bg-white dark:bg-gray-950 min-h-full"},yt={class:"flex justify-between items-center mb-6"},mt={class:"flex items-center gap-4"},pt={class:"text-2xl font-semibold text-gray-800 dark:text-gray-100 m-0"},ft={key:0,class:"flex items-center gap-2 px-3 py-1.5 bg-orga-50 dark:bg-orga-950/30 border border-orga-200 dark:border-orga-800 rounded-lg"},_t={class:"text-sm text-orga-700 dark:text-orga-300 font-medium"},vt={class:"text-sm text-orga-600 dark:text-orga-400 font-mono"},bt={class:"mb-6 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden"},kt={class:"p-4"},ht={class:"flex items-center justify-between mb-3"},wt={class:"flex items-center gap-2"},Tt={class:"font-semibold text-gray-800 dark:text-gray-100 text-sm"},jt={key:0,class:"flex items-center gap-3 text-sm text-gray-500 dark:text-gray-400"},Ct={class:"font-medium text-gray-800 dark:text-gray-200"},Dt={key:0,class:"py-4 text-center"},Lt={key:1,class:"py-4 text-center"},St={class:"text-sm text-gray-400 dark:text-gray-500 m-0"},$t={key:2,class:"flex flex-wrap gap-2"},Ft={class:"text-sm text-gray-700 dark:text-gray-300 truncate max-w-[180px]"},At={class:"text-sm font-medium text-gray-800 dark:text-gray-200"},Ht={class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden"},Nt={class:"p-4 border-b border-gray-200 dark:border-gray-700"},Wt={class:"flex items-center justify-between flex-wrap gap-3"},Mt={class:"flex items-center gap-2"},Pt={class:"text-sm font-semibold text-gray-800 dark:text-gray-100 min-w-[140px] text-center"},Vt={class:"ml-3 text-sm text-gray-500 dark:text-gray-400"},Bt={class:"font-medium text-gray-700 dark:text-gray-300"},Et={class:"flex items-center gap-2"},Ut={value:""},zt=["value"],It={value:""},Ot={value:"task"},Yt={value:"event"},qt={value:"project"},Rt={value:"standalone"},Qt={key:0,class:"p-8 text-center"},Zt={class:"text-sm text-gray-400 mt-2 m-0"},Gt={key:1,class:"p-8 text-center"},Jt={class:"text-gray-500 dark:text-gray-400 m-0"},Kt={key:2},Xt={class:"flex items-center justify-between px-4 py-2 bg-gray-50 dark:bg-gray-700/50 border-b border-gray-200 dark:border-gray-700"},te={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},ee={class:"text-xs font-medium text-gray-600 dark:text-gray-300"},ae={class:"w-full"},se={class:"px-4 py-3 w-10"},re={class:"py-3 pr-4"},oe={class:"text-sm text-gray-800 dark:text-gray-200 m-0 truncate"},ne={key:0,class:"text-xs text-gray-500 dark:text-gray-400 m-0 truncate mt-0.5"},le={class:"py-3 pr-4 hidden md:table-cell"},de={key:0,class:"text-xs text-gray-500 dark:text-gray-400 truncate"},ie={key:1,class:"text-xs text-gray-300 dark:text-gray-600"},ce={class:"py-3 pr-4 text-right w-20"},ue={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},ge={class:"py-3 pr-4 w-8"},xe=["title"],ye=50,fe=ot({__name:"Timesheets",setup(V){const j=ut(),m=gt(),{currencyIcon:$}=nt(),{timerState:p,formattedTime:F,stopTimer:A}=lt(),c=g(null),u=g(!1),x=g([]),R=g(0),H=g(!1),B=g([]),f=g(!1),y=g(0),_=g(""),v=g(""),E=S(()=>{const e=new Date,a=e.getDay(),s=a===0?-6:1-a,r=new Date(e);r.setDate(e.getDate()+s+y.value*7),r.setHours(0,0,0,0);const h=new Date(r);return h.setDate(r.getDate()+6),h.setHours(23,59,59,999),{start:r,end:h}}),Q=S(()=>{if(y.value===0)return n("This Week");if(y.value===-1)return n("Last Week");if(y.value===1)return n("Next Week");const{start:e,end:a}=E.value;return`${U(e)} - ${U(a)}`}),Z=S(()=>x.value.reduce((e,a)=>e+(a.hours||0),0)),G=S(()=>{const e=new Map;for(const s of x.value){const r=s.log_date||"";e.has(r)||e.set(r,[]),e.get(r).push(s)}return[...e.entries()].sort((s,r)=>r[0].localeCompare(s[0])).map(([s,r])=>({date:s,dateLabel:J(s),logs:r,totalHours:r.reduce((h,rt)=>h+(rt.hours||0),0)}))});function C(e){const a=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${a}-${s}-${r}`}function U(e){return e.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}function J(e){const a=new Date(e+"T00:00:00"),s=new Date,r=new Date;return r.setDate(s.getDate()-1),e===C(s)?n("Today"):e===C(r)?n("Yesterday"):a.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}function b(e){if(e>=1)return`${e.toFixed(1)}h`;const a=Math.round(e*60);return a>0?`${a}m`:e>0?"< 1m":"0m"}function z(e){switch(e){case"task":return"fa-check-square";case"event":return"fa-calendar";case"project":return"fa-folder";default:return"fa-clock"}}function I(e){switch(e){case"task":return"text-orga-500";case"event":return"text-purple-500";case"project":return"text-blue-500";default:return"text-gray-400"}}function N(e){return e.task_subject?e.task_subject:e.event_subject?e.event_subject:e.project_name?e.project_name:e.description||n("Standalone")}function W(){return w(this,null,function*(){u.value=!0;try{c.value=yield j.getTodaySummary()}catch(e){console.error("Failed to load today summary:",e)}finally{u.value=!1}})}function k(){return w(this,null,function*(){H.value=!0;try{const e={limit:ye,offset:0},{start:a,end:s}=E.value;e.from_date=C(a),e.to_date=C(s),_.value&&(e.project=_.value),v.value&&(e.tracking_context=v.value);const r=yield j.getTimeLogs(e);x.value=(r==null?void 0:r.logs)||[],R.value=(r==null?void 0:r.total)||0}catch(e){console.error("Failed to load time logs:",e),x.value=[]}finally{H.value=!1}})}function K(){return w(this,null,function*(){try{const e=yield m.getProjects({limit:100});B.value=(e==null?void 0:e.projects)||[]}catch(e){console.error("Failed to load projects:",e)}})}function X(){y.value--}function tt(){y.value++}function et(){y.value=0}function at(){return w(this,null,function*(){try{yield A(),W(),k()}catch(e){console.error("Failed to stop timer:",e)}})}function st(){W(),k()}return O(y,()=>{k()}),O([_,v],()=>{k()}),dt(()=>{K(),W(),k()}),(e,a)=>(d(),i("div",xt,[t("div",yt,[t("div",mt,[t("h1",pt,o(l(n)("Timesheets")),1),l(p).isRunning?(d(),i("div",ft,[a[6]||(a[6]=t("span",{class:"relative flex h-2 w-2"},[t("span",{class:"animate-ping absolute inline-flex h-full w-full rounded-full bg-orga-400 opacity-75"}),t("span",{class:"relative inline-flex rounded-full h-2 w-2 bg-orga-500"})],-1)),t("span",_t,o(l(p).contextLabel),1),t("span",vt,o(l(F)),1),t("button",{onClick:at,class:"ml-1 px-2 py-0.5 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors"},o(l(n)("Stop")),1)])):T("",!0)]),t("button",{onClick:a[0]||(a[0]=s=>f.value=!0),class:"px-4 py-2 bg-orga-500 text-white rounded hover:bg-orga-600 flex items-center gap-2"},[a[7]||(a[7]=t("i",{class:"fa-solid fa-plus"},null,-1)),M(" "+o(l(n)("Log Time")),1)])]),t("div",bt,[t("div",kt,[t("div",ht,[t("div",wt,[a[8]||(a[8]=t("i",{class:"fa-solid fa-stopwatch text-orga-500"},null,-1)),t("span",Tt,o(l(n)("Today")),1)]),c.value&&c.value.log_count>0?(d(),i("div",jt,[t("span",Ct,o(b(c.value.total_hours)),1),t("span",null,"Â· "+o(c.value.log_count===1?l(n)("1 entry"):l(n)("{0} entries",[c.value.log_count])),1)])):T("",!0)]),u.value?(d(),i("div",Dt,[...a[9]||(a[9]=[t("i",{class:"fa-solid fa-spinner fa-spin text-gray-400"},null,-1)])])):!c.value||c.value.log_count===0?(d(),i("div",Lt,[t("p",St,o(l(n)("No time logged today")),1),t("button",{onClick:a[1]||(a[1]=s=>f.value=!0),class:"mt-2 text-xs text-orga-500 dark:text-orga-400 hover:text-orga-600 dark:hover:text-orga-300 font-medium"}," + "+o(l(n)("Log Time")),1)])):(d(),i("div",$t,[(d(!0),i(D,null,L(c.value.logs,s=>(d(),i("div",{key:s.name,class:"flex items-center gap-2 px-3 py-2 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},[t("i",{class:P(["fa-solid text-xs w-3 text-center",z(s.tracking_context),I(s.tracking_context)])},null,2),t("span",Ft,o(N(s)),1),t("span",At,o(b(s.hours)),1)]))),128))]))])]),t("div",Ht,[t("div",Nt,[t("div",Wt,[t("div",Mt,[t("button",{onClick:X,class:"px-2.5 py-1.5 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 text-sm"},[...a[10]||(a[10]=[t("i",{class:"fa-solid fa-chevron-left text-xs"},null,-1)])]),y.value!==0?(d(),i("button",{key:0,onClick:et,class:"px-2.5 py-1.5 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 text-xs"},o(l(n)("Today")),1)):T("",!0),t("span",Pt,o(Q.value),1),t("button",{onClick:tt,class:"px-2.5 py-1.5 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 text-sm"},[...a[11]||(a[11]=[t("i",{class:"fa-solid fa-chevron-right text-xs"},null,-1)])]),t("span",Vt,[M(o(l(n)("Total"))+": ",1),t("span",Bt,o(b(Z.value)),1)])]),t("div",Et,[Y(t("select",{"onUpdate:modelValue":a[2]||(a[2]=s=>_.value=s),class:"px-3 py-1.5 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded text-sm text-gray-900 dark:text-gray-100 focus:outline-none focus:border-orga-500"},[t("option",Ut,o(l(n)("All Projects")),1),(d(!0),i(D,null,L(B.value,s=>(d(),i("option",{key:s.name,value:s.name},o(s.project_name),9,zt))),128))],512),[[q,_.value]]),Y(t("select",{"onUpdate:modelValue":a[3]||(a[3]=s=>v.value=s),class:"px-3 py-1.5 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded text-sm text-gray-900 dark:text-gray-100 focus:outline-none focus:border-orga-500"},[t("option",It,o(l(n)("All Contexts")),1),t("option",Ot,o(l(n)("Task")),1),t("option",Yt,o(l(n)("Event")),1),t("option",qt,o(l(n)("Project")),1),t("option",Rt,o(l(n)("Standalone")),1)],512),[[q,v.value]])])])]),H.value?(d(),i("div",Qt,[a[12]||(a[12]=t("i",{class:"fa-solid fa-spinner fa-spin text-gray-400 text-lg"},null,-1)),t("p",Zt,o(l(n)("Loading time logs...")),1)])):x.value.length===0?(d(),i("div",Gt,[a[14]||(a[14]=t("i",{class:"fa-regular fa-clock text-3xl text-gray-300 dark:text-gray-600 mb-3"},null,-1)),t("p",Jt,o(l(n)("No time logs for this period")),1),t("button",{onClick:a[4]||(a[4]=s=>f.value=!0),class:"mt-3 px-4 py-1.5 bg-orga-500 text-white text-xs font-medium rounded-lg hover:bg-orga-600 transition-colors inline-flex items-center gap-1.5"},[a[13]||(a[13]=t("i",{class:"fa-solid fa-plus text-[10px]"},null,-1)),M(" "+o(l(n)("Log Time")),1)])])):(d(),i("div",Kt,[(d(!0),i(D,null,L(G.value,s=>(d(),i("div",{key:s.date},[t("div",Xt,[t("span",te,o(s.dateLabel),1),t("span",ee,o(b(s.totalHours)),1)]),t("table",ae,[t("tbody",null,[(d(!0),i(D,null,L(s.logs,r=>(d(),i("tr",{key:r.name,class:"border-b border-gray-100 dark:border-gray-700/50 hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors"},[t("td",se,[t("i",{class:P(["fa-solid text-sm",z(r.tracking_context),I(r.tracking_context)])},null,2)]),t("td",re,[t("p",oe,o(N(r)),1),r.description&&r.description!==N(r)?(d(),i("p",ne,o(r.description),1)):T("",!0)]),t("td",le,[r.project_name?(d(),i("span",de,o(r.project_name),1)):(d(),i("span",ie,"-"))]),t("td",ce,[t("span",ue,o(b(r.hours)),1)]),t("td",ge,[r.billable?(d(),i("span",{key:0,class:"text-xs text-green-600 dark:text-green-400",title:l(n)("Billable")},[t("i",{class:P(l($))},null,2)],8,xe)):T("",!0)])]))),128))])])]))),128))]))]),it(ct,{show:f.value,onClose:a[5]||(a[5]=s=>f.value=!1),onCreated:st},null,8,["show"])]))}});export{fe as default};
