import{al as B,am as S,an as W,d as P,ao as H,ap as M,b as g,c as p,n as _,t as D,p as N,e as b,aq as q,u as n,q as r,s as x,o as G,a as K,a6 as O,ah as j,ai as F,h as I,I as V,ar as z,i as E,L as J,as as $,at as T,au as Q,av as X,M as Y,aw as A}from"./main-BV0KycqK.js";const L=B;L.Title=S;L.Description=W;const Z={class:"space-y-1.5"},ee=["for"],ae=["placeholder","disabled","id","value","rows"],te=P({__name:"Textarea",props:{size:{default:"sm"},variant:{default:"subtle"},placeholder:{},disabled:{type:Boolean},id:{},modelValue:{},debounce:{},rows:{default:3},label:{}},emits:["update:modelValue"],setup(s,{expose:d,emit:c}){const e=s,i=c,y=H(),v=r(null),h=x(()=>{let o={sm:"text-base rounded",md:"text-base rounded",lg:"text-lg rounded-md",xl:"text-xl rounded-md"}[e.size],u={sm:["py-1.5 px-2"],md:["py-1.5 px-2.5"],lg:["py-1.5 px-3"],xl:["py-1.5 px-3"]}[e.size],m=e.disabled?"disabled":e.variant,w={subtle:"border border-[--surface-gray-2] bg-surface-gray-2 placeholder-ink-gray-4 hover:border-outline-gray-modals hover:bg-surface-gray-3 focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3",outline:"border border-outline-gray-2 bg-surface-white placeholder-ink-gray-4 hover:border-outline-gray-3 hover:shadow-sm focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3",disabled:["border bg-surface-gray-1 placeholder-ink-gray-3",e.variant==="outline"?"border-outline-gray-2":"border-transparent"]}[m];return[o,u,w,e.disabled?"text-ink-gray-5":"text-ink-gray-8","transition-colors w-full block"]}),k=x(()=>[{sm:"text-xs",md:"text-base",lg:"text-lg",xl:"text-xl"}[e.size],"text-ink-gray-5"]);let f=o=>{i("update:modelValue",o)};e.debounce&&(f=M(f,e.debounce));let l=o=>{f(o.target.value)};return d({el:v}),(o,u)=>(g(),p("div",Z,[s.label?(g(),p("label",{key:0,class:_(["block",k.value]),for:s.id},D(s.label),11,ee)):N("",!0),b("textarea",q({ref_key:"textareaRef",ref:v,placeholder:s.placeholder,class:h.value,disabled:s.disabled,id:s.id,value:s.modelValue,rows:s.rows,onInput:u[0]||(u[0]=(...m)=>n(l)&&n(l)(...m)),onChange:u[1]||(u[1]=(...m)=>n(l)&&n(l)(...m))},n(y)),null,16,ae)]))}}),se={class:"space-y-4"},le={key:0,class:"text-red-500 text-sm mt-1"},oe={key:1,class:"text-ink-green-3 text-sm mt-1"},re={class:"flex justify-end space-x-2"},ie=P({__name:"InsertIframe",props:{editor:{}},setup(s){const d=s,c=r(!1),e=r(""),i=r(""),y=r(""),v=r("center"),h=r(640),k=r(360),f=r(),l=x(()=>{if(!e.value)return!1;try{if(e.value.trim().startsWith("<iframe")){const a=e.value.match(/src=["']([^"']+)["']/);return a!=null&&a[1]?$(a[1],{allowedDomains:T,HTMLAttributes:{}}):!1}return $(e.value,{allowedDomains:T,HTMLAttributes:{}})}catch(a){return!1}}),o=x(()=>{if(!e.value)return"";if(e.value.trim().startsWith("<iframe")){const a=e.value.match(/src=["']([^"']+)["']/);return a!=null&&a[1]?A(a[1]):e.value}return A(e.value)}),u=x(()=>{if(!e.value||!l.value)return{platform:"Generic",aspectRatio:9/16};const a=Q(o.value),t=X(o.value);return{platform:(a==null?void 0:a.name)||"Generic",aspectRatio:t.ratio}});function m(){i.value="",e.value&&(l.value||(i.value="Please enter a supported URL or iframe embed code"))}function w(){c.value=!0,e.value="",i.value="",y.value="",v.value="center",h.value=640,k.value=360,Y(()=>{var a,t;(t=(a=f.value)==null?void 0:a.el)==null||t.focus()})}function U(){if(!e.value||!l.value)return;d.editor.commands.setIframe({src:o.value,width:h.value,height:k.value,title:y.value,align:v.value})?(c.value=!1,d.editor.commands.focus()):i.value="Failed to insert embed. Please check the URL and try again."}function R(a){var t;((t=a.detail)==null?void 0:t.editor)===d.editor&&w()}return G(()=>{d.editor.view.dom.addEventListener("iframe:open-dialog",R)}),K(()=>{d.editor.view.dom.removeEventListener("iframe:open-dialog",R)}),(a,t)=>(g(),p("div",null,[O(a.$slots,"default",j(F({onClick:w}))),I(n(L),{modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=C=>c.value=C),options:{title:"Insert Embed",size:"md"}},{"body-content":V(()=>[b("div",se,[b("div",null,[t[3]||(t[3]=b("label",{class:"block text-sm font-medium text-ink-gray-7 mb-2"}," URL or Embed Code ",-1)),I(n(te),{ref_key:"urlInput",ref:f,modelValue:e.value,"onUpdate:modelValue":t[0]||(t[0]=C=>e.value=C),placeholder:"https://youtube.com/watch?v=... or <iframe src=...>",onKeydown:J(U,["enter"]),onInput:m},null,8,["modelValue"]),i.value?(g(),p("p",le,D(i.value),1)):e.value&&l.value?(g(),p("p",oe," âœ“ Valid "+D(u.value.platform)+" URL ",1)):N("",!0)])])]),actions:V(()=>[b("div",re,[I(n(z),{variant:"subtle",onClick:t[1]||(t[1]=C=>c.value=!1)},{default:V(()=>[...t[4]||(t[4]=[E("Cancel",-1)])]),_:1}),I(n(z),{variant:"solid",disabled:!e.value||!l.value,onClick:U},{default:V(()=>[...t[5]||(t[5]=[E(" Insert Embed ",-1)])]),_:1},8,["disabled"])])]),_:1},8,["modelValue"])]))}});export{ie as default};
