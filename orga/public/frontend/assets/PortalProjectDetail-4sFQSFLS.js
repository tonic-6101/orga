var R=(O,C,x)=>new Promise((S,b)=>{var w=c=>{try{f(x.next(c))}catch(y){b(y)}},a=c=>{try{f(x.throw(c))}catch(y){b(y)}},f=c=>c.done?S(c.value):Promise.resolve(c.value).then(w,a);f((x=x.apply(O,C)).next())});import{d as N,Q as $,o as U,b as d,c as n,u as l,e,t as s,_ as o,h as P,I as T,i as u,n as _,p as g,E as A,F as p,r as D,O as V,q as j,s as B,P as F,H as J}from"./main-BV0KycqK.js";import{u as Q}from"./usePortalApi-BiT1X6gW.js";import{M as q,P as W,H as G}from"./portal-1JhjUazr.js";const K={key:0,class:"flex items-center justify-center py-12"},X={class:"text-center"},Y={class:"text-gray-500"},Z={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-6"},ee={class:"flex items-center gap-3"},te={class:"text-red-800 font-medium"},se={class:"text-red-600 text-sm"},oe={key:2},ae={class:"bg-white rounded-lg border border-gray-200 shadow-sm mb-6"},le={class:"p-6"},re={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"},de={class:"flex items-center gap-2 mb-3"},ne={class:"text-2xl font-bold text-gray-800 mb-2"},ie={key:0,class:"text-gray-500"},ce={class:"text-right"},ue={class:"text-4xl font-bold text-orga-500"},ge={class:"text-sm text-gray-500"},_e={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},fe={class:"lg:col-span-2 space-y-6"},ye={class:"bg-white rounded-lg border border-gray-200 shadow-sm"},xe={class:"p-4 border-b border-gray-100"},ve={class:"font-semibold text-gray-800 flex items-center gap-2"},me={class:"p-4"},pe={class:"mb-6"},be={class:"flex justify-between mb-2"},he={class:"text-sm text-gray-500"},we={class:"text-sm font-semibold text-gray-700"},ke={class:"h-3 bg-gray-100 rounded-full overflow-hidden"},je={class:"grid grid-cols-2 sm:grid-cols-4 gap-4"},Ce={class:"text-xs text-gray-500"},Se={class:"bg-white rounded-lg border border-gray-200 shadow-sm"},Pe={class:"p-4 border-b border-gray-100"},Te={class:"font-semibold text-gray-800 flex items-center gap-2"},De={class:"p-4"},Oe={key:0,class:"space-y-4"},Me={class:"flex-shrink-0 pt-0.5"},Re={key:0,class:"w-8 h-8 rounded-full bg-green-100 flex items-center justify-center"},Ae={key:1,class:"w-8 h-8 rounded-full bg-red-100 flex items-center justify-center"},Be={key:2,class:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center"},Ee={class:"flex-1 min-w-0"},Le={class:"flex items-start justify-between gap-2"},ze={key:0,class:"text-sm text-gray-500 line-clamp-2"},He={class:"text-xs text-gray-400 mt-1"},Ie={key:1,class:"text-center py-8 text-gray-500"},Ne={key:0,class:"bg-white rounded-lg border border-gray-200 shadow-sm"},$e={class:"p-4 border-b border-gray-100"},Ue={class:"font-semibold text-gray-800 flex items-center gap-2"},Ve={class:"divide-y divide-gray-100"},Fe={class:"flex-1 min-w-0"},Je={class:"font-medium text-gray-800 truncate"},Qe={class:"text-xs text-gray-500"},qe={class:"space-y-6"},We={class:"bg-white rounded-lg border border-gray-200 shadow-sm"},Ge={class:"p-4 border-b border-gray-100"},Ke={class:"font-semibold text-gray-800 flex items-center gap-2"},Xe={class:"p-4"},Ye={class:"space-y-3"},Ze={key:0,class:"flex justify-between py-2 border-b border-gray-100"},et={class:"text-gray-500"},tt={class:"font-medium text-gray-800"},st={key:1,class:"flex justify-between py-2 border-b border-gray-100"},ot={class:"text-gray-500"},at={class:"font-medium text-gray-800"},lt={key:2,class:"flex justify-between py-2 border-b border-gray-100"},rt={class:"text-gray-500"},dt={class:"font-medium text-green-600"},nt={key:3,class:"flex justify-between py-2 border-b border-gray-100"},it={class:"text-gray-500"},ct={class:"font-medium text-red-600"},ut={key:4,class:"flex justify-between py-2 border-b border-gray-100"},gt={class:"text-gray-500"},_t={class:"font-medium text-gray-800"},ft={class:"flex justify-between py-2"},yt={class:"text-gray-500"},xt={class:"font-medium text-gray-800"},vt={key:0,class:"bg-white rounded-lg border border-gray-200 shadow-sm"},mt={class:"p-4 border-b border-gray-100"},pt={class:"font-semibold text-gray-800 flex items-center gap-2"},bt={class:"p-4"},ht={class:"mb-3"},wt={class:"flex justify-between mb-1"},kt={class:"text-sm text-gray-500"},jt={class:"text-sm font-semibold text-gray-700"},Ct={class:"h-2 bg-gray-100 rounded-full overflow-hidden"},St={class:"text-sm text-gray-500"},Pt={class:"bg-white rounded-lg border border-gray-200 shadow-sm"},Tt={class:"p-4 border-b border-gray-100"},Dt={class:"font-semibold text-gray-800 flex items-center gap-2"},Ot={class:"p-4 space-y-2"},Mt=N({__name:"PortalProjectDetail",setup(O){const C=V(),{getPortalProject:x,loading:S,error:b}=Q(),{formatCurrency:w}=$(),a=j(null),f=j([]),c=j(null),y=j([]);U(()=>R(null,null,function*(){const i=C.params.id;if(i)try{const t=yield x(i);a.value=t.project,f.value=t.milestones,c.value=t.task_summary,y.value=t.recent_activity}catch(t){console.error("Failed to load project:",t)}}));function E(i){return W[i]||"bg-gray-100 text-gray-600"}function L(i){return i&&G[i]||"bg-gray-100 text-gray-500"}function v(i){return i?new Date(i).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):o("TBD")}function z(i){const t=new Date,h=new Date(i),m=t.getTime()-h.getTime(),r=Math.floor(m/(1e3*60)),k=Math.floor(m/(1e3*60*60)),M=Math.floor(m/(1e3*60*60*24));return r<1?o("Just now"):r<60?o("{0}m ago",[r]):k<24?o("{0}h ago",[k]):M<7?o("{0}d ago",[M]):v(i)}const H=B(()=>c.value?[{label:o("Open"),value:c.value.Open,color:"text-gray-600"},{label:o("In Progress"),value:c.value.Working,color:"text-yellow-600"},{label:o("In Review"),value:c.value["Pending Review"],color:"text-blue-600"},{label:o("Completed"),value:c.value.Completed,color:"text-green-600"}]:[]),I=B(()=>{var t;if(!((t=a.value)!=null&&t.budget_utilization))return"bg-green-500";const i=a.value.budget_utilization;return i>90?"bg-red-500":i>75?"bg-yellow-500":"bg-green-500"});return(i,t)=>{var m;const h=F("router-link");return d(),n("div",null,[l(S)?(d(),n("div",K,[e("div",X,[t[0]||(t[0]=e("i",{class:"fa-solid fa-spinner fa-spin text-3xl text-orga-500 mb-3"},null,-1)),e("p",Y,s(l(o)("Loading project...")),1)])])):l(b)?(d(),n("div",Z,[e("div",ee,[t[1]||(t[1]=e("i",{class:"fa-solid fa-exclamation-triangle text-red-500 text-xl"},null,-1)),e("div",null,[e("h3",te,s(l(o)("Error loading project")),1),e("p",se,s(l(b)),1)])]),P(h,{to:"/orga/portal",class:"inline-flex items-center gap-2 mt-4 px-4 py-2 bg-red-100 text-red-700 rounded hover:bg-red-200 no-underline"},{default:T(()=>[t[2]||(t[2]=e("i",{class:"fa-solid fa-arrow-left"},null,-1)),u(" "+s(l(o)("Back to Projects")),1)]),_:1})])):a.value?(d(),n("div",oe,[e("div",ae,[e("div",le,[e("div",re,[e("div",null,[e("div",de,[e("span",{class:_(["px-3 py-1 text-sm font-medium rounded-full",E(a.value.status)])},s(a.value.status),3),a.value.health_status?(d(),n("span",{key:0,class:_(["px-3 py-1 text-sm font-medium rounded-full",L(a.value.health_status)])},[t[3]||(t[3]=e("i",{class:"fa-solid fa-heart mr-1"},null,-1)),u(" "+s(a.value.health_status),1)],2)):g("",!0)]),e("h1",ne,s(a.value.project_name),1),a.value.description?(d(),n("p",ie,s(a.value.description),1)):g("",!0)]),e("div",ce,[e("div",ue,s(Math.round(a.value.progress||0))+"%",1),e("div",ge,s(l(o)("Complete")),1)])])])]),e("div",_e,[e("div",fe,[e("div",ye,[e("div",xe,[e("h2",ve,[t[4]||(t[4]=e("i",{class:"fa-solid fa-chart-line text-orga-500"},null,-1)),u(" "+s(l(o)("Progress Overview")),1)])]),e("div",me,[e("div",pe,[e("div",be,[e("span",he,s(l(o)("Overall Progress")),1),e("span",we,s(Math.round(a.value.progress||0))+"%",1)]),e("div",ke,[e("div",{class:"h-full bg-orga-500 rounded-full transition-all",style:A({width:`${a.value.progress||0}%`})},null,4)])]),e("div",je,[(d(!0),n(p,null,D(H.value,r=>(d(),n("div",{key:r.label,class:"border border-gray-200 rounded-lg p-3 text-center"},[e("div",{class:_(["text-2xl font-bold",r.color])},s(r.value),3),e("div",Ce,s(r.label),1)]))),128))])])]),e("div",Se,[e("div",Pe,[e("h2",Te,[t[5]||(t[5]=e("i",{class:"fa-solid fa-flag text-yellow-500"},null,-1)),u(" "+s(l(o)("Milestones")),1)])]),e("div",De,[f.value.length?(d(),n("div",Oe,[(d(!0),n(p,null,D(f.value,r=>(d(),n("div",{key:r.name,class:"flex gap-3"},[e("div",Me,[r.status==="Completed"?(d(),n("div",Re,[...t[6]||(t[6]=[e("i",{class:"fa-solid fa-check text-green-600"},null,-1)])])):r.is_overdue?(d(),n("div",Ae,[...t[7]||(t[7]=[e("i",{class:"fa-solid fa-exclamation text-red-600"},null,-1)])])):(d(),n("div",Be,[...t[8]||(t[8]=[e("i",{class:"fa-solid fa-clock text-blue-600"},null,-1)])]))]),e("div",Ee,[e("div",Le,[e("div",null,[e("h4",{class:_(["font-medium",r.status==="Completed"?"text-gray-400 line-through":"text-gray-800"])},s(r.milestone_name),3),r.description?(d(),n("p",ze,s(r.description),1)):g("",!0)]),e("span",{class:_(["px-2 py-0.5 text-xs font-medium rounded whitespace-nowrap",l(q)[r.status]||"bg-gray-100 text-gray-600"])},s(r.status),3)]),e("div",He,[r.status==="Completed"&&r.completion_date?(d(),n(p,{key:0},[t[9]||(t[9]=e("i",{class:"fa-solid fa-check-circle text-green-500 mr-1"},null,-1)),u(" "+s(l(o)("Completed"))+" "+s(v(r.completion_date)),1)],64)):r.is_overdue?(d(),n(p,{key:1},[t[10]||(t[10]=e("i",{class:"fa-solid fa-exclamation-triangle text-red-500 mr-1"},null,-1)),u(" "+s(l(o)("Overdue - was due {0}",[v(r.due_date)])),1)],64)):(d(),n(p,{key:2},[t[11]||(t[11]=e("i",{class:"fa-regular fa-calendar mr-1"},null,-1)),u(" "+s(l(o)("Due {0}",[v(r.due_date)])),1)],64))])])]))),128))])):(d(),n("div",Ie,[t[12]||(t[12]=e("i",{class:"fa-solid fa-flag fa-2x text-gray-300 mb-2"},null,-1)),e("p",null,s(l(o)("No milestones defined for this project.")),1)]))])]),y.value.length?(d(),n("div",Ne,[e("div",$e,[e("h2",Ue,[t[13]||(t[13]=e("i",{class:"fa-solid fa-history text-gray-500"},null,-1)),u(" "+s(l(o)("Recent Activity")),1)])]),e("div",Ve,[(d(!0),n(p,null,D(y.value,(r,k)=>(d(),n("div",{key:`${r.type}-${k}`,class:"p-4 flex items-center gap-3"},[e("span",{class:_(["w-8 h-8 rounded-full flex items-center justify-center text-white",r.type==="milestone"?"bg-yellow-500":"bg-green-500"])},[e("i",{class:_(["fa-solid text-sm",r.type==="milestone"?"fa-flag":"fa-check"])},null,2)],2),e("div",Fe,[e("div",Je,s(r.title),1),e("div",Qe,s(r.type==="milestone"?l(o)("Milestone"):l(o)("Task"))+" "+s(r.action)+" - "+s(z(r.timestamp)),1)])]))),128))])])):g("",!0)]),e("div",qe,[e("div",We,[e("div",Ge,[e("h2",Ke,[t[14]||(t[14]=e("i",{class:"fa-solid fa-info-circle text-blue-500"},null,-1)),u(" "+s(l(o)("Project Details")),1)])]),e("div",Xe,[e("dl",Ye,[a.value.start_date?(d(),n("div",Ze,[e("dt",et,s(l(o)("Start Date")),1),e("dd",tt,s(v(a.value.start_date)),1)])):g("",!0),a.value.end_date?(d(),n("div",st,[e("dt",ot,s(l(o)("Target End")),1),e("dd",at,s(v(a.value.end_date)),1)])):g("",!0),a.value.days_remaining&&a.value.days_remaining>0?(d(),n("div",lt,[e("dt",rt,s(l(o)("Days Remaining")),1),e("dd",dt,s(l(o)("{0} days",[a.value.days_remaining])),1)])):a.value.days_overdue&&a.value.days_overdue>0?(d(),n("div",nt,[e("dt",it,s(l(o)("Days Overdue")),1),e("dd",ct,s(l(o)("{0} days",[a.value.days_overdue])),1)])):g("",!0),a.value.manager_name?(d(),n("div",ut,[e("dt",gt,s(l(o)("Project Manager")),1),e("dd",_t,s(a.value.manager_name),1)])):g("",!0),e("div",ft,[e("dt",yt,s(l(o)("Total Tasks")),1),e("dd",xt,s(((m=c.value)==null?void 0:m.total)||0),1)])])])]),a.value.budget?(d(),n("div",vt,[e("div",mt,[e("h2",pt,[t[15]||(t[15]=e("i",{class:"fa-solid fa-coins text-yellow-500"},null,-1)),u(" "+s(l(o)("Budget")),1)])]),e("div",bt,[e("div",ht,[e("div",wt,[e("span",kt,s(l(o)("Spent")),1),e("span",jt,s(l(w)(a.value.spent))+" / "+s(l(w)(a.value.budget)),1)]),e("div",Ct,[e("div",{class:_(["h-full rounded-full transition-all",I.value]),style:A({width:`${Math.min(a.value.budget_utilization,100)}%`})},null,6)])]),e("p",St,s(l(o)("{0}% of budget used",[a.value.budget_utilization])),1)])])):g("",!0),e("div",Pt,[e("div",Tt,[e("h2",Dt,[t[16]||(t[16]=e("i",{class:"fa-solid fa-bolt text-orga-500"},null,-1)),u(" "+s(l(o)("Quick Actions")),1)])]),e("div",Ot,[P(h,{to:"/orga/portal",class:"flex items-center gap-2 w-full px-4 py-2 text-gray-700 border border-gray-200 rounded hover:bg-gray-50 no-underline"},{default:T(()=>[t[17]||(t[17]=e("i",{class:"fa-solid fa-arrow-left text-gray-500"},null,-1)),u(" "+s(l(o)("Back to Projects")),1)]),_:1}),P(h,{to:`/orga/portal/support?project=${a.value.name}`,class:"flex items-center gap-2 w-full px-4 py-2 text-gray-700 border border-gray-200 rounded hover:bg-gray-50 no-underline"},{default:T(()=>[t[18]||(t[18]=e("i",{class:"fa-solid fa-envelope text-gray-500"},null,-1)),u(" "+s(l(o)("Contact Support")),1)]),_:1},8,["to"])])])])])])):g("",!0)])}}}),Lt=J(Mt,[["__scopeId","data-v-4311b4b8"]]);export{Lt as default};
