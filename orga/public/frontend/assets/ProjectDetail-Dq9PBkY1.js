var xs=Object.defineProperty,bs=Object.defineProperties;var ks=Object.getOwnPropertyDescriptors;var Va=Object.getOwnPropertySymbols;var hs=Object.prototype.hasOwnProperty,_s=Object.prototype.propertyIsEnumerable;var Ha=(j,q,A)=>q in j?xs(j,q,{enumerable:!0,configurable:!0,writable:!0,value:A}):j[q]=A,Ga=(j,q)=>{for(var A in q||(q={}))hs.call(q,A)&&Ha(j,A,q[A]);if(Va)for(var A of Va(q))_s.call(q,A)&&Ha(j,A,q[A]);return j},qa=(j,q)=>bs(j,ks(q));var se=(j,q,A)=>new Promise((ie,z)=>{var le=w=>{try{m(A.next(w))}catch(E){z(E)}},B=w=>{try{m(A.throw(w))}catch(E){z(E)}},m=w=>w.done?ie(w.value):Promise.resolve(w.value).then(le,B);m((A=A.apply(j,q)).next())});import{o as Ma,a as Ka,d as xt,w as rt,C as $s,b as d,c as u,e,t as n,u as o,_ as t,F as Q,f as re,v as Et,D as Ja,p as _,E as oe,r as ne,n as F,j as me,k as Pe,l as qt,i as R,G as ws,q as v,s as K,H as Qa,y as Za,h as ve,I as Ut,g as be,T as ya,A as Kt,J as Ds,K as Xa,L as we,z as Ya,M as At,N as Cs,O as es,P as js,Q as Ts,m as Je,R as Ta,U as Ms,x as Ss,V as Ls,W as Fs,X as Is}from"./main-BV0KycqK.js";import{_ as Ps}from"./TaskManager.vue_vue_type_script_setup_true_lang-DHKEKpe3.js";import{F as fa}from"./FormField-Cvvkt7z9.js";function As(j){function q(A){A.target instanceof HTMLInputElement||A.target instanceof HTMLTextAreaElement||A.target instanceof HTMLSelectElement||A.target.isContentEditable||(A.shiftKey&&A.key==="T"&&(A.preventDefault(),j.onAddTask()),A.shiftKey&&A.key==="M"&&(A.preventDefault(),j.onAddMilestone()))}Ma(()=>{window.addEventListener("keydown",q)}),Ka(()=>{window.removeEventListener("keydown",q)})}function Qe(j){return j.type!=="milestone"}const Es={class:"gantt-chart flex flex-col h-full bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden"},Us={key:0,class:"flex-1 flex items-center justify-center p-8 text-gray-500 dark:text-gray-400"},zs={class:"text-center"},Os={class:"text-sm"},Rs={class:"text-xs text-gray-400 dark:text-gray-500 mt-1"},Bs={class:"gantt-area-a flex-shrink-0"},Ws={class:"flex"},Ns={class:"gantt-left-header"},Vs={class:"gantt-header-height bg-gray-50 dark:bg-gray-800 flex items-center px-3 gap-2"},Hs={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},Gs={value:"none"},qs={value:"group"},Ks={value:"status"},Js={value:"priority"},Qs={value:"milestone"},Zs={value:"assignee"},Xs=["title"],Ys={class:"bg-gray-50 dark:bg-gray-800"},er={class:"h-6 flex border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"},tr={class:"text-xs font-semibold text-gray-700 dark:text-gray-300"},ar={class:"h-5 flex border-b border-gray-200 dark:border-gray-700 bg-gray-100/50 dark:bg-gray-700/50"},sr={class:"text-[10px] font-medium text-gray-500 dark:text-gray-400"},rr={class:"h-9 flex"},lr={class:"day-number text-[11px]"},nr={class:"day-abbr text-[9px] opacity-70"},or={class:"gantt-area-b flex-1 flex flex-col min-h-0"},ir={class:"flex flex-1 min-h-0"},dr={class:"gantt-left-body-wrapper"},ur=["onClick"],cr={class:"text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wide"},gr={class:"text-[10px] text-gray-400 dark:text-gray-500"},vr=["draggable","onDragstart","onDragover","onDrop","onClick"],pr={key:0,class:"fa-solid fa-grip-vertical text-[10px] text-gray-300 dark:text-gray-600 hover:text-gray-500 dark:hover:text-gray-400 cursor-grab shrink-0"},fr=["title"],yr=["draggable","onDragstart","onDragover","onDrop","onClick"],mr={key:0,"data-drag-handle":"",class:"fa-solid fa-grip-vertical text-[10px] text-gray-300 dark:text-gray-600 hover:text-gray-500 dark:hover:text-gray-400 cursor-grab"},xr={class:"text-sm text-gray-800 dark:text-gray-200 truncate flex-1"},br=["onClick"],kr={class:"absolute inset-0 flex pointer-events-none"},hr=["onDragover","onDrop"],_r={class:"absolute inset-0 flex pointer-events-none"},$r=["draggable","onClick","onDragstart","onDrop","title"],wr={key:0,class:"fa-solid fa-arrows-left-right text-[9px] text-indigo-500 dark:text-indigo-400 shrink-0"},Dr={key:1,class:"fa-solid fa-shield-halved text-[9px] text-amber-700 dark:text-amber-400 shrink-0"},Cr=["title"],jr={class:"gantt-bar-text text-xs truncate font-medium flex-1"},Tr={key:3,class:"gantt-bar-duration text-[10px] px-1 rounded shrink-0"},Mr=["onMousedown","title"],Sr={key:3,class:"absolute left-2 top-1.5 h-7 flex items-center text-xs text-gray-400 dark:text-gray-500"},Lr=["onClick","onDragover","onDrop"],Fr={class:"absolute inset-0 flex pointer-events-none"},Ir=["onMousedown","title"],Pr={key:0,class:"text-[10px] ml-1 text-indigo-400"},Ar=["width","height"],Er=["x1","y1","x2","y2","stroke"],Ur=["cx","cy","fill"],zr=["cx","cy"],Or=["width","height"],Rr=["opacity"],Br=["cx","cy","r","fill"],Wr=["d","stroke","stroke-width"],Nr=["points","fill"],Vr=["width","height"],Hr=["cx","cy"],Gr=["d"],qr=["points"],Kr={key:0,class:"thumb-velocity-sheet"},Jr={class:"flex-shrink-0 h-8 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 px-4 flex items-center gap-4 text-xs text-gray-500 dark:text-gray-400"},Qr={class:"flex items-center gap-1.5"},Zr={class:"flex items-center gap-1.5"},Xr={class:"flex items-center gap-1.5"},Yr={class:"flex items-center gap-1.5"},el={class:"border-l border-gray-300 dark:border-gray-600 pl-3 flex items-center gap-1.5"},tl={class:"ml-auto flex items-center gap-1.5"},al={class:"flex items-center gap-1.5"},Se=40,sl=6,rl=xt({__name:"GanttChart",props:{tasks:{},startDate:{},endDate:{},selectedTaskId:{},showDependencies:{type:Boolean,default:!0},cellWidth:{default:40},justReorderedId:{default:null},criticalPathTasks:{default:()=>[]}},emits:["select","update-dates","update-milestone-date","reorder-item","create-dependency"],setup(j,{emit:q}){const A=["Open","Working","In Progress","Pending Review","Review","Overdue","Completed","Cancelled"],ie=["Urgent","High","Medium","Low"],z=j,le=v(!1);function B(i){return le.value&&z.criticalPathTasks.includes(i)}const m=q,w=v(null),E=v(null),G=v(null);function xe(i,r){r.preventDefault(),r.stopPropagation(),w.value=i;const s=T=>{if(!w.value||!p.value)return;const k=p.value.getBoundingClientRect(),h=p.value.scrollLeft,x=p.value.scrollTop,H=T.clientX-k.left+h,b=T.clientY-k.top+x,L=vt.value.find(C=>C.name===w.value);if(!L)return;const $=Ee(L);if(!$)return;const M=We.value.findIndex(C=>C.kind==="item"&&C.item.name===w.value)*Se+Se/2,U=$.left+$.width;G.value={x1:U,y1:M,x2:H,y2:b},E.value=null;for(let C=0;C<We.value.length;C++){const ge=We.value[C];if(ge.kind!=="item"||ge.item.type==="milestone"||ge.item.name===w.value)continue;const te=ge.item,Ue=Ee(te);if(!Ue)continue;const he=C*Se;if(H>=Ue.left&&H<=Ue.left+Ue.width&&b>=he&&b<=he+Se){E.value=te.name;break}}},c=()=>{w.value&&E.value&&w.value!==E.value&&m("create-dependency",{fromTask:w.value,toTask:E.value,type:"FS"}),w.value=null,E.value=null,G.value=null,document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",c)};document.addEventListener("mousemove",s),document.addEventListener("mouseup",c)}const N=v(null),de=v(null),ae=v(null),S=v("none"),O=v(new Set);function ee(i){const r=new Set(O.value);r.has(i)?r.delete(i):r.add(i),O.value=r}const ce=v(0);let Z=null;const ue=v(null),Y=v(0),V=v(null),p=v(null),J=v(null),De=v(null);let _e=!1,Ce=!1;const bt=v(96),lt=v(0),Ze=v(!1),Oe=v(!1),je=v(!1),Le=v("zone-center"),Re={"zone-2x-left":{min:-1/0,max:-50,velocity:2,direction:-1},"zone-1x-left":{min:-50,max:-10,velocity:1,direction:-1},"zone-center":{min:-10,max:10,velocity:0,direction:0},"zone-1x-right":{min:10,max:50,velocity:1,direction:1},"zone-2x-right":{min:50,max:1/0,velocity:2,direction:1}};function ke(i){const[r,s,c]=i.split("-").map(Number);return new Date(r,s-1,c)}const y=K(()=>{let i,r;if(z.startDate&&z.endDate)i=ke(z.startDate),r=ke(z.endDate);else{const s=z.tasks.flatMap(c=>[c.start_date?ke(c.start_date):null,c.due_date?ke(c.due_date):null]).filter(c=>c!==null);s.length===0?(i=new Date,i.setDate(1),r=new Date,r.setMonth(r.getMonth()+1),r.setDate(0)):(i=new Date(Math.min(...s.map(c=>c.getTime()))),r=new Date(Math.max(...s.map(c=>c.getTime()))))}return i.setDate(i.getDate()-7),r.setDate(r.getDate()+14),{start:i,end:r}}),X=K(()=>{const i=[],r=new Date(y.value.start);for(;r<=y.value.end;)i.push(new Date(r)),r.setDate(r.getDate()+1);return i}),He=K(()=>{const i=[];let r="",s=0;return X.value.forEach((c,T)=>{const k=`${c.getFullYear()}-${c.getMonth()}`;k!==r&&(r&&(i[i.length-1].days=T-s),r=k,s=T,i.push({month:c.toLocaleDateString("en-US",{month:"short"}),year:c.getFullYear(),days:0,startIndex:T}))}),i.length>0&&(i[i.length-1].days=X.value.length-i[i.length-1].startIndex),i}),zt=K(()=>{const i=[];let r="",s=0;return X.value.forEach((c,T)=>{const k=Jt(c),h=`${c.getFullYear()}-W${k}`;h!==r&&(r&&(i[i.length-1].days=T-s),r=h,s=T,i.push({weekNum:k,year:c.getFullYear(),days:0,startIndex:T}))}),i.length>0&&(i[i.length-1].days=X.value.length-i[i.length-1].startIndex),i});function Jt(i){const r=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate())),s=r.getUTCDay()||7;r.setUTCDate(r.getUTCDate()+4-s);const c=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r.getTime()-c.getTime())/864e5+1)/7)}function nt(i){return i.getDay()===1}function kt(i){return i.toLocaleDateString("en-US",{weekday:"short"}).substring(0,2)}const Te=K(()=>{const i=new Date;return X.value.findIndex(r=>{const s=new Date(r);return s.getFullYear()===i.getFullYear()&&s.getMonth()===i.getMonth()&&s.getDate()===i.getDate()})});function ot(i){if(!i.start_date)return{display:"none"};const r=ke(i.start_date),s=i.due_date?ke(i.due_date):new Date(r),c=X.value.findIndex($=>{const W=new Date($);return W.getFullYear()===r.getFullYear()&&W.getMonth()===r.getMonth()&&W.getDate()===r.getDate()});let T=c;if(c===-1&&(T=X.value.findIndex($=>{const W=new Date($);W.setHours(0,0,0,0);const M=new Date(r);return M.setHours(0,0,0,0),W.getTime()>=M.getTime()})),T===-1)return{display:"none"};const k=s.getTime()-r.getTime(),h=Math.max(1,Math.ceil(k/(1e3*60*60*24))+1),x=T*z.cellWidth+z.cellWidth/2,H=(T+h-1)*z.cellWidth+z.cellWidth/2,b=Math.max(H-x,z.cellWidth);return{left:`${h===1?x-b/2:x}px`,width:`${b}px`}}function Ot(i){const r=ot(i);if(r.display==="none")return{display:"none"};const s=parseFloat(r.left||"0"),c=parseFloat(r.width||"0"),k=(i.dependents_info||[]).some(h=>h.type==="FS"||h.type==="FF")||(i.dependencies_info||[]).some(h=>h.type==="FF"||h.type==="SF")?16:4;return{left:`${s+c+k}px`}}const Ge={Open:"gantt-bar-open",Working:"gantt-bar-in-progress","In Progress":"gantt-bar-in-progress","Pending Review":"gantt-bar-review",Review:"gantt-bar-review",Completed:"gantt-bar-completed",Cancelled:"bg-gray-400"},Xe={Upcoming:"bg-violet-500","In Progress":"bg-violet-600",Completed:"bg-emerald-500",Missed:"bg-rose-500"},ht={Urgent:"priority-urgent",High:"priority-high",Medium:"priority-medium",Low:"priority-low"};function Qt(i){return i.getDate().toString()}function Me(i){const r=i.getDay();return r===0||r===6}function it(i){const r=new Date;return i.toDateString()===r.toDateString()}function _t(i){m("select",i)}function dt(i){if(!i.due_date)return{display:"none"};const r=ke(i.due_date),s=X.value.findIndex(c=>{const T=new Date(c);return T.getFullYear()===r.getFullYear()&&T.getMonth()===r.getMonth()&&T.getDate()===r.getDate()});return s===-1?{display:"none"}:{left:`${s*z.cellWidth+z.cellWidth/2-8}px`}}function ut(i){if(!i.due_date)return null;const r=ke(i.due_date),s=X.value.findIndex(c=>{const T=new Date(c);return T.getFullYear()===r.getFullYear()&&T.getMonth()===r.getMonth()&&T.getDate()===r.getDate()});return s===-1?null:s*z.cellWidth+z.cellWidth/2}function Be(i){if(!i.start_date)return 0;const r=ke(i.start_date),c=(i.due_date?ke(i.due_date):r).getTime()-r.getTime();return Math.max(1,Math.ceil(c/(1e3*60*60*24)))}function qe(i){const r=i.getFullYear(),s=String(i.getMonth()+1).padStart(2,"0"),c=String(i.getDate()).padStart(2,"0");return`${r}-${s}-${c}`}function ma(i,r,s){if(!i.dataTransfer||!r.start_date)return;const c=i.currentTarget,T=ot(r),k=parseInt(T.left||"0",10),h={taskId:r.name,taskName:r.subject,startDate:r.start_date,dueDate:r.due_date||null,duration:Be(r),startX:i.clientX,originalLeft:k,rowIndex:s,dragType:"dates",itemType:"task"};i.dataTransfer.effectAllowed="move",i.dataTransfer.setData("application/json",JSON.stringify(h));const x=c.cloneNode(!0);x.style.position="absolute",x.style.top="-1000px",x.style.opacity="0.8",x.style.transform="scale(1.02)",x.style.boxShadow="0 4px 12px rgba(0,0,0,0.3)",document.body.appendChild(x),i.dataTransfer.setDragImage(x,i.offsetX,i.offsetY),requestAnimationFrame(()=>{document.body.removeChild(x)}),N.value=h;const H=b=>{if(!N.value||N.value.dragType!=="dates")return;b.preventDefault();const L=b.clientX-N.value.startX;ce.value=Math.round(L/z.cellWidth)};document.addEventListener("dragover",H,!0),Z=()=>{document.removeEventListener("dragover",H,!0),Z=null},requestAnimationFrame(()=>{c.classList.add("dragging")})}function Zt(i,r,s){if(S.value!=="none"||!i.dataTransfer)return;const c=i.currentTarget,T=Qe(r)?"task":"milestone",k={taskId:r.name,taskName:r.subject,startDate:r.start_date||"",dueDate:r.due_date||null,duration:Qe(r)?Be(r):0,startX:i.clientX,originalLeft:0,rowIndex:s,dragType:"reorder",itemType:T};i.dataTransfer.effectAllowed="move",i.dataTransfer.setData("application/json",JSON.stringify(k)),N.value=k,requestAnimationFrame(()=>{c.classList.add("dragging-row")})}function ye(i,r){if(i.preventDefault(),!!i.dataTransfer&&(i.dataTransfer.dropEffect="move",N.value)){const s=i.clientX-N.value.startX;ce.value=Math.round(s/z.cellWidth),N.value.dragType==="reorder"&&N.value.rowIndex!==r&&(de.value=r)}}function $t(i,r){i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect="move",N.value&&N.value.rowIndex!==r&&(de.value=r))}function ct(i){const r=i.relatedTarget,s=i.currentTarget;(!r||!(s!=null&&s.contains(r)))&&(de.value=null)}function Fe(i,r){if(i.preventDefault(),i.stopPropagation(),!i.dataTransfer||!N.value)return;const s=N.value;if(s.dragType==="dates"&&s.startDate){const c=i.clientX-s.startX,T=Math.round(c/z.cellWidth);if(T!==0){const k=ke(s.startDate),h=new Date(k);h.setDate(h.getDate()+T);const x=new Date(h);x.setDate(x.getDate()+s.duration),m("update-dates",{taskId:s.taskId,startDate:qe(h),endDate:qe(x)})}}else if(s.dragType==="reorder"){const c=s.rowIndex,T=r;if(c!==T){const k=[...vt.value],[h]=k.splice(c,1);k.splice(T,0,h);const x=k.indexOf(h),H=x>0?k[x-1]:null,b=x<k.length-1?k[x+1]:null;m("reorder-item",{itemId:s.taskId,itemType:s.itemType,prevItemId:H?H.name:null,nextItemId:b?b.name:null,prevItemType:H?Qe(H)?"task":"milestone":null,nextItemType:b?Qe(b)?"task":"milestone":null})}}Xt()}function Rt(i){var s,c;const r=i.currentTarget;(s=r==null?void 0:r.classList)==null||s.remove("dragging"),(c=r==null?void 0:r.classList)==null||c.remove("dragging-row"),Xt()}function Xt(){Z&&Z(),N.value=null,de.value=null,ce.value=0}function wt(i,r){if(i.preventDefault(),i.stopPropagation(),!r.due_date)return;const s=dt(r),c=parseInt(s.left||"0",10);ue.value={milestoneId:r.name,milestoneName:r.subject,originalDueDate:r.due_date,startX:i.clientX,originalLeft:c},Y.value=0,document.addEventListener("mousemove",Dt),document.addEventListener("mouseup",Ae)}function Dt(i){if(!ue.value)return;const r=i.clientX-ue.value.startX;Y.value=Math.round(r/z.cellWidth)}function Ae(){if(document.removeEventListener("mousemove",Dt),document.removeEventListener("mouseup",Ae),!ue.value)return;const i=Y.value;if(i!==0){const r=ke(ue.value.originalDueDate),s=new Date(r);s.setDate(s.getDate()+i),m("update-milestone-date",{milestoneId:ue.value.milestoneId,dueDate:qe(s)})}ue.value=null,Y.value=0}function Ct(i){return!ue.value||ue.value.milestoneId!==i.name||Y.value===0?null:{left:`${ue.value.originalLeft+Y.value*z.cellWidth}px`}}function Ie(i){var r;return((r=ue.value)==null?void 0:r.milestoneId)===i.name}function Yt(i){var r;return((r=N.value)==null?void 0:r.taskId)===i.name}function ea(i){return z.justReorderedId===i.name||ae.value===i.name}function jt(i){var r,s;return de.value===i&&((r=N.value)==null?void 0:r.dragType)==="reorder"&&((s=N.value)==null?void 0:s.rowIndex)!==i}function ta(i){if(_e)return;_e=!0;const r=i.target,s=r.scrollTop;r===p.value&&J.value?J.value.scrollTop=s:r===J.value&&p.value&&(p.value.scrollTop=s),requestAnimationFrame(()=>{_e=!1})}function aa(){if(Ce)return;Ce=!0;const i=p.value,r=V.value;i&&r&&(r.scrollLeft=i.scrollLeft),requestAnimationFrame(()=>{Ce=!1})}const Bt=v(!1);function sa(){Bt.value=document.documentElement.classList.contains("dark")}const ra=v(0),xa=K(()=>lt.value<=0?0:(lt.value-bt.value)/2),ba=K(()=>{let i;return Bt.value?i=je.value||Oe.value?"#4b5563":"#374151":i=je.value?"#6b7280":Oe.value?"#9ca3af":"#d1d5db",{position:"absolute",top:"0",height:"100%",width:`${bt.value}px`,left:`${xa.value}px`,backgroundColor:i,borderRadius:"4px",border:"1px solid",borderColor:Bt.value?"#6b7280":"#d1d5db",cursor:je.value?"grabbing":"grab",transition:je.value?"transform 0.1s ease":"background-color 0.2s, transform 0.1s ease",transform:je.value?"translateY(-2px)":"translateY(0)",display:"block",zIndex:"11",overflow:"hidden"}});function Ye(){const i=p.value;if(!i)return;const r=i.clientWidth,c=i.scrollWidth-r;lt.value=r,Ze.value=c>0}function Tt(i){for(const[r,s]of Object.entries(Re))if(i>=s.min&&i<s.max)return r;return"zone-center"}let Ke=null;function ka(i){i.preventDefault(),i.stopPropagation();const r=p.value;if(!r)return;je.value=!0,Le.value="zone-center";const s=i.clientX;let c=0;const T=()=>{if(!je.value)return;const x=Tt(c);Le.value=x;const H=Re[x];if(H.velocity>0){const b=r.scrollWidth-r.clientWidth,L=H.velocity*8*H.direction;r.scrollLeft=Math.max(0,Math.min(b,r.scrollLeft+L)),Mt()}Ke=requestAnimationFrame(T)},k=x=>{c=x.clientX-s},h=()=>{je.value=!1,Le.value="zone-center",Ke!==null&&(cancelAnimationFrame(Ke),Ke=null),document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",h)};document.addEventListener("mousemove",k),document.addEventListener("mouseup",h),Ke=requestAnimationFrame(T)}function ha(i){const r=p.value,s=De.value;if(!r||!s)return;const c=s.getBoundingClientRect(),k=(i.clientX-c.left)/s.clientWidth,h=r.scrollWidth-r.clientWidth;r.scrollLeft=Math.max(0,Math.min(h,k*h)),Mt()}function Mt(){const i=p.value;if(!i)return;const r=i.scrollWidth-i.clientWidth;ra.value=r>0?i.scrollLeft/r*100:0,V.value&&(V.value.scrollLeft=i.scrollLeft)}function _a(i){ta(i),aa(),Mt()}let et=null,gt=null;Ma(()=>{if(sa(),Te.value>=0&&p.value){const i=Te.value*z.cellWidth,r=p.value.clientWidth/4,s=p.value.scrollWidth-p.value.clientWidth,c=Math.max(0,Math.min(s,i-r));p.value.scrollLeft=c,V.value&&(V.value.scrollLeft=c)}requestAnimationFrame(()=>{Ye(),Mt()}),et=new ResizeObserver(()=>{Ye()}),p.value&&et.observe(p.value),De.value&&et.observe(De.value),gt=new MutationObserver(sa),gt.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]})}),rt([X,()=>z.cellWidth],()=>{requestAnimationFrame(Ye)}),rt(S,()=>{O.value=new Set}),$s(()=>{et==null||et.disconnect(),gt==null||gt.disconnect(),Ke!==null&&cancelAnimationFrame(Ke),Z&&Z(),document.removeEventListener("mousemove",Dt),document.removeEventListener("mouseup",Ae)});const vt=K(()=>{const r=[...z.tasks].map((s,c)=>({item:s,sortOrder:("sort_order"in s?s.sort_order:0)||0,originalIndex:c}));return r.sort((s,c)=>s.sortOrder>0&&c.sortOrder>0?s.sortOrder-c.sortOrder:s.sortOrder>0&&c.sortOrder===0?-1:s.sortOrder===0&&c.sortOrder>0?1:s.originalIndex-c.originalIndex),r.map(s=>s.item)}),We=K(()=>{const i=vt.value;if(S.value==="none")return i.map(k=>({kind:"item",item:k}));const r=new Map,s=S.value;for(const k of i){let h;if(!Qe(k))s==="status"?h=k.status||"Upcoming":h="__milestones__";else{const x=k;switch(s){case"status":h=x.status||"Open";break;case"priority":h=x.priority||"Medium";break;case"milestone":h=x.milestone||"__no_milestone__";break;case"assignee":h=x.assigned_to_name||"__unassigned__";break;case"group":h=x.task_group||"__ungrouped__";break;default:h="__default__"}}r.has(h)||r.set(h,[]),r.get(h).push(k)}const c=[...r.keys()].sort((k,h)=>{const x=["__milestones__","__no_milestone__","__unassigned__","__ungrouped__","__default__"],H=x.includes(k),b=x.includes(h);if(H&&!b)return 1;if(!H&&b)return-1;if(s==="status"){const L=A.indexOf(k),$=A.indexOf(h);return(L===-1?99:L)-($===-1?99:$)}if(s==="priority"){const L=ie.indexOf(k),$=ie.indexOf(h);return(L===-1?99:L)-($===-1?99:$)}return k.localeCompare(h)}),T=[];for(const k of c){const h=r.get(k);let x=k;if(k==="__milestones__"&&(x=t("Milestones")),k==="__no_milestone__"&&(x=t("No Milestone")),k==="__unassigned__"&&(x=t("Unassigned")),k==="__ungrouped__"&&(x=t("Ungrouped")),k==="__default__"&&(x=t("Other")),T.push({kind:"group-header",key:k,label:x,count:h.length}),!O.value.has(k))for(const H of h)T.push({kind:"item",item:H})}return T}),la=K(()=>vt.value.filter(i=>Qe(i))),pt=K(()=>X.value.length*z.cellWidth),ft={FS:"#1a1a1a",SS:"#1a1a1a",FF:"#1a1a1a",SF:"#1a1a1a"};function Ee(i){if(!i.start_date)return null;const r=ke(i.start_date),s=i.due_date?ke(i.due_date):new Date(r),c=X.value.findIndex($=>{const W=new Date($);return W.getFullYear()===r.getFullYear()&&W.getMonth()===r.getMonth()&&W.getDate()===r.getDate()});let T=c;if(c===-1&&(T=X.value.findIndex($=>{const W=new Date($);W.setHours(0,0,0,0);const M=new Date(r);return M.setHours(0,0,0,0),W.getTime()>=M.getTime()})),T===-1)return null;const k=s.getTime()-r.getTime(),h=Math.max(1,Math.ceil(k/(1e3*60*60*24))+1),x=T*z.cellWidth+z.cellWidth/2,H=(T+h-1)*z.cellWidth+z.cellWidth/2,b=Math.max(H-x,z.cellWidth);return{left:h===1?x-b/2:x,width:b}}function Ne(i,r,s,c,T="right",k="right"){if(r===c){if(T==="left"&&k==="right"){const b=r+Se*.6,L=Math.min(i,s)-10;return`M ${i} ${r} L ${L} ${r} L ${L} ${b} L ${s-10} ${b} L ${s-10} ${c} L ${s} ${c}`}return`M ${i} ${r} L ${s} ${c}`}const H=c>r;if(T==="right"&&k==="right"){const b=s-i;if(b>20){const C=i+b/2,ge=Math.abs(c-r),te=Math.min(5,ge/2,b/4);return H?[`M ${i} ${r}`,`L ${C-te} ${r}`,`A ${te} ${te} 0 0 1 ${C} ${r+te}`,`L ${C} ${c-te}`,`A ${te} ${te} 0 0 0 ${C+te} ${c}`,`L ${s} ${c}`].join(" "):[`M ${i} ${r}`,`L ${C-te} ${r}`,`A ${te} ${te} 0 0 0 ${C} ${r-te}`,`L ${C} ${c+te}`,`A ${te} ${te} 0 0 1 ${C+te} ${c}`,`L ${s} ${c}`].join(" ")}const L=i+10,$=s-10,W=r+(c-r)/2,M=Math.abs(c-r)/2,U=Math.min(5,M/2,10/2);if(Math.abs(c-r)<U*4){const C=Math.max(L,i+12);return`M ${i} ${r} L ${C} ${r} L ${C} ${c} L ${s} ${c}`}return H?[`M ${i} ${r}`,`L ${L-U} ${r}`,`A ${U} ${U} 0 0 1 ${L} ${r+U}`,`L ${L} ${W-U}`,`A ${U} ${U} 0 0 1 ${L-U} ${W}`,`L ${$+U} ${W}`,`A ${U} ${U} 0 0 0 ${$} ${W+U}`,`L ${$} ${c-U}`,`A ${U} ${U} 0 0 0 ${$+U} ${c}`,`L ${s} ${c}`].join(" "):[`M ${i} ${r}`,`L ${L-U} ${r}`,`A ${U} ${U} 0 0 0 ${L} ${r-U}`,`L ${L} ${W+U}`,`A ${U} ${U} 0 0 0 ${L-U} ${W}`,`L ${$+U} ${W}`,`A ${U} ${U} 0 0 1 ${$} ${W-U}`,`L ${$} ${c+U}`,`A ${U} ${U} 0 0 1 ${$+U} ${c}`,`L ${s} ${c}`].join(" ")}if(T==="left"&&k==="right"){const b=Math.min(i,s)-10,L=Math.abs(c-r),$=Math.min(5,L/2,10/2);return L<$*4?`M ${i} ${r} L ${b} ${r} L ${b} ${c} L ${s} ${c}`:H?[`M ${i} ${r}`,`L ${b+$} ${r}`,`A ${$} ${$} 0 0 0 ${b} ${r+$}`,`L ${b} ${c-$}`,`A ${$} ${$} 0 0 0 ${b+$} ${c}`,`L ${s} ${c}`].join(" "):[`M ${i} ${r}`,`L ${b+$} ${r}`,`A ${$} ${$} 0 0 1 ${b} ${r-$}`,`L ${b} ${c+$}`,`A ${$} ${$} 0 0 1 ${b+$} ${c}`,`L ${s} ${c}`].join(" ")}if(T==="right"&&k==="left"){const b=Math.max(i,s)+10,L=Math.abs(c-r),$=Math.min(5,L/2,10/2);return L<$*4?`M ${i} ${r} L ${b} ${r} L ${b} ${c} L ${s} ${c}`:H?[`M ${i} ${r}`,`L ${b-$} ${r}`,`A ${$} ${$} 0 0 1 ${b} ${r+$}`,`L ${b} ${c-$}`,`A ${$} ${$} 0 0 1 ${b-$} ${c}`,`L ${s} ${c}`].join(" "):[`M ${i} ${r}`,`L ${b-$} ${r}`,`A ${$} ${$} 0 0 0 ${b} ${r-$}`,`L ${b} ${c+$}`,`A ${$} ${$} 0 0 0 ${b-$} ${c}`,`L ${s} ${c}`].join(" ")}if(T==="left"&&k==="left"){const b=Math.min(i,s)-10,L=s+10,$=Math.abs(c-r),W=r+(c-r)/2,M=Math.min(5,$/4,10/2);return $<M*4?`M ${i} ${r} L ${b} ${r} L ${b} ${c} L ${s} ${c}`:H?[`M ${i} ${r}`,`L ${b+M} ${r}`,`A ${M} ${M} 0 0 0 ${b} ${r+M}`,`L ${b} ${W-M}`,`A ${M} ${M} 0 0 0 ${b+M} ${W}`,`L ${L-M} ${W}`,`A ${M} ${M} 0 0 1 ${L} ${W+M}`,`L ${L} ${c-M}`,`A ${M} ${M} 0 0 1 ${L-M} ${c}`,`L ${s} ${c}`].join(" "):[`M ${i} ${r}`,`L ${b+M} ${r}`,`A ${M} ${M} 0 0 1 ${b} ${r-M}`,`L ${b} ${W+M}`,`A ${M} ${M} 0 0 1 ${b+M} ${W}`,`L ${L-M} ${W}`,`A ${M} ${M} 0 0 0 ${L} ${W-M}`,`L ${L} ${c+M}`,`A ${M} ${M} 0 0 0 ${L-M} ${c}`,`L ${s} ${c}`].join(" ")}return`M ${i} ${r} L ${s} ${c}`}const na=K(()=>{if(!z.showDependencies)return[];const i=[],r=la.value,s=new Map;We.value.forEach((c,T)=>{c.kind==="item"&&s.set(c.item.name,T)});for(const c of r){const T=c.dependencies_info||[],k=s.get(c.name);if(k!==void 0)for(const h of T){const x=s.get(h.task_id);if(x===void 0)continue;const H=r.find(oa=>oa.name===h.task_id);if(!H)continue;const b=Ee(H),L=Ee(c);if(!b||!L)continue;const $=h.type||"FS";let W,M,U,C;switch($){case"FS":W=b.left+b.width,M=L.left,U="right",C="right";break;case"SS":W=b.left,M=L.left,U="left",C="right";break;case"FF":W=b.left+b.width,M=L.left+L.width,U="right",C="left";break;case"SF":W=b.left,M=L.left+L.width,U="left",C="left";break;default:W=b.left+b.width,M=L.left,U="right",C="right"}const ge=x*Se+Se/2,te=k*Se+Se/2,Ue=Ne(W,ge,M,te,U,C),he=5;let tt;C==="right"?tt=`${M},${te} ${M-he},${te-he} ${M-he},${te+he}`:tt=`${M},${te} ${M+he},${te-he} ${M+he},${te+he}`,i.push({fromTask:H.name,toTask:c.name,fromRow:x,toRow:k,fromX:W,fromY:ge,toX:M,toY:te,type:$,path:Ue,arrowPoints:tt,color:ft[$]||ft.FS})}}return i}),Wt=K(()=>{const i=[],r=la.value,s=new Map;We.value.forEach((h,x)=>{h.kind==="item"&&s.set(h.item.name,x)});const c=new Map;for(const h of vt.value)Qe(h)||c.set(h.name,h);const T=10,k=5;for(const h of r){if(!h.milestone)continue;const x=c.get(h.milestone);if(!x)continue;const H=s.get(h.name),b=s.get(x.name);if(H===void 0||b===void 0)continue;const L=Ee(h);if(!L)continue;const $=ut(x);if($===null)continue;const W=L.left+L.width+sl,M=H*Se+Se/2,U=$-T,C=b*Se+Se/2,ge=Ne(W,M,U,C),te=`${U},${C} ${U-k},${C-k} ${U-k},${C+k}`;i.push({taskName:h.name,milestoneName:x.name,dotX:L.left+L.width,fromX:W,fromY:M,toX:U,toY:C,path:ge,arrowPoints:te})}return i}),Nt=K(()=>We.value.length*Se);return(i,r)=>(d(),u("div",Es,[j.tasks.length===0?(d(),u("div",Us,[e("div",zs,[r[5]||(r[5]=e("i",{class:"fa-solid fa-diagram-project text-4xl text-gray-300 dark:text-gray-600 mb-3"},null,-1)),e("p",Os,n(o(t)("No tasks with dates to display")),1),e("p",Rs,n(o(t)("Add start and due dates to tasks to see them on the Gantt chart")),1)])])):(d(),u(Q,{key:1},[e("div",Bs,[e("div",Ws,[e("div",Ns,[e("div",Vs,[e("span",Hs,n(o(t)("Tasks")),1),re(e("select",{"onUpdate:modelValue":r[0]||(r[0]=s=>S.value=s),class:"text-[10px] bg-transparent border border-gray-300 dark:border-gray-600 rounded px-1.5 py-0.5 text-gray-500 dark:text-gray-400 cursor-pointer focus:outline-none focus:ring-1 focus:ring-orga-500"},[e("option",Gs,n(o(t)("No Grouping")),1),e("option",qs,n(o(t)("By Group")),1),e("option",Ks,n(o(t)("By Status")),1),e("option",Js,n(o(t)("By Priority")),1),e("option",Qs,n(o(t)("By Milestone")),1),e("option",Zs,n(o(t)("By Assignee")),1)],512),[[Et,S.value]]),j.criticalPathTasks.length>0?(d(),u("label",{key:0,class:"flex items-center gap-1 text-[10px] text-gray-500 dark:text-gray-400 cursor-pointer select-none",title:`${j.criticalPathTasks.length} task(s) on critical path`},[re(e("input",{type:"checkbox","onUpdate:modelValue":r[1]||(r[1]=s=>le.value=s),class:"w-3 h-3 rounded border-gray-300 dark:border-gray-600 text-red-600 focus:ring-red-500"},null,512),[[Ja,le.value]]),e("span",null,n(o(t)("Critical Path")),1)],8,Xs)):_("",!0)])]),e("div",{ref_key:"headerScrollRef",ref:V,class:"gantt-header-scroll"},[e("div",{style:oe({width:`${pt.value}px`})},[e("div",Ys,[e("div",er,[(d(!0),u(Q,null,ne(He.value,s=>(d(),u("div",{key:`${s.month}-${s.year}-${s.startIndex}`,style:oe({width:`${s.days*j.cellWidth}px`}),class:"month-header border-r border-gray-300 dark:border-gray-700 px-2 flex items-center bg-white dark:bg-gray-800 flex-shrink-0"},[e("span",tr,n(s.month)+" "+n(s.year),1)],4))),128))]),e("div",ar,[(d(!0),u(Q,null,ne(zt.value,s=>(d(),u("div",{key:`W${s.weekNum}-${s.year}-${s.startIndex}`,style:oe({width:`${s.days*j.cellWidth}px`}),class:"week-header border-r border-gray-200 dark:border-gray-700 px-1 flex items-center justify-center flex-shrink-0"},[e("span",sr,"W"+n(s.weekNum),1)],4))),128))]),e("div",rr,[(d(!0),u(Q,null,ne(X.value,(s,c)=>(d(),u("div",{key:c,style:oe({width:`${j.cellWidth}px`}),class:F(["day-header flex flex-col items-center justify-center text-xs leading-tight flex-shrink-0",Me(s)?"bg-gray-100 dark:bg-gray-800 text-gray-400 dark:text-gray-500":"text-gray-600 dark:text-gray-400",it(s)?"today-header":"",nt(s)?"border-l-2 border-l-gray-300 dark:border-l-gray-600":"border-l border-l-gray-100 dark:border-l-gray-700"])},[e("span",lr,n(Qt(s)),1),e("span",nr,n(kt(s)),1)],6))),128))])])],4)],512)])]),e("div",or,[e("div",ir,[e("div",dr,[e("div",{ref_key:"leftBodyRef",ref:J,class:"gantt-left-body",onScroll:ta},[(d(!0),u(Q,null,ne(We.value,(s,c)=>{var T,k,h;return d(),u(Q,{key:`name-${s.kind==="item"?s.item.name:s.key}`},[s.kind==="group-header"?(d(),u("div",{key:0,class:"h-10 px-3 flex items-center gap-2 border-b border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 cursor-pointer select-none",onClick:x=>ee(s.key)},[e("i",{class:F([O.value.has(s.key)?"fa-solid fa-chevron-right":"fa-solid fa-chevron-down","text-[10px] text-gray-400 dark:text-gray-500 w-3"])},null,2),e("span",cr,n(s.label),1),e("span",gr,"("+n(s.count)+")",1)],8,ur)):o(Qe)(s.item)?(d(),u("div",{key:1,draggable:S.value==="none",onDragstart:x=>Zt(x,s.item,c),onDragend:Rt,onDragover:me(x=>$t(x,c),["prevent"]),onDragleave:ct,onDrop:x=>Fe(x,c),onClick:x=>_t(s.item),class:F(["gantt-task-row h-10 px-3 flex items-center gap-2 border-b border-gray-100 dark:border-gray-700 bg-white dark:bg-gray-900 cursor-pointer select-none overflow-hidden",j.selectedTaskId===s.item.name?"bg-orga-50 dark:bg-orga-900/20":"hover:bg-gray-50/50 dark:hover:bg-gray-800/50",jt(c)?"drag-over":"",Yt(s.item)&&((T=N.value)==null?void 0:T.dragType)==="reorder"?"dragging":"",ea(s.item)?"just-reordered":""])},[S.value==="none"?(d(),u("i",pr)):_("",!0),e("span",{class:F(["w-2 h-2 rounded-full shrink-0",Ge[s.item.status]])},null,2),e("span",{class:"text-sm text-gray-800 dark:text-gray-200 truncate min-w-0 flex-1",title:s.item.subject},n(s.item.subject),9,fr)],42,vr)):(d(),u("div",{key:2,draggable:S.value==="none",onDragstart:x=>Zt(x,s.item,c),onDragend:Rt,onDragover:me(x=>$t(x,c),["prevent"]),onDragleave:ct,onDrop:x=>Fe(x,c),onClick:x=>_t(s.item),class:F(["gantt-task-row h-10 px-3 flex items-center gap-2 border-b border-gray-100 dark:border-gray-700 bg-white dark:bg-gray-900 cursor-pointer select-none transition-all duration-150",j.selectedTaskId===s.item.name?"bg-indigo-100 dark:bg-indigo-900/30":"hover:bg-indigo-50 dark:hover:bg-indigo-900/20",jt(c)?"drag-over":"",((k=N.value)==null?void 0:k.taskId)===s.item.name&&((h=N.value)==null?void 0:h.dragType)==="reorder"?"dragging":""])},[S.value==="none"?(d(),u("i",mr)):_("",!0),e("span",{class:F(["w-2 h-2 rotate-45 shrink-0",Xe[s.item.status]])},null,2),r[6]||(r[6]=e("i",{class:"fa-solid fa-flag text-[10px] text-indigo-400 dark:text-indigo-300"},null,-1)),e("span",xr,n(s.item.subject),1)],42,yr))],64)}),128))],544)]),e("div",{ref_key:"scrollContainerRef",ref:p,class:"gantt-body-scroll",onScroll:_a},[e("div",{class:"relative",style:oe({width:`${pt.value}px`})},[(d(!0),u(Q,null,ne(We.value,(s,c)=>{var T,k,h,x,H,b,L,$,W,M,U;return d(),u(Q,{key:`timeline-${s.kind==="item"?s.item.name:s.key}`},[s.kind==="group-header"?(d(),u("div",{key:0,class:"h-10 relative border-b border-gray-200 dark:border-gray-600 bg-gray-50/80 dark:bg-gray-800/60",onClick:C=>ee(s.key)},[e("div",kr,[(d(!0),u(Q,null,ne(X.value,(C,ge)=>(d(),u("div",{key:ge,style:oe({width:`${j.cellWidth}px`}),class:F(["h-full grid-cell flex-shrink-0",Me(C)?"bg-gray-100/60 dark:bg-gray-800/40":"",nt(C)?"border-l-2 border-l-gray-300 dark:border-l-gray-600":"border-l border-l-gray-100 dark:border-l-gray-800"])},null,6))),128))]),Te.value>=0?(d(),u("div",{key:0,class:"today-marker absolute top-0 bottom-0 w-0.5 bg-sky-500 dark:bg-sky-400 z-10 pointer-events-none",style:oe({left:`${Te.value*j.cellWidth+j.cellWidth/2}px`})},null,4)):_("",!0)],8,br)):o(Qe)(s.item)?(d(),u("div",{key:1,onDragover:me(C=>ye(C,c),["prevent"]),onDragleave:ct,onDrop:C=>Fe(C,c),class:F(["gantt-timeline-row h-10 relative","border-b border-gray-100 dark:border-gray-700",j.selectedTaskId===s.item.name?"bg-orga-50 dark:bg-orga-900/20":"hover:bg-gray-50/50 dark:hover:bg-gray-800/50",jt(c)?"drag-over":"",((T=N.value)==null?void 0:T.taskId)===s.item.name&&((k=N.value)==null?void 0:k.dragType)==="reorder"?"dragging":"",ea(s.item)?"just-reordered":""])},[e("div",_r,[(d(!0),u(Q,null,ne(X.value,(C,ge)=>(d(),u("div",{key:ge,style:oe({width:`${j.cellWidth}px`}),class:F(["h-full grid-cell flex-shrink-0",Me(C)?"bg-gray-100/60 dark:bg-gray-800/40":"",it(C)?"bg-sky-50/50 dark:bg-sky-900/20":"",nt(C)?"border-l-2 border-l-gray-300 dark:border-l-gray-600":"border-l border-l-gray-100 dark:border-l-gray-800"])},null,6))),128))]),Te.value>=0?(d(),u("div",{key:0,class:"today-marker absolute top-0 bottom-0 w-0.5 bg-sky-500 dark:bg-sky-400 z-10 pointer-events-none",style:oe({left:`${Te.value*j.cellWidth+j.cellWidth/2}px`})},null,4)):_("",!0),s.item.start_date?(d(),u("div",{key:1,draggable:s.item.task_scheduling_type!=="Hammock",onClick:me(C=>_t(s.item),["stop"]),onDragstart:me(C=>s.item.task_scheduling_type!=="Hammock"&&ma(C,s.item,c),["stop"]),onDragend:Rt,onDragover:r[2]||(r[2]=me(()=>{},["stop"])),onDrop:me(C=>Fe(C,c),["stop"]),style:oe(ot(s.item)),class:F(["gantt-bar absolute top-1.5 h-7 z-20","flex items-center px-2 overflow-hidden gap-1","select-none",s.item.task_scheduling_type==="Hammock"?"gantt-bar-hammock":s.item.task_scheduling_type==="Buffer"?"gantt-bar-buffer":Ge[s.item.status],s.item.task_scheduling_type!=="Hammock"&&s.item.task_scheduling_type!=="Buffer"?ht[s.item.priority]:"",s.item.task_scheduling_type!=="Hammock"?"cursor-grab":"cursor-default",j.selectedTaskId===s.item.name?"ring-2 ring-orga-500 ring-offset-1":"",Yt(s.item)&&((h=N.value)==null?void 0:h.dragType)==="dates"?"opacity-50 shadow-lg":"",B(s.item.name)&&"gantt-bar-critical",le.value&&j.criticalPathTasks.length>0&&!B(s.item.name)&&"opacity-40"]),title:s.item.task_scheduling_type==="Hammock"?`${s.item.subject} (Hammock — auto-calculated)
${s.item.start_date} - ${s.item.due_date||s.item.start_date}
Duration: ${Be(s.item)} day(s)`:s.item.task_scheduling_type==="Buffer"?`${s.item.subject} (Buffer)
${s.item.start_date} - ${s.item.due_date||s.item.start_date}
Buffer: ${s.item.buffer_size||0} days, ${Math.round(s.item.buffer_consumed||0)}% consumed`:`${s.item.subject}
${s.item.start_date} - ${s.item.due_date||s.item.start_date}
Duration: ${Be(s.item)} day(s)${s.item.depends_on_group?`
Group dependency: ${s.item.depends_on_group}${s.item.is_blocked?" (BLOCKED)":" (unblocked)"}`:""}

Drag bar left/right to change dates
Drag row handle to reorder`},[s.item.task_scheduling_type==="Hammock"?(d(),u("i",wr)):s.item.task_scheduling_type==="Buffer"?(d(),u("i",Dr)):s.item.depends_on_group&&s.item.is_blocked?(d(),u("i",{key:2,class:"fa-solid fa-lock text-[9px] text-amber-600 dark:text-amber-400 shrink-0",title:`Blocked by group: ${s.item.depends_on_group}`},null,8,Cr)):_("",!0),e("span",jr,n(s.item.subject),1),Be(s.item)>1?(d(),u("span",Tr,n(Be(s.item))+"d ",1)):_("",!0),s.item.task_scheduling_type!=="Buffer"&&((x=s.item.progress)!=null?x:0)>0?(d(),u("div",{key:4,class:"gantt-bar-progress absolute bottom-0 left-0 h-1 rounded-b",style:oe({width:`${(H=s.item.progress)!=null?H:0}%`})},null,4)):_("",!0),s.item.task_scheduling_type==="Buffer"&&((b=s.item.buffer_consumed)!=null?b:0)>0?(d(),u("div",{key:5,class:F(["gantt-buffer-consumption",[((L=s.item.buffer_consumed)!=null?L:0)<=33?"buffer-healthy":(($=s.item.buffer_consumed)!=null?$:0)<=66?"buffer-caution":"buffer-critical"]]),style:oe({width:`${Math.min(100,(W=s.item.buffer_consumed)!=null?W:0)}%`})},null,6)):_("",!0),s.item.task_scheduling_type!=="Hammock"?(d(),u("div",{key:6,class:F(["dep-create-handle",E.value===s.item.name?"dep-target-active":""]),onMousedown:me(C=>xe(s.item.name,C),["stop"]),title:o(t)("Drag to create dependency")},[...r[7]||(r[7]=[e("div",{class:"dep-handle-dot"},null,-1)])],42,Mr)):_("",!0)],46,$r)):_("",!0),s.item.start_date&&s.item.assigned_to_name?(d(),Pe(qt,{key:2,name:s.item.assigned_to_name,image:s.item.assigned_to_image,size:"xs",color:"orga",class:"!w-5 !h-5 !text-[9px] absolute top-1/2 -translate-y-1/2 z-30",style:oe(Ot(s.item)),title:s.item.assigned_to_name},null,8,["name","image","style","title"])):_("",!0),s.item.start_date?_("",!0):(d(),u("div",Sr,[r[8]||(r[8]=e("i",{class:"fa-solid fa-calendar-xmark mr-1"},null,-1)),R(" "+n(o(t)("No dates set")),1)]))],42,hr)):(d(),u("div",{key:2,onClick:C=>_t(s.item),onDragover:me(C=>ye(C,c),["prevent"]),onDragleave:ct,onDrop:C=>Fe(C,c),class:F(["gantt-timeline-row h-10 relative border-b border-gray-100 dark:border-gray-700 bg-indigo-50/30 dark:bg-indigo-950/20 cursor-pointer transition-colors",j.selectedTaskId===s.item.name?"bg-indigo-100 dark:bg-indigo-900/30":"hover:bg-indigo-50 dark:hover:bg-indigo-900/20",jt(c)?"drag-over":"",((M=N.value)==null?void 0:M.taskId)===s.item.name&&((U=N.value)==null?void 0:U.dragType)==="reorder"?"dragging":""])},[e("div",Fr,[(d(!0),u(Q,null,ne(X.value,(C,ge)=>(d(),u("div",{key:ge,style:oe({width:`${j.cellWidth}px`}),class:F(["h-full grid-cell flex-shrink-0",Me(C)?"bg-gray-100/60 dark:bg-gray-800/40":"",it(C)?"bg-sky-50/50 dark:bg-sky-900/20":"",nt(C)?"border-l-2 border-l-gray-300 dark:border-l-gray-600":"border-l border-l-gray-100 dark:border-l-gray-800"])},null,6))),128))]),Te.value>=0?(d(),u("div",{key:0,class:"today-marker absolute top-0 bottom-0 w-0.5 bg-sky-500 dark:bg-sky-400 z-10 pointer-events-none",style:oe({left:`${Te.value*j.cellWidth+j.cellWidth/2}px`})},null,4)):_("",!0),s.item.due_date?(d(),u("div",{key:1,style:oe(Ct(s.item)||dt(s.item)),onMousedown:C=>wt(C,s.item),class:F(["absolute top-1/2 -translate-y-1/2 w-4 h-4 rotate-45 cursor-grab z-20",Ie(s.item)?"opacity-70 scale-110 cursor-grabbing":"transition-all",Xe[s.item.status],j.selectedTaskId===s.item.name?"ring-2 ring-orga-500 ring-offset-2 dark:ring-offset-gray-900":"hover:scale-110"]),title:`${s.item.subject}
Due: ${s.item.due_date}
Status: ${s.item.status}

Drag to change date`},null,46,Ir)):_("",!0),Ie(s.item)&&Y.value!==0?(d(),u("div",{key:2,style:oe(dt(s.item)),class:F(["absolute top-1/2 -translate-y-1/2 w-4 h-4 rotate-45 z-15 pointer-events-none opacity-30 border-2 border-dashed",Xe[s.item.status]])},null,6)):_("",!0),s.item.due_date?(d(),u("div",{key:3,style:oe({left:`${parseInt((Ct(s.item)||dt(s.item)).left||"0")+22}px`}),class:"absolute top-1/2 -translate-y-1/2 text-xs text-indigo-600 dark:text-indigo-300 font-medium whitespace-nowrap pointer-events-none"},[R(n(s.item.subject)+" ",1),Ie(s.item)&&Y.value!==0?(d(),u("span",Pr," ("+n(Y.value>0?"+":"")+n(Y.value)+"d) ",1)):_("",!0)],4)):_("",!0)],42,Lr))],64)}),128)),G.value?(d(),u("svg",{key:0,class:"dependency-arrows",width:pt.value,height:Nt.value,style:{"z-index":"30","pointer-events":"none"}},[e("line",{x1:G.value.x1,y1:G.value.y1,x2:G.value.x2,y2:G.value.y2,stroke:E.value?"#16a34a":"#6b7280","stroke-width":"2","stroke-dasharray":"6,4","stroke-linecap":"round"},null,8,Er),e("circle",{cx:G.value.x1,cy:G.value.y1,r:"4",fill:E.value?"#16a34a":"#6b7280"},null,8,Ur),E.value?(d(),u("circle",{key:0,cx:G.value.x2,cy:G.value.y2,r:"5",fill:"#16a34a",opacity:"0.6"},null,8,zr)):_("",!0)],8,Ar)):_("",!0),j.showDependencies&&na.value.length>0?(d(),u("svg",{key:1,class:"dependency-arrows",width:pt.value,height:Nt.value},[(d(!0),u(Q,null,ne(na.value,s=>(d(),u("g",{key:`${s.fromTask}-${s.toTask}`,opacity:le.value&&j.criticalPathTasks.length>0?B(s.fromTask)&&B(s.toTask)?1:.15:void 0},[e("circle",{cx:s.fromX,cy:s.fromY,r:le.value&&B(s.fromTask)&&B(s.toTask)?4:3,fill:le.value&&B(s.fromTask)&&B(s.toTask)?"#dc2626":s.color,opacity:"0.6"},null,8,Br),e("path",{d:s.path,stroke:le.value&&B(s.fromTask)&&B(s.toTask)?"#dc2626":s.color,"stroke-width":le.value&&B(s.fromTask)&&B(s.toTask)?2.5:1.5,fill:"none","stroke-linecap":"round",opacity:"0.5"},null,8,Wr),e("polygon",{points:s.arrowPoints,fill:le.value&&B(s.fromTask)&&B(s.toTask)?"#dc2626":s.color,opacity:"0.6"},null,8,Nr)],8,Rr))),128))],8,Or)):_("",!0),Wt.value.length>0?(d(),u("svg",{key:2,class:"milestone-connections",width:pt.value,height:Nt.value},[(d(!0),u(Q,null,ne(Wt.value,s=>(d(),u("g",{key:`ms-${s.taskName}-${s.milestoneName}`},[e("circle",{cx:s.dotX,cy:s.fromY,r:"3",fill:"#7c3aed",opacity:"0.6"},null,8,Hr),e("path",{d:s.path,stroke:"#7c3aed","stroke-width":1.5,fill:"none","stroke-linecap":"round",opacity:"0.5"},null,8,Gr),e("polygon",{points:s.arrowPoints,fill:"#7c3aed",opacity:"0.6"},null,8,qr)]))),128))],8,Vr)):_("",!0)],4)],544)]),re(e("div",{ref_key:"headerScrollbarRef",ref:De,class:"gantt-header-scrollbar flex-shrink-0",onMousedown:ha},[e("div",{class:"scrollbar-progress",style:oe({width:ra.value+"%"})},null,4),e("div",{style:oe(ba.value),onMousedown:me(ka,["stop"]),onMouseenter:r[3]||(r[3]=s=>Oe.value=!0),onMouseleave:r[4]||(r[4]=s=>Oe.value=!1)},[je.value?(d(),u("div",Kr,[e("div",{class:F(["velocity-zone zone-2x-left",{active:Le.value==="zone-2x-left"}])},[...r[9]||(r[9]=[e("span",{class:"velocity-label"},"«",-1)])],2),e("div",{class:F(["velocity-zone zone-1x-left",{active:Le.value==="zone-1x-left"}])},[...r[10]||(r[10]=[e("span",{class:"velocity-label"},"‹",-1)])],2),e("div",{class:F(["velocity-zone zone-center",{active:Le.value==="zone-center"}])},[...r[11]||(r[11]=[e("span",{class:"velocity-label"},"·",-1)])],2),e("div",{class:F(["velocity-zone zone-1x-right",{active:Le.value==="zone-1x-right"}])},[...r[12]||(r[12]=[e("span",{class:"velocity-label"},"›",-1)])],2),e("div",{class:F(["velocity-zone zone-2x-right",{active:Le.value==="zone-2x-right"}])},[...r[13]||(r[13]=[e("span",{class:"velocity-label"},"»",-1)])],2)])):_("",!0)],36)],544),[[ws,Ze.value]])]),e("div",Jr,[e("span",Qr,[r[14]||(r[14]=e("span",{class:"w-3 h-3 rounded bg-gray-400"},null,-1)),R(" "+n(o(t)("Open")),1)]),e("span",Zr,[r[15]||(r[15]=e("span",{class:"w-3 h-3 rounded bg-blue-500"},null,-1)),R(" "+n(o(t)("Working")),1)]),e("span",Xr,[r[16]||(r[16]=e("span",{class:"w-3 h-3 rounded bg-purple-500"},null,-1)),R(" "+n(o(t)("Review")),1)]),e("span",Yr,[r[17]||(r[17]=e("span",{class:"w-3 h-3 rounded bg-green-500"},null,-1)),R(" "+n(o(t)("Completed")),1)]),e("span",el,[r[18]||(r[18]=e("span",{class:"w-2.5 h-2.5 rotate-45 bg-indigo-500"},null,-1)),R(" "+n(o(t)("Milestone")),1)]),e("span",tl,[r[19]||(r[19]=e("span",{class:"w-0.5 h-4 bg-sky-500 dark:bg-sky-400 shadow-sm"},null,-1)),R(" "+n(o(t)("Today")),1)]),e("span",al,[r[20]||(r[20]=e("span",{class:"w-3 h-3 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-sm"},null,-1)),R(" "+n(o(t)("Weekend")),1)])])],64))]))}}),ll=Qa(rl,[["__scopeId","data-v-bdb8d475"]]),nl={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto"},ol={class:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700"},il={class:"text-lg font-semibold text-gray-800 dark:text-gray-100"},dl=["id","placeholder"],ul=["id","placeholder"],cl={class:"grid grid-cols-3 gap-4"},gl={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},vl={class:"relative"},pl={class:"truncate flex-1"},fl={key:1,class:"text-gray-400 dark:text-gray-500 flex-1"},yl={key:0,class:"absolute left-0 top-full mt-1 w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50 py-1 max-h-48 overflow-y-auto"},ml=["onClick"],xl={class:"truncate"},bl={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},kl={value:""},hl={value:"Task"},_l={value:"Bug"},$l={value:"Feature"},wl={value:"Research"},Dl={value:"Meeting"},Cl={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},jl={value:"Low"},Tl={value:"Medium"},Ml={value:"High"},Sl={value:"Urgent"},Ll={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Fl={value:"Open"},Il={value:"In Progress"},Pl={value:"Review"},Al={value:"Completed"},El={class:"grid grid-cols-2 gap-4"},Ul={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},zl={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},Ol={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Rl={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},Bl={key:0,class:"text-xs text-red-500 mt-1"},Wl={key:1,class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},Nl={class:"text-xs text-gray-600 dark:text-gray-400 leading-tight"},Vl={class:"text-gray-400 dark:text-gray-500"},Hl={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Gl={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},ql={key:0,class:"p-3 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg"},Kl={class:"text-sm text-red-600 dark:text-red-400"},Jl={class:"flex justify-end gap-3 p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50"},Ql=["disabled"],Zl=["disabled"],Xl={key:0,class:"fa-solid fa-spinner fa-spin"},Yl=xt({__name:"CreateTaskModal",props:{isOpen:{type:Boolean},projectId:{},initialStatus:{default:"Open"},autoTrailDefault:{type:Boolean,default:!1}},emits:["close","created"],setup(j,{emit:q}){const A=j,ie=q,{createTask:z}=Za(),{getAssignableUsers:le}=Ds(),{error:B}=Kt(),m=v({subject:"",description:"",assigned_to:null,task_type:"",priority:"Medium",status:A.initialStatus,start_date:null,due_date:null,estimated_cost:null,auto_trail_start:!1}),w=v(!1),E=v({}),G=v({}),xe=v([]),N=v(!1),de=K(()=>m.value.assigned_to&&xe.value.find(V=>V.name===m.value.assigned_to)||null);function ae(V){G.value[V]=!0,S(V)}function S(V){V==="subject"&&(m.value.subject.trim()?m.value.subject.length>255?E.value.subject=t("Subject cannot exceed 255 characters"):delete E.value.subject:E.value.subject=t("Task subject is required")),(V==="dates"||V==="start_date"||V==="due_date")&&(m.value.start_date&&m.value.due_date&&new Date(m.value.due_date)<new Date(m.value.start_date)?E.value.dates=t("End date cannot be before start date"):delete E.value.dates)}function O(){return se(this,null,function*(){try{const V=yield le({limit:100});xe.value=Array.isArray(V)?V:[]}catch(V){console.error("Failed to load assignable users:",V)}})}const ee=K(()=>m.value.subject.trim().length>0);function ce(){return E.value={},m.value.subject.trim()||(E.value.subject=t("Task subject is required")),m.value.subject.length>255&&(E.value.subject=t("Subject cannot exceed 255 characters")),m.value.start_date&&m.value.due_date&&new Date(m.value.due_date)<new Date(m.value.start_date)&&(E.value.dates=t("End date cannot be before start date")),Object.keys(E.value).length===0}function Z(){return se(this,null,function*(){if(G.value={subject:!0},!!ce()){w.value=!0;try{const V=yield z({project:A.projectId,subject:m.value.subject,description:m.value.description||void 0,assigned_to:m.value.assigned_to||void 0,task_type:m.value.task_type||void 0,priority:m.value.priority,status:m.value.status,start_date:m.value.start_date||void 0,due_date:m.value.due_date||void 0,estimated_cost:m.value.estimated_cost||void 0,auto_trail_start:m.value.auto_trail_start?1:void 0});ie("created",{name:V.name,subject:m.value.subject}),ue(),ie("close")}catch(V){E.value.submit=V.message||t("Failed to create task"),B(t("Failed to create task"),E.value.submit)}finally{w.value=!1}}})}function ue(){m.value={subject:"",description:"",assigned_to:null,task_type:"",priority:"Medium",status:A.initialStatus,start_date:null,due_date:null,estimated_cost:null,auto_trail_start:!1},E.value={},G.value={},N.value=!1}function Y(){ue(),ie("close")}return rt(()=>A.isOpen,V=>{V&&(O(),m.value.status=A.initialStatus,m.value.auto_trail_start=A.autoTrailDefault)}),(V,p)=>(d(),Pe(ya,{to:"body"},[j.isOpen?(d(),u("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:me(Y,["self"])},[e("div",nl,[e("div",ol,[e("h2",il,n(o(t)("Create New Task")),1),e("button",{onClick:Y,class:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded"},[...p[16]||(p[16]=[e("i",{class:"fa-solid fa-xmark text-xl"},null,-1)])])]),e("form",{onSubmit:me(Z,["prevent"]),class:"p-4 space-y-4"},[ve(fa,{label:o(t)("Task Subject"),required:!0,error:E.value.subject,touched:G.value.subject,"max-length":255,"current-length":m.value.subject.length,"show-success":m.value.subject.trim().length>0,hint:o(t)("A clear, actionable title for the task")},{default:Ut(({id:J,hasError:De,isValid:_e})=>[re(e("input",{id:J,"onUpdate:modelValue":p[0]||(p[0]=Ce=>m.value.subject=Ce),type:"text",maxlength:"255",placeholder:o(t)("Enter task title..."),onBlur:p[1]||(p[1]=Ce=>ae("subject")),onInput:p[2]||(p[2]=Ce=>G.value.subject&&S("subject")),class:F(["w-full px-3 py-2 border rounded-lg text-sm transition-colors","bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100","focus:outline-none focus:ring-2",De?"border-red-500 focus:ring-red-500/20 focus:border-red-500":_e?"border-green-500 focus:ring-green-500/20 focus:border-green-500":"border-gray-300 dark:border-gray-600 focus:ring-orga-500/20 focus:border-orga-500"])},null,42,dl),[[be,m.value.subject]])]),_:1},8,["label","error","touched","current-length","show-success","hint"]),ve(fa,{label:o(t)("Description"),hint:o(t)("Add details, context, or acceptance criteria")},{default:Ut(({id:J})=>[re(e("textarea",{id:J,"onUpdate:modelValue":p[3]||(p[3]=De=>m.value.description=De),rows:"3",placeholder:o(t)("Add details about this task..."),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-orga-500/20 focus:border-orga-500 transition-colors"},null,8,ul),[[be,m.value.description]])]),_:1},8,["label","hint"]),e("div",cl,[e("div",null,[e("label",gl,n(o(t)("Assign To")),1),e("div",vl,[e("button",{type:"button",onClick:p[4]||(p[4]=J=>N.value=!N.value),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100 flex items-center gap-2 text-left"},[de.value?(d(),u(Q,{key:0},[ve(qt,{name:de.value.full_name,image:de.value.user_image,size:"xs",color:"orga",class:"!w-5 !h-5 !text-[10px]"},null,8,["name","image"]),e("span",pl,n(de.value.full_name||de.value.name),1)],64)):(d(),u("span",fl,n(o(t)("Unassigned")),1)),p[17]||(p[17]=e("i",{class:"fa-solid fa-chevron-down text-[10px] text-gray-400 shrink-0"},null,-1))]),N.value?(d(),u("div",yl,[e("button",{type:"button",onClick:p[5]||(p[5]=J=>{m.value.assigned_to=null,N.value=!1}),class:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-left"},n(o(t)("Unassigned")),1),(d(!0),u(Q,null,ne(xe.value,J=>(d(),u("button",{key:J.name,type:"button",onClick:De=>{m.value.assigned_to=J.name,N.value=!1},class:F(["w-full flex items-center gap-2 px-3 py-2 text-sm transition-colors text-left",m.value.assigned_to===J.name?"bg-orga-50 dark:bg-orga-900/20 text-orga-700 dark:text-orga-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"])},[ve(qt,{name:J.full_name,image:J.user_image,size:"xs",color:"orga",class:"!w-5 !h-5 !text-[10px]"},null,8,["name","image"]),e("span",xl,n(J.full_name||J.name),1)],10,ml))),128))])):_("",!0),N.value?(d(),u("div",{key:1,class:"fixed inset-0 z-40",onClick:p[6]||(p[6]=J=>N.value=!1)})):_("",!0)])]),e("div",null,[e("label",bl,n(o(t)("Task Type")),1),re(e("select",{"onUpdate:modelValue":p[7]||(p[7]=J=>m.value.task_type=J),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100"},[e("option",kl,n(o(t)("None")),1),e("option",hl,n(o(t)("Task")),1),e("option",_l,n(o(t)("Bug")),1),e("option",$l,n(o(t)("Feature")),1),e("option",wl,n(o(t)("Research")),1),e("option",Dl,n(o(t)("Meeting")),1)],512),[[Et,m.value.task_type]])]),e("div",null,[e("label",Cl,n(o(t)("Priority")),1),re(e("select",{"onUpdate:modelValue":p[8]||(p[8]=J=>m.value.priority=J),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100"},[e("option",jl,n(o(t)("Low")),1),e("option",Tl,n(o(t)("Medium")),1),e("option",Ml,n(o(t)("High")),1),e("option",Sl,n(o(t)("Urgent")),1)],512),[[Et,m.value.priority]])])]),e("div",null,[e("label",Ll,n(o(t)("Status")),1),re(e("select",{"onUpdate:modelValue":p[9]||(p[9]=J=>m.value.status=J),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100"},[e("option",Fl,n(o(t)("Open")),1),e("option",Il,n(o(t)("In Progress")),1),e("option",Pl,n(o(t)("Review")),1),e("option",Al,n(o(t)("Completed")),1)],512),[[Et,m.value.status]])]),e("div",null,[e("div",El,[e("div",null,[e("label",Ul,n(o(t)("Start Date")),1),re(e("input",{"onUpdate:modelValue":p[10]||(p[10]=J=>m.value.start_date=J),type:"date",onChange:p[11]||(p[11]=J=>S("dates")),class:F(["w-full px-3 py-2 border rounded-lg text-sm bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100",E.value.dates?"border-red-500":"border-gray-300 dark:border-gray-600"])},null,34),[[be,m.value.start_date]]),e("p",zl,n(o(t)("When work begins")),1)]),e("div",null,[e("label",Ol,n(o(t)("End Date")),1),re(e("input",{"onUpdate:modelValue":p[12]||(p[12]=J=>m.value.due_date=J),type:"date",onChange:p[13]||(p[13]=J=>S("dates")),class:F(["w-full px-3 py-2 border rounded-lg text-sm bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100",E.value.dates?"border-red-500":"border-gray-300 dark:border-gray-600"])},null,34),[[be,m.value.due_date]]),e("p",Rl,n(o(t)("When work is due")),1)])]),E.value.dates?(d(),u("p",Bl,n(E.value.dates),1)):(d(),u("p",Wl,[p[18]||(p[18]=e("i",{class:"fa-solid fa-circle-info mr-1"},null,-1)),R(" "+n(o(t)("Both dates are needed to display task as a bar in Gantt chart")),1)]))]),e("label",{class:F(["flex items-center gap-2.5 px-3 py-2 rounded-lg cursor-pointer transition-colors",m.value.auto_trail_start?"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800":"bg-gray-50 dark:bg-gray-800/50 border border-gray-100 dark:border-gray-700"])},[re(e("input",{type:"checkbox","onUpdate:modelValue":p[14]||(p[14]=J=>m.value.auto_trail_start=J),class:"w-3.5 h-3.5 rounded accent-blue-500 cursor-pointer flex-shrink-0"},null,512),[[Ja,m.value.auto_trail_start]]),e("span",Nl,[R(n(o(t)("Auto-Trail Start"))+" ",1),e("span",Vl," — "+n(o(t)("trails to today while Open at 0%")),1)])],2),e("div",null,[e("label",Hl,n(o(t)("Estimated Cost (€)")),1),re(e("input",{"onUpdate:modelValue":p[15]||(p[15]=J=>m.value.estimated_cost=J),type:"number",min:"0",step:"0.01",placeholder:"0.00",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-orga-500/20 focus:border-orga-500 transition-colors"},null,512),[[be,m.value.estimated_cost,void 0,{number:!0}]]),e("p",Gl,n(o(t)("Planned budget for this task")),1)]),E.value.submit?(d(),u("div",ql,[e("p",Kl,n(E.value.submit),1)])):_("",!0)],32),e("div",Jl,[e("button",{type:"button",onClick:Y,disabled:w.value,class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50"},n(o(t)("Cancel")),9,Ql),e("button",{type:"submit",onClick:Z,disabled:w.value||!ee.value,class:"px-4 py-2 text-sm font-medium text-white bg-orga-500 rounded-lg hover:bg-orga-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[w.value?(d(),u("i",Xl)):_("",!0),R(" "+n(w.value?o(t)("Creating..."):o(t)("Create Task")),1)],8,Zl)])])])):_("",!0)]))}}),en={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto"},tn={class:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700"},an={class:"text-lg font-semibold text-gray-800 dark:text-gray-100"},sn=["id","placeholder"],rn=["id","placeholder"],ln={class:"grid grid-cols-2 gap-4"},nn={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},on={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},dn={value:"Upcoming"},un={value:"In Progress"},cn={value:"Completed"},gn={value:"Missed"},vn={key:0,class:"p-3 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg"},pn={class:"text-sm text-red-600 dark:text-red-400"},fn={class:"flex justify-end gap-3 p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50"},yn=["disabled"],mn=["disabled"],xn={key:0,class:"fa-solid fa-spinner fa-spin"},bn=xt({__name:"CreateMilestoneModal",props:{isOpen:{type:Boolean},projectId:{}},emits:["close","created"],setup(j,{emit:q}){const A=j,ie=q,{createMilestone:z}=Xa(),{error:le}=Kt(),B=v({milestone_name:"",description:"",due_date:null,status:"Upcoming"}),m=v(!1),w=v({}),E=v({}),G=K(()=>B.value.milestone_name.trim().length>0);function xe(ee){E.value[ee]=!0,N()}function N(ee){B.value.milestone_name.trim()?B.value.milestone_name.length>255?w.value.milestone_name=t("Name cannot exceed 255 characters"):delete w.value.milestone_name:w.value.milestone_name=t("Milestone name is required")}function de(){return w.value={},B.value.milestone_name.trim()||(w.value.milestone_name=t("Milestone name is required")),B.value.milestone_name.length>255&&(w.value.milestone_name=t("Name cannot exceed 255 characters")),Object.keys(w.value).length===0}function ae(){return se(this,null,function*(){if(E.value={milestone_name:!0},!!de()){m.value=!0;try{const ee=yield z({project:A.projectId,milestone_name:B.value.milestone_name,description:B.value.description||void 0,due_date:B.value.due_date||void 0,status:B.value.status});ie("created",{name:ee.name,milestone_name:ee.milestone_name}),S(),ie("close")}catch(ee){w.value.submit=ee.message||t("Failed to create milestone"),le(t("Failed to create milestone"),w.value.submit)}finally{m.value=!1}}})}function S(){B.value={milestone_name:"",description:"",due_date:null,status:"Upcoming"},w.value={},E.value={}}function O(){S(),ie("close")}return rt(()=>A.isOpen,ee=>{ee||S()}),(ee,ce)=>(d(),Pe(ya,{to:"body"},[j.isOpen?(d(),u("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:me(O,["self"])},[e("div",en,[e("div",tn,[e("h2",an,n(o(t)("Create New Milestone")),1),e("button",{onClick:O,class:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded"},[...ce[6]||(ce[6]=[e("i",{class:"fa-solid fa-xmark text-xl"},null,-1)])])]),e("form",{onSubmit:me(ae,["prevent"]),class:"p-4 space-y-4"},[ve(fa,{label:o(t)("Milestone Name"),required:!0,error:w.value.milestone_name,touched:E.value.milestone_name,"max-length":255,"current-length":B.value.milestone_name.length,"show-success":B.value.milestone_name.trim().length>0,hint:o(t)("A key deliverable or checkpoint for the project")},{default:Ut(({id:Z,hasError:ue,isValid:Y})=>[re(e("input",{id:Z,"onUpdate:modelValue":ce[0]||(ce[0]=V=>B.value.milestone_name=V),type:"text",maxlength:"255",placeholder:o(t)("Enter milestone name..."),onBlur:ce[1]||(ce[1]=V=>xe("milestone_name")),onInput:ce[2]||(ce[2]=V=>E.value.milestone_name&&N("milestone_name")),class:F(["w-full px-3 py-2 border rounded-lg text-sm transition-colors","bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100","focus:outline-none focus:ring-2",ue?"border-red-500 focus:ring-red-500/20 focus:border-red-500":Y?"border-green-500 focus:ring-green-500/20 focus:border-green-500":"border-gray-300 dark:border-gray-600 focus:ring-orga-500/20 focus:border-orga-500"])},null,42,sn),[[be,B.value.milestone_name]])]),_:1},8,["label","error","touched","current-length","show-success","hint"]),ve(fa,{label:o(t)("Description"),hint:o(t)("Add details or acceptance criteria for this milestone")},{default:Ut(({id:Z})=>[re(e("textarea",{id:Z,"onUpdate:modelValue":ce[3]||(ce[3]=ue=>B.value.description=ue),rows:"3",placeholder:o(t)("Add details about this milestone..."),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-orga-500/20 focus:border-orga-500 transition-colors"},null,8,rn),[[be,B.value.description]])]),_:1},8,["label","hint"]),e("div",ln,[e("div",null,[e("label",nn,n(o(t)("Target Date")),1),re(e("input",{"onUpdate:modelValue":ce[4]||(ce[4]=Z=>B.value.due_date=Z),type:"date",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100"},null,512),[[be,B.value.due_date]])]),e("div",null,[e("label",on,n(o(t)("Status")),1),re(e("select",{"onUpdate:modelValue":ce[5]||(ce[5]=Z=>B.value.status=Z),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100"},[e("option",dn,n(o(t)("Upcoming")),1),e("option",un,n(o(t)("In Progress")),1),e("option",cn,n(o(t)("Completed")),1),e("option",gn,n(o(t)("Missed")),1)],512),[[Et,B.value.status]])])]),w.value.submit?(d(),u("div",vn,[e("p",pn,n(w.value.submit),1)])):_("",!0)],32),e("div",fn,[e("button",{type:"button",onClick:O,disabled:m.value,class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50"},n(o(t)("Cancel")),9,yn),e("button",{type:"submit",onClick:ae,disabled:m.value||!G.value,class:"px-4 py-2 text-sm font-medium text-white bg-orga-500 rounded-lg hover:bg-orga-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[m.value?(d(),u("i",xn)):_("",!0),R(" "+n(m.value?o(t)("Creating..."):o(t)("Create Milestone")),1)],8,mn)])])])):_("",!0)]))}}),kn={key:0,class:"fixed inset-0 z-[100] flex items-center justify-center p-4"},hn={class:"relative bg-white dark:bg-gray-900 rounded-xl shadow-2xl w-full max-w-md border border-gray-200 dark:border-gray-700"},_n={class:"flex items-center gap-3 p-5 pb-4 border-b border-red-200 dark:border-red-900/50 bg-red-50 dark:bg-red-950/30 rounded-t-xl"},$n={class:"flex-1 min-w-0"},wn={class:"text-lg font-semibold text-red-900 dark:text-red-200 m-0"},Dn=["disabled"],Cn={class:"p-5 space-y-4"},jn={class:"text-sm text-gray-700 dark:text-gray-300 m-0"},Tn={class:"text-red-600 dark:text-red-400"},Mn={class:"bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-800/50 rounded-lg p-3 space-y-1.5"},Sn={class:"text-xs font-semibold text-red-800 dark:text-red-300 uppercase tracking-wider m-0"},Ln={class:"list-none p-0 m-0 space-y-1"},Fn={class:"flex items-center gap-2 text-sm text-red-700 dark:text-red-400"},In={class:"flex items-center gap-2 text-sm text-red-700 dark:text-red-400"},Pn={class:"flex items-center gap-2 text-sm text-red-700 dark:text-red-400"},An={class:"block text-sm text-gray-700 dark:text-gray-300 mb-2"},En={class:"text-gray-900 dark:text-gray-100 select-all"},Un=["placeholder","disabled"],zn={class:"flex justify-end gap-3 p-5 pt-3 border-t border-gray-200 dark:border-gray-700"},On=["disabled"],Rn=["disabled"],Bn={key:0,class:"fa-solid fa-spinner fa-spin"},Wn={key:1,class:"fa-solid fa-trash"},Nn=xt({__name:"DeleteProjectModal",props:{isOpen:{type:Boolean},projectName:{},projectLabel:{},taskCount:{},milestoneCount:{}},emits:["close","deleted"],setup(j,{emit:q}){const A=j,ie=q,{deleteProject:z}=Ya(),{success:le,error:B}=Kt(),m=v(""),w=v(!1),E=v(null),G=K(()=>m.value===A.projectLabel);rt(()=>A.isOpen,de=>{de&&(m.value="",w.value=!1,At(()=>{var ae;return(ae=E.value)==null?void 0:ae.focus()}))});function xe(){return se(this,null,function*(){if(!(!G.value||w.value)){w.value=!0;try{yield z(A.projectName),le(t("Project deleted"),t('"{0}" and all associated data have been permanently deleted.',[A.projectLabel])),ie("deleted")}catch(de){console.error("Failed to delete project:",de),B(t("Delete failed"),de.message||t("Could not delete the project. Please try again.")),w.value=!1}}})}function N(){w.value||ie("close")}return(de,ae)=>(d(),Pe(ya,{to:"body"},[j.isOpen?(d(),u("div",kn,[e("div",{class:"absolute inset-0 bg-black/60",onClick:N}),e("div",hn,[e("div",_n,[ae[2]||(ae[2]=e("div",{class:"w-10 h-10 rounded-full bg-red-100 dark:bg-red-900/50 flex items-center justify-center flex-shrink-0"},[e("i",{class:"fa-solid fa-triangle-exclamation text-red-600 dark:text-red-400 text-lg"})],-1)),e("div",$n,[e("h2",wn,n(o(t)("Delete Project")),1)]),e("button",{onClick:N,disabled:w.value,class:"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors disabled:opacity-50"},[...ae[1]||(ae[1]=[e("i",{class:"fa-solid fa-xmark text-lg"},null,-1)])],8,Dn)]),e("div",Cn,[e("p",jn,[R(n(o(t)("Are you sure you want to delete this project?"))+" "+n(o(t)("This action"))+" ",1),e("strong",Tn,n(o(t)("cannot be undone")),1),ae[3]||(ae[3]=R(". ",-1))]),e("div",Mn,[e("p",Sn,n(o(t)("This will permanently delete:")),1),e("ul",Ln,[e("li",Fn,[ae[4]||(ae[4]=e("i",{class:"fa-solid fa-folder text-xs w-4 text-center"},null,-1)),R(" "+n(o(t)("The project"))+' "',1),e("strong",null,n(j.projectLabel),1),ae[5]||(ae[5]=R('" ',-1))]),e("li",In,[ae[6]||(ae[6]=e("i",{class:"fa-solid fa-list-check text-xs w-4 text-center"},null,-1)),R(" "+n(j.taskCount)+" "+n(j.taskCount===1?o(t)("task"):o(t)("tasks")),1)]),e("li",Pn,[ae[7]||(ae[7]=e("i",{class:"fa-solid fa-flag text-xs w-4 text-center"},null,-1)),R(" "+n(j.milestoneCount)+" "+n(j.milestoneCount===1?o(t)("milestone"):o(t)("milestones")),1)])])]),e("div",null,[e("label",An,[R(n(o(t)("Please type"))+" ",1),e("strong",En,n(j.projectLabel),1),R(" "+n(o(t)("to confirm:")),1)]),re(e("input",{ref_key:"inputRef",ref:E,"onUpdate:modelValue":ae[0]||(ae[0]=S=>m.value=S),type:"text",placeholder:j.projectLabel,disabled:w.value,class:F(["w-full px-3 py-2 text-sm border rounded-lg transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 disabled:opacity-50 focus:outline-none",[m.value.length===0?"border-gray-300 dark:border-gray-600 focus:border-red-500 dark:focus:border-red-400 focus:ring-1 focus:ring-red-500 dark:focus:ring-red-400":G.value?"border-red-500 dark:border-red-400 ring-1 ring-red-500 dark:ring-red-400":"border-gray-300 dark:border-gray-600 focus:border-red-500 dark:focus:border-red-400 focus:ring-1 focus:ring-red-500 dark:focus:ring-red-400"]]),onKeydown:we(xe,["enter"])},null,42,Un),[[be,m.value]])])]),e("div",zn,[e("button",{onClick:N,disabled:w.value,class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors disabled:opacity-50"},n(o(t)("Cancel")),9,On),e("button",{onClick:xe,disabled:!G.value||w.value,class:F(["px-4 py-2 text-sm font-medium text-white rounded-lg transition-colors flex items-center gap-2 disabled:cursor-not-allowed",[G.value&&!w.value?"bg-red-600 hover:bg-red-700 dark:bg-red-600 dark:hover:bg-red-700":"bg-gray-300 dark:bg-gray-600"]])},[w.value?(d(),u("i",Bn)):(d(),u("i",Wn)),R(" "+n(w.value?o(t)("Deleting..."):o(t)("Delete this project")),1)],10,Rn)])])])):_("",!0)]))}}),Vn={key:0,class:"fixed inset-0 z-[100] flex items-center justify-center p-4"},Hn={class:"relative bg-white dark:bg-gray-900 rounded-xl shadow-2xl w-full max-w-md border border-gray-200 dark:border-gray-700"},Gn={class:"flex items-center gap-3 p-5 pb-4 border-b border-gray-200 dark:border-gray-700"},qn={class:"flex-1 min-w-0"},Kn={class:"text-lg font-semibold text-gray-900 dark:text-gray-100 m-0"},Jn={class:"text-xs text-gray-500 dark:text-gray-400 m-0 mt-0.5"},Qn=["disabled"],Zn={class:"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-3 space-y-1.5"},Xn={class:"text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider m-0"},Yn={class:"list-none p-0 m-0 space-y-1"},eo={class:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300"},to={class:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300"},ao={class:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300"},so={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ro=["disabled","placeholder"],lo={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},no=["disabled","placeholder"],oo={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},io=["disabled"],uo=["value"],co={class:"flex justify-end gap-3 pt-3 border-t border-gray-200 dark:border-gray-700"},go=["disabled"],vo=["disabled"],po={key:0,class:"fa-solid fa-spinner fa-spin"},fo={key:1,class:"fa-solid fa-copy"},yo=xt({__name:"SaveAsTemplateModal",props:{isOpen:{type:Boolean},projectName:{},projectLabel:{},taskCount:{},milestoneCount:{}},emits:["close","saved"],setup(j,{emit:q}){const A=j,ie=q,{createFromProject:z}=Cs(),{success:le,error:B}=Kt(),m=v(""),w=v(""),E=v("General"),G=v(!1),xe=v(null),N=["General","Marketing","Engineering","Operations","Other"];rt(()=>A.isOpen,S=>{S&&(m.value=`${A.projectLabel} Template`,w.value="",E.value="General",G.value=!1,At(()=>{var O;return(O=xe.value)==null?void 0:O.focus()}))});function de(){return se(this,null,function*(){if(!(!m.value.trim()||G.value)){G.value=!0;try{const S=yield z(A.projectName,m.value.trim(),w.value.trim()||void 0,E.value);le(t("Template saved"),t('"{0}" created with {1} tasks and {2} milestones.',[m.value,S.task_count,S.milestone_count])),ie("saved",S.name),ie("close")}catch(S){console.error("Failed to save template:",S),B(t("Save failed"),S.message||t("Could not save the template. Please try again.")),G.value=!1}}})}function ae(){G.value||ie("close")}return(S,O)=>(d(),Pe(ya,{to:"body"},[j.isOpen?(d(),u("div",Vn,[e("div",{class:"absolute inset-0 bg-black/60",onClick:ae}),e("div",Hn,[e("div",Gn,[O[4]||(O[4]=e("div",{class:"w-10 h-10 rounded-full bg-orga-100 dark:bg-orga-900/50 flex items-center justify-center flex-shrink-0"},[e("i",{class:"fa-solid fa-copy text-orga-600 dark:text-orga-400 text-lg"})],-1)),e("div",qn,[e("h2",Kn,n(o(t)("Save as Template")),1),e("p",Jn,n(o(t)("Capture project structure for reuse")),1)]),e("button",{onClick:ae,disabled:G.value,class:"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors disabled:opacity-50"},[...O[3]||(O[3]=[e("i",{class:"fa-solid fa-xmark text-lg"},null,-1)])],8,Qn)]),e("form",{onSubmit:me(de,["prevent"]),class:"p-5 space-y-4"},[e("div",Zn,[e("p",Xn,n(o(t)("Will capture:")),1),e("ul",Yn,[e("li",eo,[O[5]||(O[5]=e("i",{class:"fa-solid fa-list-check text-xs w-4 text-center text-orga-500"},null,-1)),R(" "+n(j.taskCount)+" "+n(j.taskCount===1?o(t)("task"):o(t)("tasks"))+" "+n(o(t)("with checklist items")),1)]),e("li",to,[O[6]||(O[6]=e("i",{class:"fa-solid fa-flag text-xs w-4 text-center text-orga-500"},null,-1)),R(" "+n(j.milestoneCount)+" "+n(j.milestoneCount===1?o(t)("milestone"):o(t)("milestones")),1)]),e("li",ao,[O[7]||(O[7]=e("i",{class:"fa-solid fa-link text-xs w-4 text-center text-orga-500"},null,-1)),R(" "+n(o(t)("All task dependencies & relative dates")),1)])])]),e("div",null,[e("label",so,n(o(t)("Template Name"))+" *",1),re(e("input",{ref_key:"nameInputRef",ref:xe,"onUpdate:modelValue":O[0]||(O[0]=ee=>m.value=ee),type:"text",required:"",disabled:G.value,class:"w-full px-3 py-2 text-sm border rounded-lg transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 border-gray-300 dark:border-gray-600 focus:border-orga-500 dark:focus:border-orga-400 focus:ring-1 focus:ring-orga-500 dark:focus:ring-orga-400 focus:outline-none disabled:opacity-50",placeholder:o(t)("Enter template name")},null,8,ro),[[be,m.value]])]),e("div",null,[e("label",lo,n(o(t)("Description")),1),re(e("textarea",{"onUpdate:modelValue":O[1]||(O[1]=ee=>w.value=ee),rows:"2",disabled:G.value,class:"w-full px-3 py-2 text-sm border rounded-lg transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 border-gray-300 dark:border-gray-600 focus:border-orga-500 dark:focus:border-orga-400 focus:ring-1 focus:ring-orga-500 dark:focus:ring-orga-400 focus:outline-none disabled:opacity-50",placeholder:o(t)("Brief description of this template")},null,8,no),[[be,w.value]])]),e("div",null,[e("label",oo,n(o(t)("Category")),1),re(e("select",{"onUpdate:modelValue":O[2]||(O[2]=ee=>E.value=ee),disabled:G.value,class:"w-full px-3 py-2 text-sm border rounded-lg transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600 focus:border-orga-500 dark:focus:border-orga-400 focus:ring-1 focus:ring-orga-500 dark:focus:ring-orga-400 focus:outline-none disabled:opacity-50"},[(d(),u(Q,null,ne(N,ee=>e("option",{key:ee,value:ee},n(ee),9,uo)),64))],8,io),[[Et,E.value]])]),e("div",co,[e("button",{type:"button",onClick:ae,disabled:G.value,class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors disabled:opacity-50"},n(o(t)("Cancel")),9,go),e("button",{type:"submit",disabled:!m.value.trim()||G.value,class:"px-4 py-2 text-sm font-medium text-white bg-orga-500 rounded-lg hover:bg-orga-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"},[G.value?(d(),u("i",po)):(d(),u("i",fo)),R(" "+n(G.value?o(t)("Saving..."):o(t)("Save Template")),1)],8,vo)])],32)])])):_("",!0)]))}}),mo=["aria-label"],xo=["aria-current"],bo=xt({__name:"Breadcrumb",props:{items:{},showHome:{type:Boolean,default:!0},homePath:{default:"/orga"},separator:{default:"fa-chevron-right"}},setup(j){const q=j,A=es(),ie={orga:t("Dashboard"),activity:t("Activity"),projects:t("Projects"),contacts:t("Contacts"),schedule:t("Schedule"),settings:t("Settings")},z=K(()=>{if(q.items)return q.items;const le=A.path.split("/").filter(Boolean);return le.map((B,m)=>{const w=m===le.length-1,E="/"+le.slice(0,m+1).join("/");let G=ie[B];return G||(G=B.split("-").map(xe=>xe.charAt(0).toUpperCase()+xe.slice(1)).join(" ")),{label:G,to:w?void 0:E,current:w}})});return(le,B)=>{const m=js("router-link");return d(),u("nav",{"aria-label":o(t)("Breadcrumb"),class:"flex items-center gap-2 text-sm flex-wrap"},[j.showHome?(d(),Pe(m,{key:0,to:j.homePath,class:"text-gray-500 dark:text-gray-400 hover:text-orga-600 dark:hover:text-orga-400 transition-colors","aria-label":o(t)("Home")},{default:Ut(()=>[...B[0]||(B[0]=[e("i",{class:"fa-solid fa-home"},null,-1)])]),_:1},8,["to","aria-label"])):_("",!0),(d(!0),u(Q,null,ne(z.value,(w,E)=>(d(),u(Q,{key:E},[e("i",{class:F(["fa-solid",j.separator,"text-xs text-gray-400 dark:text-gray-500"]),"aria-hidden":"true"},null,2),w.to&&!w.current?(d(),Pe(m,{key:0,to:w.to,class:"text-gray-500 dark:text-gray-400 hover:text-orga-600 dark:hover:text-orga-400 transition-colors inline-flex items-center gap-1.5"},{default:Ut(()=>[w.icon?(d(),u("i",{key:0,class:F(["fa-solid",w.icon,"text-xs"]),"aria-hidden":"true"},null,2)):_("",!0),R(" "+n(w.label),1)]),_:2},1032,["to"])):(d(),u("span",{key:1,class:"text-gray-800 dark:text-gray-100 font-medium inline-flex items-center gap-1.5","aria-current":w.current?"page":void 0},[w.icon?(d(),u("i",{key:0,class:F(["fa-solid",w.icon,"text-xs"]),"aria-hidden":"true"},null,2)):_("",!0),R(" "+n(w.label),1)],8,xo))],64))),128))],8,mo)}}}),ko={class:"flex flex-col h-full bg-gray-50 dark:bg-gray-950 text-gray-900 dark:text-gray-100"},ho={key:0,class:"flex-1 flex items-center justify-center"},_o={class:"text-center"},$o={class:"text-gray-600 dark:text-gray-400"},wo={key:1,class:"flex-1 flex items-center justify-center p-6"},Do={class:"bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 rounded-lg p-6 max-w-md text-center"},Co={class:"text-red-800 dark:text-red-200 font-medium mb-2"},jo={class:"text-red-600 dark:text-red-400 text-sm mb-4"},To={class:"flex-shrink-0 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700"},Mo={class:"hidden sm:block px-4 pt-3 pb-2 border-b border-gray-100 dark:border-gray-800"},So={class:"p-3 sm:p-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3"},Lo={class:"flex items-center gap-3 sm:gap-4"},Fo=["title"],Io={class:"min-w-0 flex-1"},Po=["disabled"],Ao=["title"],Eo={class:"text-caption sm:text-body text-gray-600 dark:text-gray-400 m-0 truncate"},Uo={class:"flex items-center gap-2 flex-wrap"},zo={class:"flex gap-1 bg-gray-100 dark:bg-gray-800 p-1 rounded-lg"},Oo=["title"],Ro={class:"hidden sm:inline"},Bo=["title"],Wo={class:"hidden sm:inline"},No=["title"],Vo={class:"hidden sm:inline"},Ho={class:"flex gap-2 ml-2 sm:ml-4"},Go=["title"],qo={class:"hidden sm:inline"},Ko=["title"],Jo={class:"hidden md:inline"},Qo=["title"],Zo={class:"hidden lg:inline"},Xo={key:0,class:"absolute right-0 top-full mt-1 w-64 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg dark:shadow-gray-950/50 z-50 py-1"},Yo=["onClick"],ei={class:"font-medium"},ti={class:"text-xs text-gray-500 dark:text-gray-400"},ai={key:0,class:"fa-solid fa-check ml-auto mt-0.5 text-orga-500"},si={class:"flex gap-1 ml-2 sm:ml-4"},ri=["title"],li={class:"hidden lg:inline"},ni=["title"],oi={class:"hidden lg:inline"},ii={class:"relative ml-2 sm:ml-4"},di=["title"],ui={key:0,class:"absolute right-0 top-full mt-1 w-56 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50 py-1"},ci=["disabled"],gi={key:0,class:"fa-solid fa-check ml-auto text-xs text-blue-500"},vi={class:"flex flex-1 overflow-hidden"},pi={class:"flex-1 overflow-auto p-4"},fi={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4"},yi=["onDragover","onDragleave","onDrop"],mi={class:"flex items-center justify-between mb-4 pb-3 border-b border-gray-200 dark:border-gray-700"},xi={class:"font-semibold text-gray-900 dark:text-gray-100 m-0 text-sm"},bi={class:"bg-gray-100 dark:bg-gray-700 px-2.5 py-1 rounded-full text-xs font-semibold text-gray-700 dark:text-gray-200"},ki={class:"space-y-2"},hi=["onDragstart","onClick","onKeydown","title"],_i={class:"flex items-start justify-between mb-2"},$i={class:"font-medium text-gray-900 dark:text-gray-100 text-sm leading-tight m-0 pr-2"},wi={class:"flex items-center gap-1 shrink-0"},Di={key:0,class:"text-xs text-gray-600 dark:text-gray-300 mb-2"},Ci={class:"flex items-center justify-between"},ji={key:0,class:"flex items-center gap-1"},Ti={class:"text-[10px] text-gray-600 dark:text-gray-400"},Mi={key:1,class:"text-[10px] text-gray-600 dark:text-gray-400"},Si={key:2,class:"text-[10px] text-gray-600 dark:text-gray-400"},Li={key:1,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 max-h-[calc(100vh-280px)] overflow-auto"},Fi={class:"w-full min-w-[600px]"},Ii={class:"bg-gray-50 dark:bg-gray-900 list-header"},Pi={class:"text-left p-3 text-overline text-gray-600 dark:text-gray-400"},Ai={class:"text-left p-3 text-overline text-gray-600 dark:text-gray-400"},Ei={class:"text-left p-3 text-overline text-gray-600 dark:text-gray-400 hidden sm:table-cell"},Ui={class:"text-left p-3 text-overline text-gray-600 dark:text-gray-400 hidden md:table-cell"},zi={class:"text-left p-3 text-overline text-gray-600 dark:text-gray-400"},Oi=["onClick","title","onKeydown"],Ri={class:"p-3"},Bi={class:"text-subtitle text-gray-800 dark:text-gray-100"},Wi={class:"text-caption text-gray-600 dark:text-gray-400"},Ni={class:"p-3"},Vi={class:"flex items-center gap-1.5"},Hi={class:"p-3 hidden sm:table-cell"},Gi={class:"p-3 hidden md:table-cell"},qi={key:0,class:"flex items-center gap-2"},Ki={class:"text-sm text-gray-700 dark:text-gray-300"},Ji={key:1,class:"text-gray-600 dark:text-gray-400 text-sm"},Qi={class:"p-3 text-sm text-gray-700 dark:text-gray-300"},Zi={key:2,class:"h-full"},Xi={key:1,class:"fixed inset-y-0 right-0 w-full max-w-sm z-50 lg:relative lg:z-auto lg:w-80 lg:max-w-none bg-white dark:bg-gray-900 border-l border-gray-200 dark:border-gray-700 flex flex-col flex-shrink-0 overflow-hidden transition-all"},Yi={key:1,class:"flex-1 flex flex-col overflow-hidden"},ed={class:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between"},td={class:"font-semibold text-gray-800 dark:text-gray-100 m-0 flex items-center gap-2"},ad={class:"flex-1 overflow-y-auto p-4 space-y-4"},sd={key:0,class:"flex items-center gap-2"},rd=["disabled"],ld={key:0,class:"fa-solid fa-spinner fa-spin"},nd={key:1,class:"fa-solid fa-check"},od=["disabled"],id=["title"],dd={class:"flex items-center gap-3"},ud={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider w-20"},cd=["value"],gd={value:"Upcoming"},vd={value:"In Progress"},pd={value:"Completed"},fd={value:"Missed"},yd={class:"flex items-center gap-3"},md={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider w-20"},xd=["value"],bd={class:"flex items-center gap-3"},kd={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider w-20"},hd={class:"flex-1"},_d={class:"flex items-center gap-2"},$d={class:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},wd={class:"text-sm text-gray-600 dark:text-gray-400 w-10 text-right"},Dd={class:"text-xs text-gray-400 dark:text-gray-500 mt-1 ml-[calc(5rem+0.75rem)]"},Cd={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider block mb-2"},jd={key:0},Td=["placeholder"],Md={class:"flex justify-end gap-2 mt-2"},Sd=["disabled"],Ld=["disabled"],Fd={key:0,class:"fa-solid fa-spinner fa-spin"},Id=["title"],Pd={key:0,class:"text-sm text-gray-700 dark:text-gray-300 bg-gray-50 dark:bg-gray-800 rounded-lg p-3 group-hover:ring-1 group-hover:ring-orga-300 dark:group-hover:ring-orga-600 transition-all"},Ad={key:1,class:"text-sm text-gray-400 dark:text-gray-500 italic bg-gray-50 dark:bg-gray-800 rounded-lg p-3 group-hover:ring-1 group-hover:ring-orga-300 dark:group-hover:ring-orga-600 transition-all"},Ed={class:"flex items-center justify-between mb-2"},Ud={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"},zd={key:0,class:"mb-2"},Od=["placeholder"],Rd={class:"mt-1 max-h-40 overflow-y-auto rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"},Bd=["onClick"],Wd={class:"text-sm text-gray-700 dark:text-gray-300 truncate flex-1"},Nd={key:0,class:"text-xs text-gray-400 dark:text-gray-500 text-center py-3"},Vd={class:"space-y-1"},Hd=["onClick"],Gd=["onClick","title"],qd={key:0,class:"text-sm text-gray-400 dark:text-gray-500 text-center py-3"},Kd={key:0,class:"flex items-center gap-3"},Jd={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider w-20"},Qd={class:"text-sm text-green-600 dark:text-green-400"},Zd={key:2,class:"flex-1 flex flex-col"},Xd={class:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between"},Yd={class:"font-semibold text-gray-800 dark:text-gray-100 m-0 flex items-center gap-2"},eu={class:"flex-1 flex items-center justify-center"},tu={key:0,class:"flex-shrink-0 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700"},au={class:"flex items-center gap-4 px-4 py-2.5 border-b border-gray-100 dark:border-gray-700/50"},su={class:"flex items-center gap-2.5"},ru={class:"flex items-center gap-2"},lu={class:"text-xs text-gray-500 dark:text-gray-400"},nu={class:"text-sm font-semibold text-gray-800 dark:text-gray-100"},ou={class:"w-20 h-1.5 bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden hidden sm:block"},iu={class:"flex items-center gap-2.5"},du={class:"flex items-center gap-2"},uu={class:"text-xs text-gray-500 dark:text-gray-400"},cu={class:"text-sm font-semibold text-gray-800 dark:text-gray-100"},gu={class:"flex items-center gap-2.5"},vu={class:"flex items-center gap-2"},pu={class:"text-xs text-gray-500 dark:text-gray-400"},fu={class:"text-sm font-semibold text-gray-800 dark:text-gray-100"},yu={class:"flex items-center gap-2.5"},mu={class:"flex items-center gap-2"},xu={class:"text-xs text-gray-500 dark:text-gray-400"},bu={class:"text-sm font-semibold text-gray-800 dark:text-gray-100"},ku={class:"w-20 h-1.5 bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden hidden sm:block"},hu={class:"flex items-center gap-2.5"},_u={class:"flex items-center gap-2"},$u={class:"text-xs text-gray-500 dark:text-gray-400"},wu={class:"flex items-center gap-2.5"},Du={class:"flex items-center gap-2"},Cu={class:"text-xs text-gray-500 dark:text-gray-400"},ju={class:"text-sm font-semibold text-gray-800 dark:text-gray-100"},Tu={key:0,class:"w-20 h-1.5 bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden hidden sm:block"},Mu={key:1,class:"text-xs text-gray-400 dark:text-gray-500 hidden sm:inline"},Su={class:"flex divide-x divide-gray-200 dark:divide-gray-700"},Lu={class:"flex-1 p-4"},Fu={class:"text-overline text-gray-600 dark:text-gray-400 mb-3 flex items-center gap-2"},Iu={class:"grid grid-cols-2 gap-3 text-sm"},Pu={class:"text-gray-600 dark:text-gray-400"},Au=["title","disabled"],Eu={key:0,class:"absolute left-0 top-full mt-1 w-44 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg dark:shadow-gray-950/50 z-50 py-1"},Uu=["onClick"],zu={class:"text-gray-700 dark:text-gray-200"},Ou={key:0,class:"fa-solid fa-check text-orga-500 text-xs ml-auto"},Ru={class:"text-gray-600 dark:text-gray-400"},Bu=["title","disabled"],Wu={key:0,class:"absolute left-0 top-full mt-1 w-44 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg dark:shadow-gray-950/50 z-50 py-1"},Nu=["onClick"],Vu={class:"text-gray-700 dark:text-gray-200"},Hu={key:0,class:"fa-solid fa-check text-orga-500 text-xs ml-auto"},Gu={class:"text-gray-600 dark:text-gray-400"},qu=["disabled"],Ku=["title"],Ju={class:"text-gray-600 dark:text-gray-400"},Qu=["disabled"],Zu=["title"],Xu={key:0,class:"col-span-2 flex items-center gap-2"},Yu={class:"text-gray-600 dark:text-gray-400"},e0={class:"ml-2 text-gray-800 dark:text-gray-100"},t0={key:0,class:"text-gray-400 dark:text-gray-500"},a0={key:1,class:"text-red-500 dark:text-red-400"},s0={class:"text-gray-600 dark:text-gray-400"},r0={key:0,class:"inline-flex items-center ml-2 gap-1"},l0={class:"text-gray-400 text-sm"},n0=["disabled"],o0=["title"],i0={key:1},d0={class:"text-gray-600 dark:text-gray-400"},u0={key:0,class:"text-gray-400 dark:text-gray-500"},c0={key:2},g0={class:"text-gray-600 dark:text-gray-400"},v0={class:"text-gray-400 dark:text-gray-500"},p0={key:3},f0={class:"text-gray-600 dark:text-gray-400"},y0={class:"text-gray-400 dark:text-gray-500"},m0={class:"mt-3 pt-3 border-t border-gray-100 dark:border-gray-700"},x0={key:0},b0=["placeholder"],k0={class:"flex justify-end gap-2 mt-2"},h0=["disabled"],_0=["disabled"],$0={key:0,class:"fa-solid fa-spinner fa-spin"},w0=["title"],D0=["innerHTML"],C0={key:1,class:"text-sm text-gray-400 dark:text-gray-500 m-0 italic group-hover:text-orga-500 dark:group-hover:text-orga-400 transition-colors"},j0={class:"w-48 p-4"},T0={class:"text-overline text-gray-600 dark:text-gray-400 mb-3 flex items-center gap-2"},M0={key:0,class:"flex flex-wrap gap-1"},S0=["title"],L0=["src","alt"],F0={key:2,class:"absolute -top-1 -right-1 w-3 h-3 bg-orga-500 rounded-full flex items-center justify-center"},I0={key:1,class:"text-xs text-gray-500 dark:text-gray-400"},P0={class:"flex-1 min-w-0 p-4"},A0={class:"text-overline text-gray-600 dark:text-gray-400 mb-3 flex items-center gap-2"},E0={key:0,class:"space-y-1.5 max-h-20 overflow-auto"},U0={class:"text-xs text-gray-600 dark:text-gray-400 ml-auto whitespace-nowrap"},z0={class:"w-64 p-4 relative"},O0={class:"text-overline text-gray-600 dark:text-gray-400 mb-3 flex items-center gap-2"},R0={class:"font-medium"},B0={key:0,class:"text-xs text-gray-500 dark:text-gray-400 ml-1"},W0={key:1,class:"text-xs text-gray-500 dark:text-gray-400"},N0={class:"mt-2 flex items-center gap-1.5 text-xs text-gray-400 dark:text-gray-500 hover:text-orga-500 cursor-pointer transition-colors"},V0=["disabled"],H0={key:2,class:"mt-1 h-1 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},G0={key:3,class:"absolute bottom-full left-0 mb-2 w-80 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-20 max-h-80 overflow-auto"},q0={key:0,class:"p-3 border-b border-gray-100 dark:border-gray-800"},K0={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-2"},J0={class:"space-y-1"},Q0=["href"],Z0={class:"truncate flex-1 group-hover:underline"},X0={class:"text-xs text-gray-400 dark:text-gray-500 whitespace-nowrap"},Y0={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-2"},ec={class:"space-y-1"},tc=["href"],ac={class:"truncate flex-1 group-hover:underline"},sc={class:"text-xs text-gray-400 dark:text-gray-500 whitespace-nowrap"},rc=xt({__name:"ProjectDetail",setup(j){const q=es(),A=Ss(),{getProject:ie,updateProject:z,getCriticalPath:le}=Ya(),{getTasksByStatus:B,updateStatus:m,updateTask:w,applyCascade:E,addDependency:G}=Za(),{call:xe}=Ls(),{updateMilestone:N}=Xa(),{reorderItem:de}=Fs(),{getContacts:ae}=Is(),{success:S,error:O}=Kt(),{formatCurrency:ee,currencySymbol:ce}=Ts(),Z=v("gantt"),ue=v(!0),Y=v(!0),V=v(null),p=v(null),J=v(!0),De=v(null),_e=v(null),Ce=v(null),bt=v(null),lt=v(null),Ze=v(!1),Oe=v(!1),je=v(!1),Le=v(!1),Re=v(!1),ke=v("Open"),y=v(null),X=v([]),He=v([]),zt=v([]),Jt=v([]),nt=v([]),kt=v([]),Te=v({}),ot=v([]),Ot=v([]),Ge=v(!1),Xe=v(!1),ht=v(0),Qt=K(()=>[{id:"Open",title:t("Open"),color:"column-open"},{id:"In Progress",title:t("In Progress"),color:"column-in-progress"},{id:"Review",title:t("Review"),color:"column-review"},{id:"Completed",title:t("Completed"),color:"column-completed"}]),Me=K(()=>q.params.id),it=K(()=>{var a;let l=0;for(const f in Te.value)l+=((a=Te.value[f])==null?void 0:a.length)||0;return l}),_t=K(()=>{var l;return((l=Te.value.Completed)==null?void 0:l.length)||0}),dt=K(()=>{if(X.value.length===0)return 0;const l=X.value.reduce((a,f)=>f.status==="Completed"?a+100:a+(f.progress||0),0);return Math.round(l/X.value.length)}),ut=K(()=>{var f,D;const l=(f=y.value)==null?void 0:f.budget,a=(D=y.value)==null?void 0:D.spent;return!l||l<=0?0:Math.min(100,Math.round((a||0)/l*100))}),Be=K(()=>{var f,D;const l=(f=y.value)==null?void 0:f.budget,a=(D=y.value)==null?void 0:D.estimated_cost;return!l||l<=0?0:Math.min(100,Math.round((a||0)/l*100))}),qe=K(()=>{var f,D;const l=(f=y.value)==null?void 0:f.estimated_cost,a=(D=y.value)==null?void 0:D.spent;return!l&&!a?null:(l||0)-(a||0)}),ma=K(()=>{var a;const l=(a=y.value)==null?void 0:a.estimated_cost;return!l||l<=0?0:Math.round((qe.value||0)/l*100)}),Zt=K(()=>{const l=new Set;for(const a of X.value)a.task_group&&l.add(a.task_group);return[...l].sort()}),ye=K(()=>{var Gt;if(!((Gt=y.value)!=null&&Gt.start_date))return null;const l=new Date(y.value.start_date),a=new Date;a.setHours(0,0,0,0),l.setHours(0,0,0,0);const f=y.value.end_date?new Date(y.value.end_date):null;f&&f.setHours(0,0,0,0);const D=1e3*60*60*24,I=f?Math.ceil((f.getTime()-l.getTime())/D)+1:0,fe=Math.max(0,Math.ceil((a.getTime()-l.getTime())/D)+1),Ve=f?Math.max(0,Math.ceil((f.getTime()-a.getTime())/D)):0;let $e;if(I<=0&&!f)$e=t("{0}d elapsed",[fe]);else if(I<30)$e=t("{0}d",[I]);else if(I<365){const g=Math.round(I/30.44);$e=g===1?t("1 month"):t("{0} months",[g])}else{const g=(I/365.25).toFixed(1);$e=t("{0}y",[g])}return{total:I,elapsed:fe,remaining:Ve,label:$e}}),$t=K(()=>!ye.value||ye.value.total<=0?0:Math.min(100,Math.round(ye.value.elapsed/ye.value.total*100)));function ct(l){return Te.value[l]||[]}function Fe(l){return l?new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):t("N/A")}function Rt(l){if(!l)return"?";const a=l.split(" ");return a.length>=2?(a[0][0]+a[a.length-1][0]).toUpperCase():l.substring(0,2).toUpperCase()}function Xt(l){return ot.value.filter(a=>a.task===l&&a.dependency_type==="Finish to Start"&&a.depends_on_status!=="Completed").map(a=>({name:a.depends_on,subject:a.depends_on_subject}))}function wt(l){const a=Xt(l);return a.length===0?t("Blocked"):t("Blocked by: {0}",[a.map(f=>f.subject).join(", ")])}function Dt(l){if(!l)return"0 B";const a=["B","KB","MB","GB"];let f=0,D=l;for(;D>=1024&&f<a.length-1;)D/=1024,f++;return`${D.toFixed(D<10?1:0)} ${a[f]}`}function Ae(l){V.value=l,Y.value=!0}function Ct(l){var D;const a=l||((D=V.value)==null?void 0:D.name);if(!a)return;const f=X.value.find(I=>I.name===a);f&&(V.value=f)}function Ie(){if(!p.value)return;const l=Tt.value.find(a=>{var f;return a.name===((f=p.value)==null?void 0:f.name)});l&&(p.value=l)}function Yt(l){if(l.type==="milestone"){p.value=l,V.value=null,Ht.value=!1,mt.value=!1,at.value="",Y.value||(Y.value=!0);return}p.value=null,V.value=l,Y.value||(Y.value=!0)}function ea(l){return se(this,null,function*(){try{yield G(l.toTask,l.fromTask,l.type),S(t("Dependency created"),t("Added Finish-to-Start dependency")),yield pe()}catch(a){O(t("Failed to create dependency"),a.message||t("Unknown error"))}})}function jt(l){return se(this,null,function*(){var a;try{const f=yield w(l.taskId,{start_date:l.startDate,due_date:l.endDate}),D=f==null?void 0:f._cascade;if((D==null?void 0:D.mode)==="Flexible"&&((a=D.cascade_preview)!=null&&a.length)){const fe=D.cascade_preview.map($e=>`${$e.task_name}: ${$e.days_shift>0?"+":""}${$e.days_shift} ${t("days")}`).join(`
`);window.confirm(t("This change affects {0} dependent task(s):",[D.total_affected])+`

${fe}

`+t("Apply cascade?"))&&(yield E(l.taskId,l.startDate,l.endDate))}(D==null?void 0:D.mode)==="Strict"&&D.total_updated&&D.total_updated>0?S(t("Dates cascaded"),t("Updated {0} dependent task(s)",[D.total_updated])):S(t("Task moved"),t("Dates updated to {0} - {1}",[l.startDate,l.endDate])),yield pe(),Ct(l.taskId)}catch(f){console.error("Failed to update task dates:",f),O(t("Move failed"),t("Could not update task dates"))}})}function ta(l){return se(this,null,function*(){try{yield N(l.milestoneId,{due_date:l.dueDate}),yield pe(),S(t("Milestone moved"),t("Due date updated to {0}",[l.dueDate]))}catch(a){console.error("Failed to update milestone date:",a),O(t("Move failed"),t("Could not update milestone date"))}})}function aa(l){return se(this,null,function*(){if(p.value)try{yield N(p.value.name,{[l.field]:l.value}),yield pe(),Ie(),S(t("Milestone updated"),t("Field has been updated"))}catch(a){console.error("Failed to update milestone:",a),O(t("Update failed"),t("Could not save changes to the milestone"))}})}function Bt(l){return se(this,null,function*(){const{itemId:a,itemType:f,prevItemId:D,nextItemId:I,prevItemType:fe,nextItemType:Ve}=l;lt.value=a,setTimeout(()=>{lt.value=null},1500);try{if((yield de({item_id:a,item_type:f,project:Me.value,prev_item_id:D,next_item_id:I,prev_item_type:fe,next_item_type:Ve})).success===!1)return;yield pe()}catch($e){}})}function sa(l){return se(this,null,function*(){try{if(yield w(l.task_id,{[l.field]:l.value}),yield pe(),Ct(l.task_id),Ie(),l.field==="start_date"||l.field==="due_date"){const a=l.field==="start_date"?t("Start date"):t("Due date");l.value?S(t("Date updated"),t("{0} set to {1}",[a,new Date(l.value).toLocaleDateString()])):S(t("Date cleared"),t("{0} has been cleared",[a]))}else l.field==="progress"?S(t("Progress updated"),t("Progress set to {0}%",[l.value])):l.field==="description"?S(t("Description updated"),t("Task description has been saved.")):l.field==="task_group"?l.value?S(t("Group updated"),t('Task moved to group "{0}"',[l.value])):S(t("Group removed"),t("Task removed from group")):l.field==="depends_on_group"&&(l.value?S(t("Group dependency set"),t('Task blocked until all "{0}" tasks complete',[l.value])):S(t("Group dependency removed"),t("Task is no longer blocked by a group")))}catch(a){console.error("Failed to update task:",a);const f=(a==null?void 0:a.message)||(a==null?void 0:a.exc)||t("Could not save changes to the task");O(t("Update failed"),String(f))}})}function ra(l){console.log("Cascade preview:",l.changes)}function xa(l){return se(this,null,function*(){try{const a=l.changes.map(f=>({task_name:f.task_id,[f.field==="start_date"?"start_date":"due_date"]:f.new_value}));yield xe("orga.orga.api.task.batch_update_task_dates",{updates:JSON.stringify(a)}),yield pe()}catch(a){console.error("Failed to apply cascade:",a)}})}function ba(l){const a=X.value.find(f=>f.name===l.task_id);a&&(V.value=a)}const Ye=K(()=>{const l=ot.value;return X.value.map(a=>{const f=l.filter(I=>I.task===a.name).map(I=>({task_id:I.depends_on,task_name:I.depends_on_subject,type:Ra(I.dependency_type),lag:I.lag_days||0,status:I.depends_on_status})),D=l.filter(I=>I.depends_on===a.name).map(I=>({task_id:I.task,task_name:I.task_subject,type:Ra(I.dependency_type),lag:I.lag_days||0,status:I.task_status}));return qa(Ga({},a),{type:"task",duration:a.start_date&&a.due_date?Math.ceil((new Date(a.due_date).getTime()-new Date(a.start_date).getTime())/(1e3*60*60*24))+1:void 0,dependencies_info:f,dependents_info:D,is_blocked:f.some(I=>I.status!=="Completed")})})}),Tt=K(()=>He.value.filter(l=>l.due_date).map(l=>{var a,f;return{name:l.name,subject:l.milestone_name,type:"milestone",status:l.status,start_date:l.due_date,due_date:l.due_date,progress:(a=l.completion_percentage)!=null?a:l.status==="Completed"?100:0,project:l.project,description:l.description,completed_date:l.completed_date,sort_order:l.sort_order||0,task_count:(f=l.task_count)!=null?f:0}})),Ke=K(()=>[...Ye.value,...Tt.value]);function ka(l,a){return se(this,null,function*(){try{yield m(l.name,a),yield pe(),Ie(),S(t("Task updated"),t('"{0}" moved to {1}',[l.subject,a]))}catch(f){console.error("Failed to update task status:",f),O(t("Failed to update task"),t("Could not change task status"))}})}function ha(l,a){return se(this,null,function*(){try{yield w(l.name,{priority:a}),yield pe(),S(t("Priority updated"),t('"{0}" set to {1}',[l.subject,a]))}catch(f){console.error("Failed to update task priority:",f),O(t("Failed to update priority"),t("Could not change task priority"))}})}function Mt(l,a){_e.value=a,l.dataTransfer&&(l.dataTransfer.effectAllowed="move",l.dataTransfer.setData("text/plain",a.name)),l.target.classList.add("dragging")}function _a(l){_e.value=null,Ce.value=null,l.target.classList.remove("dragging")}function et(l,a){l.preventDefault(),l.dataTransfer&&(l.dataTransfer.dropEffect="move"),Ce.value=a}function gt(l,a){l.currentTarget.contains(l.relatedTarget)||Ce.value===a&&(Ce.value=null)}function vt(l,a){return se(this,null,function*(){if(l.preventDefault(),Ce.value=null,!_e.value)return;if(_e.value.status===a){_e.value=null;return}const f=_e.value.name,D=_e.value.subject;try{yield m(f,a),yield pe(),Ie(),bt.value=f,setTimeout(()=>{bt.value=null},300),S(t("Task moved"),t('"{0}" moved to {1}',[D,a]))}catch(I){console.error("Failed to update task status:",I),O(t("Failed to move task"),t("Could not change task status"))}_e.value=null})}function We(l){pe(),S(t("Task created"),t('"{0}" has been added',[l.subject]))}function la(l){pe(),S(t("Milestone created"),t('"{0}" has been added',[l.milestone_name]))}function pt(){je.value=!1,A.push("/orga/projects")}const ft=v(!1),Ee=v(""),Ne=v(!1);function na(){var l;Ee.value=((l=y.value)==null?void 0:l.description)||"",ft.value=!0}function Wt(){ft.value=!1}function Nt(){return se(this,null,function*(){if(!(!y.value||Ne.value)){Ne.value=!0;try{yield z(y.value.name,{description:Ee.value}),y.value.description=Ee.value,ft.value=!1,S(t("Description updated"),t("Project description has been saved."))}catch(l){console.error("Failed to update description:",l),O(t("Update failed"),l.message||t("Could not save description."))}finally{Ne.value=!1}}})}const i=v(!1),r=v(""),s=v(!1),c=v(null);function T(){var l;r.value=((l=y.value)==null?void 0:l.project_name)||"",i.value=!0,At(()=>{var a;return(a=c.value)==null?void 0:a.focus()})}function k(){i.value=!1}function h(){return se(this,null,function*(){if(!y.value||s.value)return;const l=r.value.trim();if(!l||l===y.value.project_name)return k();s.value=!0;try{yield z(y.value.name,{project_name:l}),y.value.project_name=l,i.value=!1,S(t("Title updated"),t("Project title has been saved."))}catch(a){console.error("Failed to update title:",a),O(t("Update failed"),a.message||t("Could not save title."))}finally{s.value=!1}})}const x=v(!1),H=v(null),b=v(!1),L=v(null);function $(){var l,a;H.value=(a=(l=y.value)==null?void 0:l.budget)!=null?a:null,x.value=!0,At(()=>{var f;return(f=L.value)==null?void 0:f.focus()})}function W(){x.value=!1}function M(){return se(this,null,function*(){if(!y.value||b.value)return;const l=H.value&&H.value>0?H.value:0;if(l===(y.value.budget||0))return W();b.value=!0;try{yield z(y.value.name,{budget:l}),y.value.budget=l,x.value=!1,S(t("Budget updated"),t("Project budget has been saved."))}catch(a){console.error("Failed to update budget:",a),O(t("Update failed"),a.message||t("Could not save budget."))}finally{b.value=!1}})}const U=v(!1),C=v(""),ge=v(!1),te=v(null),Ue=v(!1),he=v(""),tt=v(!1),oa=v(null);function ts(){var l;C.value=((l=y.value)==null?void 0:l.start_date)||"",U.value=!0,At(()=>{var a;return(a=te.value)==null?void 0:a.focus()})}function Sa(){U.value=!1}function La(){return se(this,null,function*(){if(!(!y.value||ge.value)){if(C.value===(y.value.start_date||""))return Sa();ge.value=!0;try{yield z(y.value.name,{start_date:C.value||null}),y.value.start_date=C.value||void 0,U.value=!1,S(t("Start date updated"),t("Project start date has been saved."))}catch(l){console.error("Failed to update start date:",l),O(t("Update failed"),l.message||t("Could not save start date."))}finally{ge.value=!1}}})}function as(){var l;he.value=((l=y.value)==null?void 0:l.end_date)||"",Ue.value=!0,At(()=>{var a;return(a=oa.value)==null?void 0:a.focus()})}function Fa(){Ue.value=!1}function Ia(){return se(this,null,function*(){if(!(!y.value||tt.value)){if(he.value===(y.value.end_date||""))return Fa();tt.value=!0;try{yield z(y.value.name,{end_date:he.value||null}),y.value.end_date=he.value||void 0,Ue.value=!1,S(t("End date updated"),t("Project end date has been saved."))}catch(l){console.error("Failed to update end date:",l),O(t("Update failed"),l.message||t("Could not save end date."))}finally{tt.value=!1}}})}const St=v(!1),ia=v(!1),$a=v(null),ss=[{value:"Planning",icon:"fa-compass-drafting",color:"text-slate-600 dark:text-slate-400"},{value:"Active",icon:"fa-play",color:"text-green-600 dark:text-green-400"},{value:"On Hold",icon:"fa-pause",color:"text-yellow-600 dark:text-yellow-400"},{value:"Completed",icon:"fa-circle-check",color:"text-green-600 dark:text-green-400"},{value:"Cancelled",icon:"fa-ban",color:"text-gray-500 dark:text-gray-400"}];function rs(){St.value=!St.value}function ls(l){return se(this,null,function*(){if(!y.value||ia.value||l===y.value.status){St.value=!1;return}ia.value=!0;try{yield z(y.value.name,{status:l}),y.value.status=l,St.value=!1,S(t("Status updated"),t("Project status changed to {0}.",[l]))}catch(a){console.error("Failed to update status:",a),O(t("Update failed"),a.message||t("Could not update project status."))}finally{ia.value=!1}})}function Pa(l){$a.value&&!$a.value.contains(l.target)&&(St.value=!1),wa.value&&!wa.value.contains(l.target)&&(Lt.value=!1),ja.value&&!ja.value.contains(l.target)&&(Ft.value=!1)}const Lt=v(!1),da=v(!1),wa=v(null),Da=[{value:"Internal",icon:"fa-building",color:"text-blue-600 dark:text-blue-400"},{value:"External",icon:"fa-arrow-up-right-from-square",color:"text-green-600 dark:text-green-400"},{value:"Maintenance",icon:"fa-wrench",color:"text-yellow-600 dark:text-yellow-400"},{value:"Research",icon:"fa-flask",color:"text-purple-600 dark:text-purple-400"}];function ns(){Lt.value=!Lt.value}function os(l){return se(this,null,function*(){if(!y.value||da.value||l===y.value.project_type){Lt.value=!1;return}da.value=!0;try{yield z(y.value.name,{project_type:l}),y.value.project_type=l,Lt.value=!1,S(t("Type updated"),t("Project type changed to {0}.",[l]))}catch(a){console.error("Failed to update type:",a),O(t("Update failed"),a.message||t("Could not update project type."))}finally{da.value=!1}})}const Ft=v(!1),Ca=v(!1),ja=v(null),Aa=K(()=>[{value:"Strict",icon:"fa-link",description:t("Auto-shift dependents when dates change")},{value:"Flexible",icon:"fa-arrows-left-right",description:t("Preview cascade before applying")},{value:"Off",icon:"fa-link-slash",description:t("Dependencies are informational only")}]),It=K(()=>{var l;return((l=y.value)==null?void 0:l.dependency_mode)||"Flexible"}),is=K(()=>{const l=Aa.value.find(a=>a.value===It.value);return(l==null?void 0:l.icon)||"fa-arrows-left-right"});function ds(l){return se(this,null,function*(){if(!y.value||Ca.value||l===It.value){Ft.value=!1;return}Ca.value=!0;try{yield z(y.value.name,{dependency_mode:l}),y.value.dependency_mode=l,Ft.value=!1,S(t("Dependency mode updated"),t("Scheduling set to {0}.",[l]))}catch(a){console.error("Failed to update dependency mode:",a),O(t("Update failed"),a.message||t("Could not update dependency mode."))}finally{Ca.value=!1}})}const ua=v(!1),ca=K(()=>{var l;return!!((l=y.value)!=null&&l.auto_trail_start_default)});function us(){return se(this,null,function*(){if(!y.value||ua.value)return;ua.value=!0;const l=ca.value?0:1;try{yield z(y.value.name,{auto_trail_start_default:l}),y.value.auto_trail_start_default=l,S(t("Auto-Trail updated"),l?t("New tasks will auto-trail by default."):t("Auto-trail default disabled."))}catch(a){console.error("Failed to update auto-trail default:",a),O(t("Update failed"),a.message||t("Could not update setting."))}finally{ua.value=!1}})}const ga=v(!1),Vt=v(""),Pt=v(!1);function cs(){var l;Vt.value=((l=p.value)==null?void 0:l.subject)||"",ga.value=!0}function Ea(){ga.value=!1}function Ua(){return se(this,null,function*(){if(!p.value||Pt.value)return;const l=Vt.value.trim();if(l){Pt.value=!0;try{yield N(p.value.name,{milestone_name:l}),yield pe(),Ie(),ga.value=!1,S(t("Milestone updated"),t("Milestone name has been saved."))}catch(a){console.error("Failed to update milestone name:",a),O(t("Update failed"),a.message||t("Could not save milestone name."))}finally{Pt.value=!1}}})}const Ht=v(!1),va=v(""),yt=v(!1);function gs(){var l;va.value=((l=p.value)==null?void 0:l.description)||"",Ht.value=!0}function za(){Ht.value=!1}function vs(){return se(this,null,function*(){if(!(!p.value||yt.value)){yt.value=!0;try{yield N(p.value.name,{description:va.value}),yield pe(),Ie(),Ht.value=!1,S(t("Description updated"),t("Milestone description has been saved."))}catch(l){console.error("Failed to update milestone description:",l),O(t("Update failed"),l.message||t("Could not save description."))}finally{yt.value=!1}}})}const mt=v(!1),at=v(""),Oa=K(()=>{if(!p.value)return[];const l=at.value.toLowerCase();return X.value.filter(a=>{var f;return a.milestone!==((f=p.value)==null?void 0:f.name)&&a.status!=="Cancelled"&&(!l||a.subject.toLowerCase().includes(l))})});function ps(l){return se(this,null,function*(){if(p.value)try{yield w(l.name,{milestone:p.value.name}),yield pe(),Ie(),mt.value=!1,at.value="",S(t("Task linked"),t('"{0}" linked to milestone',[l.subject]))}catch(a){console.error("Failed to link task:",a),O(t("Link failed"),t("Could not link task to milestone"))}})}function fs(l){return se(this,null,function*(){if(p.value)try{yield w(l.name,{milestone:""}),yield pe(),Ie(),S(t("Task unlinked"),t('"{0}" removed from milestone',[l.subject]))}catch(a){console.error("Failed to unlink task:",a),O(t("Unlink failed"),t("Could not remove task from milestone"))}})}function Ra(l){return{"Finish to Start":"FS","Start to Start":"SS","Finish to Finish":"FF","Start to Finish":"SF"}[l]||"FS"}const st=K(()=>{const l=nt.value,a={};for(const f of kt.value){const D=f.attached_to_name;if(D){if(!a[D]){const I=X.value.find(fe=>fe.name===D);a[D]={taskSubject:(I==null?void 0:I.subject)||D,files:[]}}a[D].files.push(f)}}return{project:l,byTask:a,totalCount:l.length+kt.value.length}}),Ba=K(()=>{const l=st.value.project.length,a=kt.value.length,f=[];l>0&&f.push(t("{0} project",[l])),a>0&&f.push(t("{0} task",[a]));const D=l+a;return f.length===0?"":f.join(", ")+" "+(D===1?t("file"):t("files"))});function Wa(l){const a=l.file_name||"",f=l.file_type||"";return f.includes("pdf")||a.endsWith(".pdf")?"fa-file-pdf text-red-500":f.includes("image")||/\.(png|jpg|jpeg|gif|svg|webp)$/i.test(a)?"fa-file-image text-blue-500":f.includes("word")||/\.(doc|docx)$/i.test(a)?"fa-file-word text-blue-600":f.includes("excel")||/\.(xls|xlsx|csv)$/i.test(a)?"fa-file-excel text-green-600":/\.(dwg|dxf)$/i.test(a)?"fa-drafting-compass text-orange-500":/\.(zip|rar|7z|tar|gz)$/i.test(a)?"fa-file-zipper text-yellow-600":"fa-file text-gray-400"}function ys(){Ge.value=!Ge.value}function ms(l){return se(this,null,function*(){var f;const a=l.target;if(!(!((f=a.files)!=null&&f.length)||!y.value)){Xe.value=!0,ht.value=0;try{const D=new FormData;D.append("file",a.files[0]),D.append("doctype","Orga Project"),D.append("docname",y.value.name),D.append("is_private","0");const I=new XMLHttpRequest;I.upload.addEventListener("progress",fe=>{fe.lengthComputable&&(ht.value=Math.round(fe.loaded/fe.total*100))}),yield new Promise((fe,Ve)=>{var $e;I.onload=()=>{I.status>=200&&I.status<300?fe():Ve(new Error(`Upload failed: ${I.statusText}`))},I.onerror=()=>Ve(new Error("Upload failed")),I.open("POST","/api/method/upload_file"),I.setRequestHeader("X-Frappe-CSRF-Token",(($e=window.frappe)==null?void 0:$e.csrf_token)||""),I.send(D)}),yield pe(),S(t("File uploaded"),t("Document attached to project"))}catch(D){console.error("Failed to upload project file:",D),O(t("Upload failed"),t("Could not attach file to project"))}finally{Xe.value=!1,ht.value=0,a.value=""}}})}function pe(){return se(this,null,function*(){!y.value&&(J.value=!0),De.value=null;try{const[a,f,D,I]=yield Promise.all([ie(Me.value),B(Me.value),xe("orga.orga.api.project.get_project_dependencies",{project_name:Me.value}),ae({status:"Active"})]);y.value=a.project,X.value=a.tasks||[],He.value=a.milestones||[],zt.value=a.team_members||[],Jt.value=(I==null?void 0:I.resources)||[],nt.value=a.documents||[],kt.value=a.task_attachments||[],Te.value=f||{},ot.value=D||[],le(Me.value).then(fe=>{Ot.value=(fe==null?void 0:fe.critical_tasks)||[]}).catch(()=>{Ot.value=[]}),Ct()}catch(a){console.error("Failed to load project:",a),De.value=a.message||t("Failed to load project")}finally{J.value=!1}})}return rt(()=>q.params.id,()=>{q.params.id&&pe()}),rt(()=>q.query,l=>{if(!l)return;const a=l.task,f=l.milestone;if(a){const D=Ye.value.find(I=>I.name===a)||X.value.find(I=>I.name===a);D&&(V.value=D,p.value=null,Y.value=!0,Z.value="gantt"),A.replace({path:q.path,query:{}})}else if(f){const D=Tt.value.find(I=>I.name===f);D&&(p.value=D,V.value=null,Y.value=!0,Z.value="gantt"),A.replace({path:q.path,query:{}})}}),As({onAddTask:()=>{ke.value="Open",Ze.value=!0},onAddMilestone:()=>{Oe.value=!0}}),Ma(()=>se(null,null,function*(){yield pe();const l=q.query.task,a=q.query.milestone;if(l){const f=Ye.value.find(D=>D.name===l)||X.value.find(D=>D.name===l);f&&(V.value=f,p.value=null,Y.value=!0,Z.value="gantt"),A.replace({path:q.path,query:{}})}else if(a){const f=Tt.value.find(D=>D.name===a);f&&(p.value=f,V.value=null,Y.value=!0,Z.value="gantt"),A.replace({path:q.path,query:{}})}document.addEventListener("click",Pa)})),Ka(()=>{document.removeEventListener("click",Pa)}),(l,a)=>{var f,D,I,fe,Ve,$e,Gt;return d(),u("div",ko,[J.value?(d(),u("div",ho,[e("div",_o,[a[37]||(a[37]=e("i",{class:"fa-solid fa-spinner fa-spin text-3xl text-orga-500 mb-3"},null,-1)),e("p",$o,n(o(t)("Loading project...")),1)])])):De.value?(d(),u("div",wo,[e("div",Do,[a[38]||(a[38]=e("i",{class:"fa-solid fa-exclamation-triangle text-red-500 dark:text-red-400 text-3xl mb-3"},null,-1)),e("h3",Co,n(o(t)("Error loading project")),1),e("p",jo,n(De.value),1),e("button",{onClick:pe,class:"px-4 py-2 bg-red-100 dark:bg-red-900/50 text-red-700 dark:text-red-300 rounded hover:bg-red-200 dark:hover:bg-red-900/70"},n(o(t)("Try Again")),1)])])):y.value?(d(),u(Q,{key:2},[e("div",To,[e("div",Mo,[ve(bo,{items:[{label:o(t)("Projects"),to:"/orga/projects"},{label:y.value.project_name,current:!0}]},null,8,["items"])]),e("div",So,[e("div",Lo,[e("button",{onClick:a[0]||(a[0]=g=>o(A).back()),class:"min-h-[44px] min-w-[44px] flex items-center justify-center text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",title:o(t)("Go back")},[...a[39]||(a[39]=[e("i",{class:"fa-solid fa-arrow-left text-lg"},null,-1)])],8,Fo),e("div",Io,[i.value?re((d(),u("input",{key:0,"onUpdate:modelValue":a[1]||(a[1]=g=>r.value=g),onKeydown:[we(h,["enter"]),we(k,["escape"])],onBlur:h,ref_key:"titleInputRef",ref:c,class:"text-h3 sm:text-h2 text-gray-800 dark:text-gray-100 m-0 w-full bg-transparent border-b-2 border-orga-500 outline-none",disabled:s.value},null,40,Po)),[[be,r.value]]):(d(),u("h1",{key:1,onClick:T,class:"text-h3 sm:text-h2 text-gray-800 dark:text-gray-100 m-0 truncate cursor-text hover:text-orga-600 dark:hover:text-orga-400 transition-colors",title:o(t)("Click to edit title")},n(y.value.project_name),9,Ao)),e("p",Eo,n(y.value.project_code)+" · "+n(y.value.project_type),1)])]),e("div",Uo,[e("div",zo,[e("button",{onClick:a[2]||(a[2]=g=>Z.value="gantt"),class:F(["min-h-[44px] min-w-[44px] sm:min-w-0 px-2 sm:px-3 py-2 sm:py-1.5 rounded-md text-sm font-medium transition-all flex items-center justify-center gap-2",Z.value==="gantt"?"bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200"]),title:o(t)("Gantt View")},[a[40]||(a[40]=e("i",{class:"fa-solid fa-bars-progress"},null,-1)),e("span",Ro,n(o(t)("Gantt")),1)],10,Oo),e("button",{onClick:a[3]||(a[3]=g=>Z.value="kanban"),class:F(["min-h-[44px] min-w-[44px] sm:min-w-0 px-2 sm:px-3 py-2 sm:py-1.5 rounded-md text-sm font-medium transition-all flex items-center justify-center gap-2",Z.value==="kanban"?"bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200"]),title:o(t)("Kanban View")},[a[41]||(a[41]=e("i",{class:"fa-solid fa-table-columns"},null,-1)),e("span",Wo,n(o(t)("Kanban")),1)],10,Bo),e("button",{onClick:a[4]||(a[4]=g=>Z.value="list"),class:F(["min-h-[44px] min-w-[44px] sm:min-w-0 px-2 sm:px-3 py-2 sm:py-1.5 rounded-md text-sm font-medium transition-all flex items-center justify-center gap-2",Z.value==="list"?"bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200"]),title:o(t)("List View")},[a[42]||(a[42]=e("i",{class:"fa-solid fa-list"},null,-1)),e("span",Vo,n(o(t)("List")),1)],10,No)]),e("div",Ho,[e("button",{onClick:a[5]||(a[5]=g=>Ze.value=!0),class:"min-h-[44px] min-w-[44px] sm:min-w-0 px-3 py-2 sm:py-1.5 text-sm font-medium text-white bg-orga-500 rounded-lg hover:bg-orga-600 flex items-center justify-center gap-2",title:o(t)("Add Task (Shift+T)")},[a[43]||(a[43]=e("i",{class:"fa-solid fa-plus"},null,-1)),e("span",qo,n(o(t)("Add Task")),1)],8,Go),e("button",{onClick:a[6]||(a[6]=g=>Oe.value=!0),class:"min-h-[44px] min-w-[44px] sm:min-w-0 px-3 py-2 sm:py-1.5 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center justify-center gap-2",title:o(t)("Add Milestone (Shift+M)")},[a[44]||(a[44]=e("i",{class:"fa-solid fa-flag"},null,-1)),e("span",Jo,n(o(t)("Add Milestone")),1)],8,Ko)]),e("div",{ref_key:"depModeDropdownRef",ref:ja,class:"relative ml-2 sm:ml-4"},[e("button",{onClick:a[7]||(a[7]=g=>Ft.value=!Ft.value),class:"min-h-[44px] min-w-[44px] sm:min-w-0 px-2 sm:px-3 py-2 sm:py-1.5 rounded-lg text-sm font-medium transition-all flex items-center justify-center gap-2 border bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-400 border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700",title:o(t)("Dependency Mode: {0}",[It.value])},[e("i",{class:F(["fa-solid",is.value])},null,2),e("span",Zo,n(It.value),1)],8,Qo),Ft.value?(d(),u("div",Xo,[(d(!0),u(Q,null,ne(Aa.value,g=>(d(),u("button",{key:g.value,onClick:P=>ds(g.value),class:F(["w-full text-left px-3 py-2 text-sm flex items-start gap-2 transition-colors",g.value===It.value?"bg-orga-50 dark:bg-orga-900/20 text-orga-700 dark:text-orga-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"])},[e("i",{class:F(["fa-solid",g.icon,"mt-0.5 w-4 text-center"])},null,2),e("div",null,[e("div",ei,n(g.value),1),e("div",ti,n(g.description),1)]),g.value===It.value?(d(),u("i",ai)):_("",!0)],10,Yo))),128))])):_("",!0)],512),e("div",si,[e("button",{onClick:a[8]||(a[8]=g=>ue.value=!ue.value),class:F(["min-h-[44px] min-w-[44px] sm:min-w-0 px-2 sm:px-3 py-2 sm:py-1.5 rounded-lg text-sm font-medium transition-all flex items-center justify-center gap-2 border",ue.value?"bg-orga-500 text-white border-orga-500":"bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-400 border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700"]),title:o(t)("Toggle Details Panel")},[a[45]||(a[45]=e("i",{class:"fa-solid fa-circle-info"},null,-1)),e("span",li,n(o(t)("Details")),1)],10,ri),e("button",{onClick:a[9]||(a[9]=g=>Y.value=!Y.value),class:F(["min-h-[44px] min-w-[44px] sm:min-w-0 px-2 sm:px-3 py-2 sm:py-1.5 rounded-lg text-sm font-medium transition-all flex items-center justify-center gap-2 border",Y.value?"bg-orga-500 text-white border-orga-500":"bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-400 border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700"]),title:o(t)("Toggle Manager Panel")},[a[46]||(a[46]=e("i",{class:"fa-solid fa-sliders"},null,-1)),e("span",oi,n(o(t)("Manager")),1)],10,ni)]),e("div",ii,[e("button",{onClick:a[10]||(a[10]=g=>Re.value=!Re.value),class:"min-h-[44px] min-w-[44px] sm:min-w-0 px-2 sm:px-3 py-2 sm:py-1.5 rounded-lg text-sm font-medium transition-all flex items-center justify-center border bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-400 border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700",title:o(t)("Project settings")},[...a[47]||(a[47]=[e("i",{class:"fa-solid fa-gear"},null,-1)])],8,di),Re.value?(d(),u("div",ui,[e("button",{onClick:us,disabled:ua.value,class:F(["w-full flex items-center gap-2 px-4 py-2.5 text-sm hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-left",ca.value?"text-blue-600 dark:text-blue-400":"text-gray-700 dark:text-gray-300"])},[a[48]||(a[48]=e("i",{class:"fa-solid fa-forward text-xs w-4 text-center"},null,-1)),R(" "+n(o(t)("Auto-Trail Start"))+" ",1),ca.value?(d(),u("i",gi)):_("",!0)],10,ci),a[51]||(a[51]=e("div",{class:"border-t border-gray-100 dark:border-gray-700 my-1"},null,-1)),e("button",{onClick:a[11]||(a[11]=g=>{Re.value=!1,Le.value=!0}),class:"w-full flex items-center gap-2 px-4 py-2.5 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-left"},[a[49]||(a[49]=e("i",{class:"fa-solid fa-copy text-xs w-4 text-center"},null,-1)),R(" "+n(o(t)("Save as Template")),1)]),a[52]||(a[52]=e("div",{class:"border-t border-gray-100 dark:border-gray-700 my-1"},null,-1)),e("button",{onClick:a[12]||(a[12]=g=>{Re.value=!1,je.value=!0}),class:"w-full flex items-center gap-2 px-4 py-2.5 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-950/30 transition-colors text-left"},[a[50]||(a[50]=e("i",{class:"fa-solid fa-trash text-xs w-4 text-center"},null,-1)),R(" "+n(o(t)("Delete Project")),1)])])):_("",!0),Re.value?(d(),u("div",{key:1,class:"fixed inset-0 z-40",onClick:a[13]||(a[13]=g=>Re.value=!1)})):_("",!0)])])])]),e("div",vi,[e("div",pi,[Z.value==="kanban"?(d(),u("div",fi,[(d(!0),u(Q,null,ne(Qt.value,g=>(d(),u("div",{key:g.id,class:F(["kanban-column rounded-xl p-4 min-h-[400px] transition-all duration-200","border border-gray-200 dark:border-gray-700","bg-white dark:bg-gray-800","shadow-sm dark:shadow-lg dark:shadow-black/30",g.color,Ce.value===g.id&&_e.value&&_e.value.status!==g.id&&"drop-target"]),onDragover:P=>et(P,g.id),onDragleave:P=>gt(P,g.id),onDrop:P=>vt(P,g.id)},[e("div",mi,[e("h3",xi,n(g.title),1),e("span",bi,n(ct(g.id).length),1)]),e("div",ki,[(d(!0),u(Q,null,ne(ct(g.id),P=>{var ze,Na;return d(),u("div",{key:P.name,draggable:"true",tabindex:"0",onDragstart:pa=>Mt(pa,P),onDragend:_a,onClick:pa=>Ae(P),onKeydown:[we(pa=>Ae(P),["enter"]),we(me(pa=>Ae(P),["prevent"]),["space"])],class:F(["kanban-card rounded-lg p-3 cursor-grab transition-all duration-200","bg-white dark:bg-gray-700","border border-gray-200 dark:border-gray-600","hover:shadow-md dark:hover:shadow-lg dark:hover:shadow-black/30","hover:border-gray-300 dark:hover:border-gray-600",((ze=V.value)==null?void 0:ze.name)===P.name?"ring-2 ring-orga-300 card-selected":P.status==="Open"?"card-open":P.status==="In Progress"?"card-in-progress":P.status==="Review"?"card-review":P.status==="Completed"?"card-completed":"border-l-4 border-l-gray-300",((Na=_e.value)==null?void 0:Na.name)===P.name&&"dragging",bt.value===P.name&&"just-dropped",P.is_blocked&&"opacity-60"]),title:P.is_blocked?wt(P.name):void 0},[e("div",_i,[e("h4",$i,n(P.subject),1),e("div",wi,[P.is_blocked?(d(),Pe(Je,{key:0,status:"Blocked",type:"blocked",size:"sm",title:wt(P.name)},null,8,["title"])):_("",!0),ve(Je,{status:P.priority,type:"priority",size:"sm","show-icon":!1},null,8,["status"])])]),P.due_date?(d(),u("div",Di,[a[53]||(a[53]=e("i",{class:"fa-regular fa-calendar mr-1 text-gray-500 dark:text-gray-400"},null,-1)),R(" "+n(Fe(P.due_date)),1)])):_("",!0),e("div",Ci,[P.assigned_to_name?(d(),u("div",ji,[ve(qt,{name:P.assigned_to_name,image:P.assigned_to_image,size:"xs",color:"orga"},null,8,["name","image"]),e("span",Ti,n(P.assigned_to_name),1)])):(d(),u("div",Mi,n(o(t)("Unassigned")),1)),P.progress?(d(),u("div",Si,n(P.progress)+"%",1)):_("",!0)])],42,hi)}),128))])],42,yi))),128))])):_("",!0),Z.value==="list"?(d(),u("div",Li,[e("table",Fi,[e("thead",Ii,[e("tr",null,[e("th",Pi,n(o(t)("Task")),1),e("th",Ai,n(o(t)("Status")),1),e("th",Ei,n(o(t)("Priority")),1),e("th",Ui,n(o(t)("Assignee")),1),e("th",zi,n(o(t)("Due Date")),1)])]),e("tbody",null,[(d(!0),u(Q,null,ne(X.value,g=>{var P;return d(),u("tr",{key:g.name,onClick:ze=>Ae(g),tabindex:"0",class:F(["task-row border-b border-gray-100 dark:border-gray-700",((P=V.value)==null?void 0:P.name)===g.name?"bg-orga-50 dark:bg-orga-900/20":"",g.is_blocked&&"opacity-60"]),title:g.is_blocked?wt(g.name):void 0,onKeydown:[we(ze=>Ae(g),["enter"]),we(me(ze=>Ae(g),["prevent"]),["space"])]},[e("td",Ri,[e("div",Bi,n(g.subject),1),e("div",Wi,n(g.name),1)]),e("td",Ni,[e("div",Vi,[ve(Je,{status:g.status,type:"task",size:"sm"},null,8,["status"]),g.is_blocked?(d(),Pe(Je,{key:0,status:"Blocked",type:"blocked",size:"sm",title:wt(g.name)},null,8,["title"])):_("",!0)])]),e("td",Hi,[ve(Je,{status:g.priority,type:"priority",size:"sm"},null,8,["status"])]),e("td",Gi,[g.assigned_to_name?(d(),u("div",qi,[ve(qt,{name:g.assigned_to_name,image:g.assigned_to_image,size:"xs",color:"orga"},null,8,["name","image"]),e("span",Ki,n(g.assigned_to_name),1)])):(d(),u("span",Ji,n(o(t)("Unassigned")),1))]),e("td",Qi,n(g.due_date?Fe(g.due_date):"-"),1)],42,Oi)}),128))])]),X.value.length===0?(d(),Pe(Ta,{key:0,icon:"fa-list-check",title:o(t)("No tasks yet"),description:o(t)("Create your first task to start tracking work on this project."),"action-label":o(t)("+ Create Task"),onAction:a[14]||(a[14]=g=>Ze.value=!0),size:"md"},null,8,["title","description","action-label"])):_("",!0)])):_("",!0),Z.value==="gantt"?(d(),u("div",Zi,[ve(ll,{tasks:Ke.value,"start-date":(f=y.value)==null?void 0:f.start_date,"end-date":(D=y.value)==null?void 0:D.end_date,"selected-task-id":(I=V.value)==null?void 0:I.name,"just-reordered-id":lt.value,"critical-path-tasks":Ot.value,onSelect:Yt,onUpdateDates:jt,onReorderItem:Bt,onUpdateMilestoneDate:ta,onCreateDependency:ea},null,8,["tasks","start-date","end-date","selected-task-id","just-reordered-id","critical-path-tasks"])])):_("",!0)]),Y.value?(d(),u("div",{key:0,class:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:a[15]||(a[15]=g=>Y.value=!1)})):_("",!0),Y.value?(d(),u("aside",Xi,[V.value?(d(),Pe(Ps,{key:0,task:V.value,columns:Qt.value,"all-tasks":Z.value==="gantt"?Ye.value:X.value,contacts:Jt.value,"available-groups":Zt.value,"view-type":Z.value,project:Z.value==="gantt"?y.value:void 0,"show-cascade-preview":Z.value==="gantt",onUpdate:pe,onClose:a[16]||(a[16]=g=>Y.value=!1),onStatusChange:ka,onPriorityChange:ha,onFieldUpdate:sa,onNavigate:ba,onPreviewCascade:ra,onApplyCascade:xa},null,8,["task","columns","all-tasks","contacts","available-groups","view-type","project","show-cascade-preview"])):p.value?(d(),u("div",Yi,[e("div",ed,[e("h3",td,[a[54]||(a[54]=e("i",{class:"fa-solid fa-flag text-indigo-500"},null,-1)),R(" "+n(o(t)("Milestone")),1)]),e("button",{onClick:a[17]||(a[17]=g=>{Y.value=!1,p.value=null}),class:"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors"},[...a[55]||(a[55]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),e("div",ad,[e("div",null,[ga.value?(d(),u("div",sd,[re(e("input",{"onUpdate:modelValue":a[18]||(a[18]=g=>Vt.value=g),type:"text",maxlength:"255",class:"flex-1 text-lg font-semibold px-2 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100 focus:outline-none focus:border-orga-500 dark:focus:border-orga-400 focus:ring-1 focus:ring-orga-500 dark:focus:ring-orga-400",onKeydown:[we(Ua,["enter"]),we(Ea,["escape"])]},null,544),[[be,Vt.value]]),e("button",{onClick:Ua,disabled:Pt.value||!Vt.value.trim(),class:"p-1.5 text-xs text-white bg-orga-500 rounded hover:bg-orga-600 transition-colors disabled:opacity-50"},[Pt.value?(d(),u("i",ld)):(d(),u("i",nd))],8,rd),e("button",{onClick:Ea,disabled:Pt.value,class:"p-1.5 text-xs text-gray-600 dark:text-gray-400 bg-gray-100 dark:bg-gray-700 rounded hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors disabled:opacity-50"},[...a[56]||(a[56]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])],8,od)])):(d(),u("h4",{key:1,onClick:cs,class:"text-lg font-semibold text-gray-800 dark:text-gray-100 cursor-pointer group hover:ring-1 hover:ring-orga-300 dark:hover:ring-orga-600 rounded px-1 -mx-1 transition-all",title:o(t)("Click to edit milestone name")},[R(n(p.value.subject)+" ",1),a[57]||(a[57]=e("i",{class:"fa-solid fa-pen-to-square text-[10px] text-gray-400 dark:text-gray-500 ml-1 opacity-0 group-hover:opacity-100 transition-opacity"},null,-1))],8,id))]),e("div",dd,[e("label",ud,n(o(t)("Status")),1),e("select",{value:p.value.status,onChange:a[19]||(a[19]=g=>aa({field:"status",value:g.target.value})),class:"flex-1 px-2 py-1.5 text-sm border border-gray-200 dark:border-gray-700 rounded bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300"},[e("option",gd,n(o(t)("Upcoming")),1),e("option",vd,n(o(t)("In Progress")),1),e("option",pd,n(o(t)("Completed")),1),e("option",fd,n(o(t)("Missed")),1)],40,cd)]),e("div",yd,[e("label",md,n(o(t)("Due Date")),1),e("input",{type:"date",value:p.value.due_date,onChange:a[20]||(a[20]=g=>aa({field:"due_date",value:g.target.value})),class:"flex-1 px-2 py-1.5 text-sm border border-gray-200 dark:border-gray-700 rounded bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300"},null,40,xd)]),e("div",null,[e("div",bd,[e("label",kd,n(o(t)("Progress")),1),e("div",hd,[e("div",_d,[e("div",$d,[e("div",{class:F(["h-full rounded-full transition-all",p.value.progress===100?"bg-emerald-500":p.value.progress>0?"bg-indigo-500":"bg-gray-300 dark:bg-gray-600"]),style:oe({width:`${p.value.progress||0}%`})},null,6)]),e("span",wd,n(p.value.progress||0)+"%",1)])])]),e("p",Dd,[((fe=p.value.task_count)!=null?fe:0)>0?(d(),u(Q,{key:0},[R(n(o(t)("{0} of {1} linked tasks completed",[X.value.filter(g=>{var P;return g.milestone===((P=p.value)==null?void 0:P.name)&&g.status==="Completed"}).length,p.value.task_count])),1)],64)):(d(),u(Q,{key:1},[R(n(o(t)("No tasks linked to this milestone")),1)],64))])]),e("div",null,[e("label",Cd,n(o(t)("Description")),1),Ht.value?(d(),u("div",jd,[re(e("textarea",{"onUpdate:modelValue":a[21]||(a[21]=g=>va.value=g),rows:"3",class:"w-full px-2 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 focus:outline-none focus:border-orga-500 dark:focus:border-orga-400 focus:ring-1 focus:ring-orga-500 dark:focus:ring-orga-400 resize-y",placeholder:o(t)("Add a milestone description..."),onKeydown:we(za,["escape"])},null,40,Td),[[be,va.value]]),e("div",Md,[e("button",{onClick:za,disabled:yt.value,class:"px-2.5 py-1 text-xs font-medium text-gray-600 dark:text-gray-400 bg-gray-100 dark:bg-gray-700 rounded hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors disabled:opacity-50"},n(o(t)("Cancel")),9,Sd),e("button",{onClick:vs,disabled:yt.value,class:"px-2.5 py-1 text-xs font-medium text-white bg-orga-500 rounded hover:bg-orga-600 transition-colors disabled:opacity-50 flex items-center gap-1"},[yt.value?(d(),u("i",Fd)):_("",!0),R(" "+n(yt.value?o(t)("Saving..."):o(t)("Save")),1)],8,Ld)])])):(d(),u("div",{key:1,onClick:gs,class:"cursor-pointer group",title:o(t)("Click to edit description")},[p.value.description?(d(),u("p",Pd,[R(n(p.value.description)+" ",1),a[58]||(a[58]=e("i",{class:"fa-solid fa-pen-to-square text-[10px] text-gray-400 dark:text-gray-500 ml-1 opacity-0 group-hover:opacity-100 transition-opacity"},null,-1))])):(d(),u("p",Ad,[R(n(o(t)("Click to add description..."))+" ",1),a[59]||(a[59]=e("i",{class:"fa-solid fa-pen-to-square text-[10px] ml-1 opacity-0 group-hover:opacity-100 transition-opacity"},null,-1))]))],8,Id))]),e("div",null,[e("div",Ed,[e("label",Ud,n(o(t)("Linked Tasks")),1),mt.value?(d(),u("button",{key:1,onClick:a[23]||(a[23]=g=>{mt.value=!1,at.value=""}),class:"text-xs text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 font-medium transition-colors"},n(o(t)("Cancel")),1)):(d(),u("button",{key:0,onClick:a[22]||(a[22]=g=>{mt.value=!0,at.value=""}),class:"text-xs text-orga-500 hover:text-orga-600 dark:text-orga-400 dark:hover:text-orga-300 font-medium flex items-center gap-1 transition-colors"},[a[60]||(a[60]=e("i",{class:"fa-solid fa-plus text-[10px]"},null,-1)),R(" "+n(o(t)("Link Task")),1)]))]),mt.value?(d(),u("div",zd,[re(e("input",{"onUpdate:modelValue":a[24]||(a[24]=g=>at.value=g),type:"text",placeholder:o(t)("Search tasks to link..."),class:"w-full px-2.5 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 focus:outline-none focus:border-orga-500 dark:focus:border-orga-400 focus:ring-1 focus:ring-orga-500 dark:focus:ring-orga-400"},null,8,Od),[[be,at.value]]),e("div",Rd,[(d(!0),u(Q,null,ne(Oa.value.slice(0,10),g=>(d(),u("div",{key:g.name,onClick:P=>ps(g),class:"flex items-center gap-2 px-2.5 py-2 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-colors border-b border-gray-100 dark:border-gray-700 last:border-b-0"},[ve(Je,{status:g.status,size:"sm"},null,8,["status"]),e("span",Wd,n(g.subject),1)],8,Bd))),128)),Oa.value.length===0?(d(),u("p",Nd,n(at.value?o(t)("No matching tasks found"):o(t)("All tasks are already linked")),1)):_("",!0)])])):_("",!0),e("div",Vd,[(d(!0),u(Q,null,ne(X.value.filter(g=>{var P;return g.milestone===((P=p.value)==null?void 0:P.name)}),g=>(d(),u("div",{key:g.name,class:"flex items-center gap-2 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 group transition-colors"},[ve(Je,{status:g.status,size:"sm"},null,8,["status"]),e("span",{onClick:P=>{p.value=null,Ae(g)},class:"text-sm text-gray-700 dark:text-gray-300 truncate flex-1 cursor-pointer hover:text-orga-600 dark:hover:text-orga-400"},n(g.subject),9,Hd),e("button",{onClick:me(P=>fs(g),["stop"]),class:"text-gray-300 dark:text-gray-600 hover:text-red-500 dark:hover:text-red-400 opacity-0 group-hover:opacity-100 transition-all shrink-0",title:o(t)("Unlink task from milestone")},[...a[61]||(a[61]=[e("i",{class:"fa-solid fa-xmark text-xs"},null,-1)])],8,Gd)]))),128)),X.value.filter(g=>{var P;return g.milestone===((P=p.value)==null?void 0:P.name)}).length===0&&!mt.value?(d(),u("p",qd,n(o(t)("No tasks linked to this milestone")),1)):_("",!0)])]),p.value.completed_date?(d(),u("div",Kd,[e("label",Jd,n(o(t)("Completed")),1),e("span",Qd,n(Fe(p.value.completed_date)),1)])):_("",!0)])])):(d(),u("div",Zd,[e("div",Xd,[e("h3",Yd,[a[62]||(a[62]=e("i",{class:"fa-solid fa-sliders text-orga-500"},null,-1)),R(" "+n(o(t)("Manager")),1)]),e("button",{onClick:a[25]||(a[25]=g=>Y.value=!1),class:"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors"},[...a[63]||(a[63]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),e("div",eu,[ve(Ta,{icon:"fa-hand-pointer",title:o(t)("No task selected"),description:Z.value==="gantt"?o(t)("Select a task from the Gantt chart to view and manage its details."):o(t)("Select a task from the list or Kanban board to view and manage its details."),size:"sm"},null,8,["title","description"])])]))])):_("",!0)]),ue.value?(d(),u("div",tu,[e("div",au,[e("div",su,[a[64]||(a[64]=e("div",{class:"w-7 h-7 rounded-md bg-orga-50 dark:bg-orga-900/30 flex items-center justify-center"},[e("i",{class:"fa-solid fa-chart-pie text-orga-500 text-xs"})],-1)),e("div",ru,[e("span",lu,n(o(t)("Progress")),1),e("span",nu,n(dt.value)+"%",1)]),e("div",ou,[e("div",{class:"h-full bg-orga-500 rounded-full transition-all",style:oe({width:`${dt.value}%`})},null,4)])]),a[73]||(a[73]=e("div",{class:"w-px h-5 bg-gray-200 dark:bg-gray-700"},null,-1)),e("div",iu,[a[65]||(a[65]=e("div",{class:"w-7 h-7 rounded-md bg-blue-50 dark:bg-blue-900/30 flex items-center justify-center"},[e("i",{class:"fa-solid fa-list-check text-blue-600 dark:text-blue-400 text-xs"})],-1)),e("div",du,[e("span",uu,n(o(t)("Tasks")),1),e("span",cu,n(_t.value)+"/"+n(it.value),1)])]),a[74]||(a[74]=e("div",{class:"w-px h-5 bg-gray-200 dark:bg-gray-700"},null,-1)),e("div",gu,[a[66]||(a[66]=e("div",{class:"w-7 h-7 rounded-md bg-purple-50 dark:bg-purple-900/30 flex items-center justify-center"},[e("i",{class:"fa-solid fa-flag text-purple-600 dark:text-purple-400 text-xs"})],-1)),e("div",vu,[e("span",pu,n(o(t)("Milestones")),1),e("span",fu,n(He.value.length),1)])]),y.value.budget?(d(),u(Q,{key:0},[a[68]||(a[68]=e("div",{class:"w-px h-5 bg-gray-200 dark:bg-gray-700"},null,-1)),e("div",yu,[a[67]||(a[67]=e("div",{class:"w-7 h-7 rounded-md bg-emerald-50 dark:bg-emerald-900/30 flex items-center justify-center"},[e("i",{class:"fa-solid fa-wallet text-emerald-600 dark:text-emerald-400 text-xs"})],-1)),e("div",mu,[e("span",xu,n(o(t)("Budget")),1),e("span",bu,n(o(ee)(y.value.spent))+" / "+n(o(ee)(y.value.budget)),1)]),e("div",ku,[e("div",{class:F(["h-full rounded-full transition-all",ut.value>=100?"bg-red-500":ut.value>=80?"bg-amber-500":"bg-emerald-500"]),style:oe({width:`${ut.value}%`})},null,6)])])],64)):_("",!0),y.value.estimated_cost?(d(),u(Q,{key:1},[a[70]||(a[70]=e("div",{class:"w-px h-5 bg-gray-200 dark:bg-gray-700"},null,-1)),e("div",hu,[a[69]||(a[69]=e("div",{class:"w-7 h-7 rounded-md bg-blue-50 dark:bg-blue-900/30 flex items-center justify-center"},[e("i",{class:"fa-solid fa-calculator text-blue-600 dark:text-blue-400 text-xs"})],-1)),e("div",_u,[e("span",$u,n(o(t)("Estimated")),1),e("span",{class:F(["text-sm font-semibold",y.value.budget&&Be.value>=100?"text-red-600 dark:text-red-400":"text-gray-800 dark:text-gray-100"])},n(o(ee)(y.value.estimated_cost)),3)])])],64)):_("",!0),ye.value?(d(),u(Q,{key:2},[a[72]||(a[72]=e("div",{class:"w-px h-5 bg-gray-200 dark:bg-gray-700"},null,-1)),e("div",wu,[a[71]||(a[71]=e("div",{class:"w-7 h-7 rounded-md bg-amber-50 dark:bg-amber-900/30 flex items-center justify-center"},[e("i",{class:"fa-solid fa-hourglass-half text-amber-600 dark:text-amber-400 text-xs"})],-1)),e("div",Du,[e("span",Cu,n(o(t)("Duration")),1),e("span",ju,n(ye.value.label),1)]),ye.value.total>0?(d(),u("div",Tu,[e("div",{class:F(["h-full rounded-full transition-all",$t.value>=100?"bg-red-500":$t.value>=80?"bg-amber-500":"bg-amber-400"]),style:oe({width:`${$t.value}%`})},null,6)])):_("",!0),ye.value.total>0?(d(),u("span",Mu,n(ye.value.remaining>0?o(t)("{0}d left",[ye.value.remaining]):o(t)("overdue")),1)):_("",!0)])],64)):_("",!0)]),e("div",Su,[e("div",Lu,[e("h4",Fu,[a[75]||(a[75]=e("i",{class:"fa-solid fa-circle-info"},null,-1)),R(" "+n(o(t)("Project Info")),1)]),e("div",Iu,[e("div",{ref_key:"statusDropdownRef",ref:$a,class:"relative flex items-center gap-2"},[e("span",Pu,n(o(t)("Status:")),1),e("button",{onClick:me(rs,["stop"]),class:"cursor-pointer hover:ring-2 hover:ring-orga-300 dark:hover:ring-orga-600 rounded-full transition-all",title:o(t)("Click to change status"),disabled:ia.value},[ve(Je,{status:y.value.status,type:"project",size:"sm"},null,8,["status"])],8,Au),St.value?(d(),u("div",Eu,[(d(),u(Q,null,ne(ss,g=>e("button",{key:g.value,onClick:P=>ls(g.value),class:F(["w-full text-left px-3 py-1.5 text-sm flex items-center gap-2 transition-colors",g.value===y.value.status?"bg-orga-50 dark:bg-orga-900/30 font-medium":"hover:bg-gray-50 dark:hover:bg-gray-700"])},[e("i",{class:F(["fa-solid",g.icon,g.color,"w-4 text-center text-xs"])},null,2),e("span",zu,n(g.value),1),g.value===y.value.status?(d(),u("i",Ou)):_("",!0)],10,Uu)),64))])):_("",!0)],512),e("div",{ref_key:"typeDropdownRef",ref:wa,class:"relative flex items-center gap-2"},[e("span",Ru,n(o(t)("Type:")),1),e("button",{onClick:me(ns,["stop"]),class:"ml-2 text-gray-800 dark:text-gray-100 cursor-pointer hover:text-orga-600 dark:hover:text-orga-400 transition-colors flex items-center gap-1",title:o(t)("Click to change type"),disabled:da.value},[e("i",{class:F(["fa-solid",((Ve=Da.find(g=>{var P;return g.value===((P=y.value)==null?void 0:P.project_type)}))==null?void 0:Ve.icon)||"fa-folder",(($e=Da.find(g=>{var P;return g.value===((P=y.value)==null?void 0:P.project_type)}))==null?void 0:$e.color)||"text-gray-500","text-xs"])},null,2),R(" "+n((Gt=y.value)==null?void 0:Gt.project_type),1)],8,Bu),Lt.value?(d(),u("div",Wu,[(d(),u(Q,null,ne(Da,g=>e("button",{key:g.value,onClick:P=>os(g.value),class:F(["w-full text-left px-3 py-1.5 text-sm flex items-center gap-2 transition-colors",g.value===y.value.project_type?"bg-orga-50 dark:bg-orga-900/30 font-medium":"hover:bg-gray-50 dark:hover:bg-gray-700"])},[e("i",{class:F(["fa-solid",g.icon,g.color,"w-4 text-center text-xs"])},null,2),e("span",Vu,n(g.value),1),g.value===y.value.project_type?(d(),u("i",Hu)):_("",!0)],10,Nu)),64))])):_("",!0)],512),e("div",null,[e("span",Gu,n(o(t)("Start:")),1),U.value?re((d(),u("input",{key:0,ref_key:"startDateInputRef",ref:te,"onUpdate:modelValue":a[26]||(a[26]=g=>C.value=g),type:"date",onKeydown:[we(La,["enter"]),we(Sa,["escape"])],onBlur:La,disabled:ge.value,class:"ml-2 px-1.5 py-0.5 text-sm border-b-2 border-orga-500 bg-transparent outline-none text-gray-800 dark:text-gray-100 dark:[color-scheme:dark]"},null,40,qu)),[[be,C.value]]):(d(),u("span",{key:1,onClick:ts,class:"ml-2 text-gray-800 dark:text-gray-100 cursor-text hover:text-orga-600 dark:hover:text-orga-400 transition-colors",title:o(t)("Click to edit start date")},n(Fe(y.value.start_date)),9,Ku))]),e("div",null,[e("span",Ju,n(o(t)("End:")),1),Ue.value?re((d(),u("input",{key:0,ref_key:"endDateInputRef",ref:oa,"onUpdate:modelValue":a[27]||(a[27]=g=>he.value=g),type:"date",onKeydown:[we(Ia,["enter"]),we(Fa,["escape"])],onBlur:Ia,disabled:tt.value,class:"ml-2 px-1.5 py-0.5 text-sm border-b-2 border-orga-500 bg-transparent outline-none text-gray-800 dark:text-gray-100 dark:[color-scheme:dark]"},null,40,Qu)),[[be,he.value]]):(d(),u("span",{key:1,onClick:as,class:"ml-2 text-gray-800 dark:text-gray-100 cursor-text hover:text-orga-600 dark:hover:text-orga-400 transition-colors",title:o(t)("Click to edit end date")},n(Fe(y.value.end_date)),9,Zu))]),ye.value?(d(),u("div",Xu,[e("span",Yu,n(o(t)("Duration:")),1),e("span",e0,[R(n(ye.value.label)+" ",1),ye.value.total>0&&ye.value.remaining>0?(d(),u("span",t0,"("+n(o(t)("{0}d remaining",[ye.value.remaining]))+")",1)):ye.value.total>0&&ye.value.remaining<=0?(d(),u("span",a0,"("+n(o(t)("overdue"))+")",1)):_("",!0)])])):_("",!0),e("div",null,[e("span",s0,n(o(t)("Budget:")),1),x.value?(d(),u("div",r0,[e("span",l0,n(o(ce)),1),re(e("input",{ref_key:"budgetInputRef",ref:L,"onUpdate:modelValue":a[28]||(a[28]=g=>H.value=g),type:"number",min:"0",step:"100",onKeydown:[we(M,["enter"]),we(W,["escape"])],onBlur:M,disabled:b.value,class:"w-28 px-1.5 py-0.5 text-sm border-b-2 border-orga-500 bg-transparent outline-none text-gray-800 dark:text-gray-100"},null,40,n0),[[be,H.value,void 0,{number:!0}]])])):(d(),u("span",{key:1,onClick:$,class:"ml-2 text-gray-800 dark:text-gray-100 cursor-text hover:text-orga-600 dark:hover:text-orga-400 transition-colors",title:o(t)("Click to edit budget")},n(y.value.budget?o(ee)(y.value.budget):o(t)("Not set")),9,o0))]),y.value.estimated_cost?(d(),u("div",i0,[e("span",d0,n(o(t)("Estimated:")),1),e("span",{class:F(["ml-2",y.value.budget&&Be.value>=100?"text-red-600 dark:text-red-400":"text-gray-800 dark:text-gray-100"])},[R(n(o(ee)(y.value.estimated_cost))+" ",1),y.value.budget?(d(),u("span",u0,"("+n(Be.value)+"%)",1)):_("",!0)],2)])):_("",!0),y.value.budget?(d(),u("div",c0,[e("span",g0,n(o(t)("Spent:")),1),e("span",{class:F(["ml-2",ut.value>=100?"text-red-600 dark:text-red-400":"text-gray-800 dark:text-gray-100"])},[R(n(o(ee)(y.value.spent))+" ",1),e("span",v0,"("+n(ut.value)+"%)",1)],2)])):_("",!0),qe.value!==null&&y.value.estimated_cost?(d(),u("div",p0,[e("span",f0,n(o(t)("Variance:")),1),e("span",{class:F(["ml-2 font-medium",qe.value>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"])},[R(n(qe.value>=0?"+":"")+n(o(ee)(qe.value))+" ",1),e("span",y0,"("+n(ma.value)+"%)",1)],2)])):_("",!0)]),e("div",m0,[ft.value?(d(),u("div",x0,[re(e("textarea",{"onUpdate:modelValue":a[29]||(a[29]=g=>Ee.value=g),rows:"3",class:"w-full px-2 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 focus:outline-none focus:border-orga-500 dark:focus:border-orga-400 focus:ring-1 focus:ring-orga-500 dark:focus:ring-orga-400 resize-y",placeholder:o(t)("Add a project description..."),onKeydown:we(Wt,["escape"])},null,40,b0),[[be,Ee.value]]),e("div",k0,[e("button",{onClick:Wt,disabled:Ne.value,class:"px-2.5 py-1 text-xs font-medium text-gray-600 dark:text-gray-400 bg-gray-100 dark:bg-gray-700 rounded hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors disabled:opacity-50"},n(o(t)("Cancel")),9,h0),e("button",{onClick:Nt,disabled:Ne.value,class:"px-2.5 py-1 text-xs font-medium text-white bg-orga-500 rounded hover:bg-orga-600 transition-colors disabled:opacity-50 flex items-center gap-1"},[Ne.value?(d(),u("i",$0)):_("",!0),R(" "+n(Ne.value?o(t)("Saving..."):o(t)("Save")),1)],8,_0)])])):(d(),u("div",{key:1,onClick:na,class:"cursor-pointer group",title:o(t)("Click to edit description")},[y.value.description?(d(),u("p",{key:0,class:"text-sm text-gray-700 dark:text-gray-300 m-0 line-clamp-2 group-hover:text-orga-600 dark:group-hover:text-orga-400 transition-colors",innerHTML:o(Ms)(y.value.description)},null,8,D0)):(d(),u("p",C0,n(o(t)("Click to add description...")),1))],8,w0))])]),e("div",j0,[e("h4",T0,[a[76]||(a[76]=e("i",{class:"fa-solid fa-users"},null,-1)),R(" "+n(o(t)("Team")),1)]),zt.value.length>0?(d(),u("div",M0,[(d(!0),u(Q,null,ne(zt.value,g=>(d(),u("div",{key:g.user,class:"relative group",title:g.full_name+(g.is_manager?" ("+o(t)("Manager")+")":"")},[g.user_image?(d(),u("img",{key:0,src:g.user_image,alt:g.full_name,class:F(["w-8 h-8 rounded-full object-cover border-2",g.is_manager?"border-orga-500":"border-white dark:border-gray-700"])},null,10,L0)):(d(),u("div",{key:1,class:F(["w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium text-white border-2",[g.is_manager?"bg-orga-600 border-orga-500":"bg-gray-500 border-white dark:border-gray-700"]])},n(Rt(g.full_name)),3)),g.is_manager?(d(),u("div",F0,[...a[77]||(a[77]=[e("i",{class:"fa-solid fa-star text-[6px] text-white"},null,-1)])])):_("",!0)],8,S0))),128))])):(d(),u("p",I0,n(o(t)("No team members")),1))]),e("div",P0,[e("h4",A0,[a[78]||(a[78]=e("i",{class:"fa-solid fa-flag"},null,-1)),R(" "+n(o(t)("Milestones")),1)]),He.value.length>0?(d(),u("div",E0,[(d(!0),u(Q,null,ne(He.value,g=>(d(),u("div",{key:g.name,class:"flex items-center gap-2 text-sm"},[ve(Je,{status:g.status,type:"milestone",size:"sm"},null,8,["status"]),e("span",{class:F([g.status==="Completed"?"text-gray-500 dark:text-gray-500 line-through":"text-gray-800 dark:text-gray-200","truncate flex-1"])},n(g.milestone_name),3),e("span",U0,n(Fe(g.due_date)),1)]))),128))])):(d(),Pe(Ta,{key:1,icon:"fa-flag",title:o(t)("No milestones"),description:o(t)("Add milestones to track key deliverables."),"action-label":o(t)("+ Add Milestone"),onAction:a[30]||(a[30]=g=>Oe.value=!0),size:"sm"},null,8,["title","description","action-label"]))]),e("div",z0,[e("h4",O0,[a[79]||(a[79]=e("i",{class:"fa-solid fa-folder-open"},null,-1)),R(" "+n(o(t)("Documents")),1)]),st.value.totalCount>0?(d(),u("button",{key:0,onClick:ys,class:"w-full text-left text-sm text-gray-700 dark:text-gray-300 hover:text-orga-600 dark:hover:text-orga-400 transition-colors"},[e("span",R0,n(st.value.totalCount===1?o(t)("1 file"):o(t)("{0} files",[st.value.totalCount])),1),Ba.value?(d(),u("span",B0,"("+n(Ba.value)+")",1)):_("",!0),e("i",{class:F(["fa-solid fa-chevron-up text-xs ml-1 transition-transform",Ge.value?"":"rotate-180"])},null,2)])):(d(),u("p",W0,n(o(t)("No documents attached")),1)),e("label",N0,[a[80]||(a[80]=e("i",{class:"fa-solid fa-cloud-arrow-up"},null,-1)),e("span",null,n(o(t)("Upload to project")),1),e("input",{type:"file",class:"hidden",onChange:ms,disabled:Xe.value},null,40,V0)]),Xe.value?(d(),u("div",H0,[e("div",{class:"h-full bg-orga-500 transition-all duration-300",style:oe({width:ht.value+"%"})},null,4)])):_("",!0),Ge.value&&st.value.totalCount>0?(d(),u("div",G0,[st.value.project.length>0?(d(),u("div",q0,[e("h5",K0,[a[81]||(a[81]=e("i",{class:"fa-solid fa-folder text-orga-500 mr-1"},null,-1)),R(" "+n(o(t)("Project Files")),1)]),e("div",J0,[(d(!0),u(Q,null,ne(st.value.project,g=>(d(),u("a",{key:g.name,href:g.file_url,target:"_blank",class:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300 hover:text-orga-600 dark:hover:text-orga-400 group"},[e("i",{class:F(["fa-solid text-xs",Wa(g)])},null,2),e("span",Z0,n(g.file_name),1),e("span",X0,n(Dt(g.file_size)),1)],8,Q0))),128))])])):_("",!0),(d(!0),u(Q,null,ne(st.value.byTask,(g,P)=>(d(),u("div",{key:P,class:"p-3 border-b border-gray-100 dark:border-gray-800 last:border-b-0"},[e("h5",Y0,[a[82]||(a[82]=e("i",{class:"fa-solid fa-check-square text-blue-500 mr-1"},null,-1)),R(" "+n(g.taskSubject),1)]),e("div",ec,[(d(!0),u(Q,null,ne(g.files,ze=>(d(),u("a",{key:ze.name,href:ze.file_url,target:"_blank",class:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300 hover:text-orga-600 dark:hover:text-orga-400 group"},[e("i",{class:F(["fa-solid text-xs",Wa(ze)])},null,2),e("span",ac,n(ze.file_name),1),e("span",sc,n(Dt(ze.file_size)),1)],8,tc))),128))])]))),128))])):_("",!0),Ge.value?(d(),u("div",{key:4,class:"fixed inset-0 z-10",onClick:a[31]||(a[31]=g=>Ge.value=!1)})):_("",!0)])])])):_("",!0),ve(Yl,{"is-open":Ze.value,"project-id":Me.value,"initial-status":ke.value,"auto-trail-default":ca.value,onClose:a[32]||(a[32]=g=>{Ze.value=!1,ke.value="Open"}),onCreated:We},null,8,["is-open","project-id","initial-status","auto-trail-default"]),ve(bn,{"is-open":Oe.value,"project-id":Me.value,onClose:a[33]||(a[33]=g=>Oe.value=!1),onCreated:la},null,8,["is-open","project-id"]),ve(Nn,{"is-open":je.value,"project-name":Me.value,"project-label":y.value.project_name,"task-count":it.value,"milestone-count":He.value.length,onClose:a[34]||(a[34]=g=>je.value=!1),onDeleted:pt},null,8,["is-open","project-name","project-label","task-count","milestone-count"]),ve(yo,{"is-open":Le.value,"project-name":Me.value,"project-label":y.value.project_name,"task-count":it.value,"milestone-count":He.value.length,onClose:a[35]||(a[35]=g=>Le.value=!1),onSaved:a[36]||(a[36]=g=>Le.value=!1)},null,8,["is-open","project-name","project-label","task-count","milestone-count"])],64)):_("",!0)])}}}),dc=Qa(rc,[["__scopeId","data-v-3a15b234"]]);export{dc as default};
