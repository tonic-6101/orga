var R=(l,L,s)=>new Promise((c,w)=>{var S=g=>{try{d(s.next(g))}catch(p){w(p)}},x=g=>{try{d(s.throw(g))}catch(p){w(p)}},d=g=>g.done?c(g.value):Promise.resolve(g.value).then(S,x);d((s=s.apply(l,L)).next())});import{d as oe,_ as a,b as r,c as n,e,i as T,t,u as o,f as J,v as Le,g as re,F as V,r as Q,p as v,n as D,j as je,q as b,s as B,Q as Ve,E as Ae,w as Re,L as Z,h as ae,l as Ee,M as pe,Y as gt,o as xt,Z as yt,$ as kt,a0 as pt,a1 as ft,I as de,k as Me,a2 as bt,a3 as mt,T as vt,x as ht,y as _t,a4 as wt,A as $t}from"./main-BV0KycqK.js";const Ct={class:"dependency-chain"},Tt={class:"flex items-center justify-between mb-3"},St={class:"text-xs font-semibold text-gray-500 uppercase tracking-wide flex items-center gap-2"},Ft={key:0,class:"mb-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 space-y-2"},Dt={class:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400"},jt={class:"truncate font-medium text-gray-700 dark:text-gray-300"},At={class:"text-gray-400"},Bt={value:"FS"},Pt={value:"SS"},Mt={value:"FF"},Lt={value:"SF"},Rt=["placeholder"],It={class:"max-h-36 overflow-y-auto rounded border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900"},Ut=["onClick"],Et={class:"text-sm text-gray-700 dark:text-gray-300 truncate flex-1"},Gt={key:0,class:"text-xs text-gray-400 dark:text-gray-500 text-center py-3"},Nt={key:1,class:"mb-3 px-3 py-2 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-sm text-red-700"},Ot={class:"bg-gray-50 rounded-lg p-3"},Vt={key:0,class:"text-center py-4 text-sm text-gray-400"},zt={key:1,class:"space-y-1"},Kt={key:0,class:"space-y-1"},Ht=["onClick"],Wt={class:"text-[10px] text-gray-400 bg-gray-100 px-1.5 py-0.5 rounded"},qt=["onClick","title"],Qt={key:1,class:"flex items-center justify-center py-1"},Xt={class:"px-2 py-2 bg-orga-50 border border-orga-200 rounded-lg"},Yt={class:"flex items-center gap-2"},Zt={class:"text-sm font-medium text-orga-700 flex-1 truncate"},Jt={class:"text-[10px] text-orga-500 bg-orga-100 px-1.5 py-0.5 rounded"},ea={key:2,class:"flex items-center justify-center py-1"},ta={key:3,class:"space-y-1"},aa=["onClick"],sa={class:"text-[10px] text-gray-400 bg-gray-100 px-1.5 py-0.5 rounded"},ra={class:"mt-3 text-[10px] text-gray-400 flex items-center gap-3"},oa={class:"flex items-center gap-1"},na={class:"flex items-center gap-1"},la=oe({__name:"DependencyChain",props:{taskId:{},taskName:{},dependencies:{},dependents:{},isBlocked:{type:Boolean,default:!1},availableTasks:{default:()=>[]}},emits:["navigate","add","remove","edit"],setup(l,{emit:L}){const s=l,c=L,w=b(!1),S=b("FS"),x=b(""),d=b(""),g=B(()=>{const F=x.value.toLowerCase(),y=new Set(s.dependencies.map(f=>f.task_id));return s.availableTasks.filter(f=>f.name!==s.taskId&&!y.has(f.name)&&(!F||f.subject.toLowerCase().includes(F)))});function p(){d.value&&(c("add",s.taskId,d.value,S.value),d.value="",x.value="",w.value=!1)}function P(){w.value=!1,d.value="",x.value=""}const E={FS:a("Finish-to-Start"),SS:a("Start-to-Start"),FF:a("Finish-to-Finish"),SF:a("Start-to-Finish"),"Finish to Start":"FS","Start to Start":"SS","Finish to Finish":"FF","Start to Finish":"SF"};function N(F){return E[F]||F.split(" ").map(y=>y[0]).join("")}function W(F){switch(F){case"Completed":return"text-green-600";case"In Progress":return"text-blue-600";case"Cancelled":return"text-gray-400";default:return"text-gray-600"}}function I(F){return F==="Completed"}const G=B(()=>s.dependencies.length>0),X=B(()=>s.dependents.length>0);return(F,y)=>(r(),n("div",Ct,[e("div",Tt,[e("h5",St,[y[4]||(y[4]=e("i",{class:"fa-solid fa-link text-orga-500"},null,-1)),T(" "+t(o(a)("Dependencies")),1)]),w.value?(r(),n("button",{key:1,onClick:P,class:"text-xs text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 font-medium transition-colors"},t(o(a)("Cancel")),1)):(r(),n("button",{key:0,onClick:y[0]||(y[0]=f=>{w.value=!0,x.value="",d.value=""}),class:"text-xs text-orga-500 hover:text-orga-600 flex items-center gap-1"},[y[5]||(y[5]=e("i",{class:"fa-solid fa-plus"},null,-1)),T(" "+t(o(a)("Add")),1)]))]),w.value?(r(),n("div",Ft,[e("div",Dt,[y[6]||(y[6]=e("i",{class:"fa-solid fa-circle-dot text-orga-500 text-[10px]"},null,-1)),e("span",jt,t(l.taskName),1),e("span",At,t(o(a)("depends on...")),1)]),J(e("select",{"onUpdate:modelValue":y[1]||(y[1]=f=>S.value=f),class:"w-full px-2 py-1.5 text-xs border border-gray-200 dark:border-gray-700 rounded bg-white dark:bg-gray-900 text-gray-700 dark:text-gray-300"},[e("option",Bt,t(o(a)("FS - Finish-to-Start (default)")),1),e("option",Pt,t(o(a)("SS - Start-to-Start")),1),e("option",Mt,t(o(a)("FF - Finish-to-Finish")),1),e("option",Lt,t(o(a)("SF - Start-to-Finish")),1)],512),[[Le,S.value]]),J(e("input",{"onUpdate:modelValue":y[2]||(y[2]=f=>x.value=f),type:"text",placeholder:o(a)("Search for a task..."),class:"w-full px-2.5 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-900 text-gray-700 dark:text-gray-300 focus:outline-none focus:border-orga-500 focus:ring-1 focus:ring-orga-500"},null,8,Rt),[[re,x.value]]),e("div",It,[(r(!0),n(V,null,Q(g.value.slice(0,10),f=>(r(),n("div",{key:f.name,onClick:M=>{d.value=f.name,p()},class:"flex items-center gap-2 px-2.5 py-2 hover:bg-orga-50 dark:hover:bg-gray-700 cursor-pointer transition-colors border-b border-gray-100 dark:border-gray-700 last:border-b-0"},[y[7]||(y[7]=e("i",{class:"fa-solid fa-plus text-[10px] text-gray-300 dark:text-gray-600"},null,-1)),e("span",Et,t(f.subject),1)],8,Ut))),128)),g.value.length===0?(r(),n("p",Gt,t(x.value?o(a)("No matching tasks found"):o(a)("No tasks available to add")),1)):v("",!0)])])):v("",!0),l.isBlocked?(r(),n("div",Nt,[y[8]||(y[8]=e("i",{class:"fa-solid fa-lock"},null,-1)),e("span",null,t(o(a)("Task is blocked by incomplete dependencies")),1)])):v("",!0),e("div",Ot,[!G.value&&!X.value?(r(),n("div",Vt,[y[9]||(y[9]=e("i",{class:"fa-solid fa-link text-2xl mb-2 opacity-50"},null,-1)),e("p",null,t(o(a)("No dependencies defined")),1),e("button",{onClick:y[3]||(y[3]=f=>{w.value=!0,x.value="",d.value=""}),class:"mt-2 text-orga-500 hover:text-orga-600"},t(o(a)("Add first dependency")),1)])):(r(),n("div",zt,[G.value?(r(),n("div",Kt,[(r(!0),n(V,null,Q(l.dependencies,f=>(r(),n("div",{key:f.task_id,class:"group"},[e("button",{onClick:M=>c("navigate",f.task_id),class:"w-full flex items-center gap-2 px-2 py-1.5 rounded hover:bg-gray-100 transition-colors text-left"},[e("span",{class:D(["w-5 h-5 rounded-full flex items-center justify-center text-xs shrink-0",I(f.status)?"bg-green-100 text-green-600":"bg-gray-200 text-gray-500"])},[e("i",{class:D(["fa-solid",I(f.status)?"fa-check":"fa-circle text-[6px]"])},null,2)],2),e("span",{class:D(["text-sm flex-1 truncate",W(f.status)])},t(f.task_name),3),e("span",Wt,t(N(f.type)),1),e("button",{onClick:je(M=>c("remove",f.task_id),["stop"]),class:"text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",title:o(a)("Remove dependency")},[...y[10]||(y[10]=[e("i",{class:"fa-solid fa-times text-xs"},null,-1)])],8,qt)],8,Ht)]))),128))])):v("",!0),G.value?(r(),n("div",Qt,[...y[11]||(y[11]=[e("div",{class:"flex flex-col items-center text-gray-400"},[e("div",{class:"w-px h-3 bg-gray-300"}),e("i",{class:"fa-solid fa-chevron-down text-[10px]"})],-1)])])):v("",!0),e("div",Xt,[e("div",Yt,[y[12]||(y[12]=e("span",{class:"w-5 h-5 rounded-full bg-orga-500 flex items-center justify-center text-white text-xs shrink-0"},[e("i",{class:"fa-solid fa-circle text-[6px]"})],-1)),e("span",Zt,t(l.taskName),1),e("span",Jt,t(o(a)("Current")),1)])]),X.value?(r(),n("div",ea,[...y[13]||(y[13]=[e("div",{class:"flex flex-col items-center text-gray-400"},[e("i",{class:"fa-solid fa-chevron-down text-[10px]"}),e("div",{class:"w-px h-3 bg-gray-300"})],-1)])])):v("",!0),X.value?(r(),n("div",ta,[(r(!0),n(V,null,Q(l.dependents,f=>(r(),n("div",{key:f.task_id,class:"group"},[e("button",{onClick:M=>c("navigate",f.task_id),class:"w-full flex items-center gap-2 px-2 py-1.5 rounded hover:bg-gray-100 transition-colors text-left"},[e("span",{class:D(["w-5 h-5 rounded-full flex items-center justify-center text-xs shrink-0",I(f.status)?"bg-green-100 text-green-600":"bg-gray-200 text-gray-500"])},[e("i",{class:D(["fa-solid",I(f.status)?"fa-check":"fa-circle text-[6px]"])},null,2)],2),e("span",{class:D(["text-sm flex-1 truncate",W(f.status)])},t(f.task_name),3),e("span",sa,t(o(a)("depends")),1)],8,aa)]))),128))])):v("",!0)]))]),e("div",ra,[e("span",oa,[y[14]||(y[14]=e("i",{class:"fa-solid fa-check text-green-500"},null,-1)),T(" "+t(o(a)("Completed")),1)]),e("span",na,[y[15]||(y[15]=e("i",{class:"fa-solid fa-circle text-[4px] text-gray-400"},null,-1)),T(" "+t(o(a)("Pending")),1)])])]))}}),ia={key:0,class:"cascade-preview bg-gradient-to-r from-yellow-50 to-amber-50 border border-yellow-300 rounded-lg p-3 mb-4"},da={class:"flex items-start gap-2 mb-2"},ua={class:"flex-1"},ca={class:"text-sm font-medium text-yellow-800"},ga={class:"ml-6 space-y-1 mb-3 max-h-32 overflow-y-auto"},xa={class:"text-yellow-900 truncate flex-1"},ya={key:0,class:"ml-6 mb-3 text-xs text-yellow-700"},ka={key:0},pa={key:1,class:"ml-3"},fa={class:"flex items-center justify-end gap-2 mt-2"},ba=["disabled"],ma=["disabled"],va=["disabled"],ha={key:0,class:"fa-solid fa-spinner fa-spin"},_a={key:1,class:"fa-solid fa-check"},wa=oe({__name:"CascadePreview",props:{changes:{},loading:{type:Boolean,default:!1}},emits:["preview","apply","cancel"],setup(l,{emit:L}){const s=l,c=L,w=B(()=>s.changes.length),S=B(()=>s.changes.filter(g=>g.days_shift>0)),x=B(()=>s.changes.filter(g=>g.days_shift<0));function d(g){if(g===0)return a("no change");const p=g>0?"+":"",P=Math.abs(g)===1?a("day"):a("days");return`${p}${g} ${P}`}return(g,p)=>l.changes.length>0?(r(),n("div",ia,[e("div",da,[p[3]||(p[3]=e("i",{class:"fa-solid fa-exclamation-triangle text-yellow-600 mt-0.5"},null,-1)),e("div",ua,[e("h4",ca,t(w.value===1?o(a)("This change will affect {0} dependent task",[w.value]):o(a)("This change will affect {0} dependent tasks",[w.value])),1)])]),e("div",ga,[(r(!0),n(V,null,Q(l.changes,P=>(r(),n("div",{key:P.task_id,class:"flex items-center justify-between text-sm"},[e("span",xa,t(P.task_name),1),e("span",{class:D(["text-xs px-1.5 py-0.5 rounded ml-2 shrink-0",P.days_shift>0?"bg-yellow-200 text-yellow-800":"bg-green-200 text-green-800"])},t(d(P.days_shift)),3)]))),128))]),l.changes.length>5?(r(),n("div",ya,[S.value.length>0?(r(),n("span",ka,[p[4]||(p[4]=e("i",{class:"fa-solid fa-arrow-right"},null,-1)),T(" "+t(S.value.length===1?o(a)("{0} task will be delayed",[S.value.length]):o(a)("{0} tasks will be delayed",[S.value.length])),1)])):v("",!0),x.value.length>0?(r(),n("span",pa,[p[5]||(p[5]=e("i",{class:"fa-solid fa-arrow-left"},null,-1)),T(" "+t(x.value.length===1?o(a)("{0} task will move earlier",[x.value.length]):o(a)("{0} tasks will move earlier",[x.value.length])),1)])):v("",!0)])):v("",!0),e("div",fa,[e("button",{onClick:p[0]||(p[0]=P=>c("cancel")),disabled:l.loading,class:"px-3 py-1.5 text-sm text-gray-600 hover:text-gray-800 disabled:opacity-50"},t(o(a)("Cancel")),9,ba),e("button",{onClick:p[1]||(p[1]=P=>c("preview")),disabled:l.loading,class:"px-3 py-1.5 text-sm text-yellow-700 bg-yellow-100 hover:bg-yellow-200 rounded disabled:opacity-50"},[p[6]||(p[6]=e("i",{class:"fa-solid fa-eye mr-1"},null,-1)),T(" "+t(o(a)("Preview")),1)],8,ma),e("button",{onClick:p[2]||(p[2]=P=>c("apply")),disabled:l.loading,class:"px-3 py-1.5 text-sm text-white bg-yellow-600 hover:bg-yellow-700 rounded disabled:opacity-50 flex items-center gap-1"},[l.loading?(r(),n("i",ha)):(r(),n("i",_a)),T(" "+t(o(a)("Apply Changes")),1)],8,va)])])):v("",!0)}}),$a={class:"budget-burn-rate"},Ca={key:0,class:"space-y-1.5 mb-2"},Ta={class:"flex justify-between text-sm"},Sa={class:"text-gray-500"},Fa={class:"font-medium text-gray-800"},Da={class:"flex justify-between text-sm"},ja={class:"text-gray-500"},Aa={class:"font-medium text-gray-800"},Ba={class:"flex justify-between text-sm"},Pa={class:"text-gray-500"},Ma={class:"mt-2"},La={class:"flex items-center justify-between mb-1"},Ra={class:"text-xs text-gray-500"},Ia={key:1,class:"mt-2 flex items-center gap-1 text-xs text-red-600"},Ua={key:2,class:"mt-2 flex items-center gap-1 text-xs text-yellow-600"},Ea=oe({__name:"BudgetBurnRate",props:{budget:{},spent:{},showLabels:{type:Boolean,default:!0},size:{default:"md"}},setup(l){const L=l,{formatCurrency:s}=Ve(),c=B(()=>!L.budget||L.budget<=0?0:Math.min(100,Math.round(L.spent/L.budget*100))),w=B(()=>Math.max(0,L.budget-L.spent)),S=B(()=>c.value<=80?"bg-green-500":c.value<=95?"bg-yellow-500":"bg-red-500"),x=B(()=>c.value<=80?"text-green-600":c.value<=95?"text-yellow-600":"text-red-600"),d=B(()=>{switch(L.size){case"sm":return"h-1.5";case"lg":return"h-3";default:return"h-2"}});return(g,p)=>(r(),n("div",$a,[l.showLabels?(r(),n("div",Ca,[e("div",Ta,[e("span",Sa,t(g.__("Budget")),1),e("span",Fa,t(o(s)(l.budget)),1)]),e("div",Da,[e("span",ja,t(g.__("Spent")),1),e("span",Aa,t(o(s)(l.spent)),1)]),e("div",Ba,[e("span",Pa,t(g.__("Remaining")),1),e("span",{class:D(["font-medium",w.value>0?"text-green-600":"text-red-600"])},t(o(s)(w.value)),3)])])):v("",!0),e("div",Ma,[e("div",La,[e("span",Ra,t(g.__("Burn Rate")),1),e("span",{class:D(["text-xs font-medium",x.value])},t(c.value)+"%",3)]),e("div",{class:D(["w-full bg-gray-200 rounded-full overflow-hidden",d.value])},[e("div",{class:D(["h-full rounded-full transition-all duration-300",S.value]),style:Ae({width:c.value+"%"})},null,6)],2)]),c.value>95?(r(),n("div",Ia,[p[0]||(p[0]=e("i",{class:"fa-solid fa-exclamation-triangle"},null,-1)),e("span",null,t(g.__("Budget at risk")),1)])):c.value>80?(r(),n("div",Ua,[p[1]||(p[1]=e("i",{class:"fa-solid fa-exclamation-circle"},null,-1)),e("span",null,t(g.__("Watch budget closely")),1)])):v("",!0)]))}}),Ga={class:"space-y-4"},Na={class:"flex items-center gap-2 flex-wrap"},Oa={class:"text-[10px] font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider"},Va=["value"],za={value:""},Ka={value:"Task"},Ha={value:"Bug"},Wa={value:"Feature"},qa={value:"Research"},Qa={value:"Meeting"},Xa={class:"text-[10px] font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider"},Ya={key:0,class:"mt-1"},Za=["title"],Ja={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},es={class:"text-[10px] font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider"},ts={key:0,class:"mt-1"},as=["placeholder"],ss={class:"flex justify-end gap-2 mt-1.5"},rs=["disabled"],os={key:0,class:"fa-solid fa-spinner fa-spin"},ns=["title"],ls={key:0,class:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap m-0 group-hover:text-orga-600 dark:group-hover:text-orga-400 transition-colors"},is={key:1,class:"text-sm text-gray-400 dark:text-gray-500 m-0 italic group-hover:text-orga-500 dark:group-hover:text-orga-400 transition-colors"},ds={class:"relative"},us={class:"text-[10px] font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider"},cs={key:0,class:"mt-1 relative"},gs={id:"task-group-suggestions"},xs=["value"],ys={key:0,class:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium rounded-full bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 group-hover:bg-indigo-200 dark:group-hover:bg-indigo-900/50 transition-colors"},ks={key:1,class:"text-sm text-gray-400 dark:text-gray-500 italic group-hover:text-orga-500 dark:group-hover:text-orga-400 transition-colors"},ps=["title"],fs={class:"relative"},bs={class:"text-[10px] font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider"},ms={key:0,class:"mt-1 relative"},vs={id:"depends-on-group-suggestions"},hs=["value"],_s={key:0,class:"inline-flex items-center gap-1 px-2 py-0.5 text-xs font-medium rounded-full bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300 group-hover:bg-amber-200 dark:group-hover:bg-amber-900/50 transition-colors"},ws={key:1,class:"text-sm text-gray-400 dark:text-gray-500 italic group-hover:text-orga-500 dark:group-hover:text-orga-400 transition-colors"},$s=["title"],Cs={class:"relative"},Ts={class:"text-[10px] font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider"},Ss=["title"],Fs={class:"text-sm text-gray-800 dark:text-gray-200 flex-1"},Ds={class:"text-sm text-gray-800 dark:text-gray-200 flex-1"},js={key:2,class:"text-sm text-gray-400 dark:text-gray-500 flex-1"},As={key:0,class:"absolute left-0 right-0 mt-1 z-30 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg max-h-60 overflow-y-auto"},Bs=["onClick"],Ps={class:"flex-1 text-left min-w-0"},Ms={class:"block truncate"},Ls={class:"text-[10px] text-gray-400 dark:text-gray-500"},Rs={key:0,class:"fa-solid fa-check text-xs text-orga-500"},Is={key:1,class:"text-xs text-gray-400 dark:text-gray-500 text-center py-3"},Us={class:"grid grid-cols-2 gap-4"},Es={class:"text-[10px] font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider"},Gs={class:"mt-1 relative"},Ns=["value"],Os=["title"],Vs={class:"text-[10px] font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider"},zs={class:"mt-1 relative"},Ks=["value"],Hs=["title"],Ws=["checked"],qs={class:"text-xs text-gray-600 dark:text-gray-400 leading-tight"},Qs={class:"text-gray-400 dark:text-gray-500"},Xs={class:"grid grid-cols-2 gap-4"},Ys={key:0},Zs={class:"text-[10px] font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider"},Js={class:"text-sm text-gray-800 dark:text-gray-200 mt-1"},er={key:1},tr={class:"text-[10px] font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider"},ar={class:"text-sm text-gray-800 dark:text-gray-200 mt-1"},sr={class:"text-[10px] font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider"},rr={class:"flex items-center gap-3 mt-1"},or={class:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},nr={class:"text-sm font-medium text-gray-800 dark:text-gray-200 w-10 text-right"},lr={class:"mt-3 space-y-3"},ir={class:"flex items-center gap-3"},dr=["value","disabled"],ur=["value","disabled"],cr={class:"flex items-center gap-2"},gr=["onClick","disabled"],xr={key:0,class:"ml-2 text-xs text-gray-400"},yr={key:0,class:"text-xs text-gray-400 dark:text-gray-500"},kr={key:1},pr={class:"text-[10px] font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider"},fr={class:"text-sm text-gray-800 dark:text-gray-200 mt-1"},br=oe({__name:"TaskDetailsTab",props:{task:{},contacts:{default:()=>[]},availableGroups:{default:()=>[]}},emits:["date-change","progress-change","description-change","subject-change","assign-contact","task-group-change","depends-on-group-change","task-type-change","auto-trail-change"],setup(l,{emit:L}){var ve;const s=l,c=L;function w(h){h!==(s.task.task_type||"")&&c("task-type-change",h)}const S=b(!1),x=b(""),d=b(null),g=b(!1);function p(){x.value=s.task.subject||"",S.value=!0,pe(()=>{var h;return(h=d.value)==null?void 0:h.focus()})}function P(){S.value=!1}function E(){if(g.value)return;const h=x.value.trim();if(!h||h===s.task.subject){S.value=!1;return}g.value=!0,S.value=!1,c("subject-change",h),pe(()=>{g.value=!1})}const N=b(!1),W=b(""),I=b(null);function G(){W.value=s.task.task_group||"",N.value=!0,pe(()=>{var h;return(h=I.value)==null?void 0:h.focus()})}function X(){N.value=!1}function F(){const h=W.value.trim();N.value=!1,h!==(s.task.task_group||"")&&c("task-group-change",h)}function y(){c("task-group-change","")}const f=b(!1),M=b(""),$=b(null);function _(){M.value=s.task.depends_on_group||"",f.value=!0,pe(()=>{var h;return(h=$.value)==null?void 0:h.focus()})}function O(){f.value=!1}function Y(){const h=M.value.trim();f.value=!1,h!==(s.task.depends_on_group||"")&&c("depends-on-group-change",h)}function ye(){c("depends-on-group-change","")}const A=b(!1),C=B(()=>{const h=s.task;if(h.assigned_resource){const k=s.contacts.find(m=>m.name===h.assigned_resource);if(k)return k}return s.task.assigned_to&&s.contacts.find(k=>k.user===s.task.assigned_to)||null});function H(h){var m;A.value=!1;const k=((m=C.value)==null?void 0:m.name)||null;h!==k&&c("assign-contact",h)}function ue(h,k){c("date-change",h,k)}function _e(h){c("auto-trail-change",h)}const ce=b(!1),ie=b(""),se=b(!1);function ge(){ie.value=s.task.description||"",ce.value=!0}function we(){ce.value=!1}function $e(){se.value||(se.value=!0,c("description-change",ie.value),ce.value=!1,setTimeout(()=>{se.value=!1},500))}const Ce=[0,25,50,75,100],z=b((ve=s.task.progress)!=null?ve:0),ke=b(!1),ee=b(null);let K=null;Re(()=>s.task.progress,h=>{K||(z.value=h!=null?h:0)},{immediate:!0}),Re(()=>s.task.name,()=>{var h;z.value=(h=s.task.progress)!=null?h:0,ee.value=null,K&&(clearTimeout(K),K=null)});const ne=B(()=>s.task.status==="Completed"||s.task.status==="Cancelled"),Te=B(()=>s.task.status==="Completed"?a("Task is completed"):s.task.status==="Cancelled"?a("Task is cancelled"):""),fe=B(()=>z.value===100?"bg-green-500":z.value>=75?"bg-orga-500":z.value>=50?"bg-yellow-500":z.value>=25?"bg-orange-500":"bg-gray-400");function le(h){const k=Math.max(0,Math.min(100,Math.round(h)));z.value=k,ee.value=k,K&&clearTimeout(K),K=setTimeout(()=>{Se()},400)}function Ie(h){const k=parseInt(h,10);if(isNaN(k))return;const m=Math.max(0,Math.min(100,k));z.value=m,ee.value=m}function Be(h){ne.value||(z.value=h,ee.value=h,K&&(clearTimeout(K),K=null),Se())}function be(){K&&(clearTimeout(K),K=null),Se()}function Se(){if(ee.value!==null){if(ee.value===s.task.progress){ee.value=null;return}ke.value=!0,c("progress-change",ee.value),ee.value=null,setTimeout(()=>{ke.value=!1},500)}}const Ue={Urgent:"bg-red-100 text-red-700 border-red-200 dark:bg-red-900/30 dark:text-red-400 dark:border-red-800",High:"bg-orange-100 text-orange-700 border-orange-200 dark:bg-orange-900/30 dark:text-orange-400 dark:border-orange-800",Medium:"bg-yellow-100 text-yellow-700 border-yellow-200 dark:bg-yellow-900/30 dark:text-yellow-400 dark:border-yellow-800",Low:"bg-gray-100 text-gray-600 border-gray-200 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-700"},Pe={Open:"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400","In Progress":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",Review:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",Completed:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",Cancelled:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"},xe={Task:"bg-blue-100 text-blue-700 border-blue-200 dark:bg-blue-900/30 dark:text-blue-400 dark:border-blue-800",Bug:"bg-red-100 text-red-700 border-red-200 dark:bg-red-900/30 dark:text-red-400 dark:border-red-800",Feature:"bg-purple-100 text-purple-700 border-purple-200 dark:bg-purple-900/30 dark:text-purple-400 dark:border-purple-800",Research:"bg-cyan-100 text-cyan-700 border-cyan-200 dark:bg-cyan-900/30 dark:text-cyan-400 dark:border-cyan-800",Meeting:"bg-teal-100 text-teal-700 border-teal-200 dark:bg-teal-900/30 dark:text-teal-400 dark:border-teal-800",default:"bg-gray-100 text-gray-600 border-gray-200 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-700"},me={Task:"fa-solid fa-check-circle",Bug:"fa-solid fa-bug",Feature:"fa-solid fa-star",Research:"fa-solid fa-flask",Meeting:"fa-solid fa-users"};return(h,k)=>(r(),n("div",Ga,[e("div",Na,[e("span",{class:D(["px-2 py-1 text-xs rounded-full border",Ue[l.task.priority]])},[k[14]||(k[14]=e("i",{class:"fa-solid fa-flag mr-1"},null,-1)),T(" "+t(l.task.priority),1)],2),e("span",{class:D(["px-2 py-1 text-xs rounded-full",Pe[l.task.status]])},t(l.task.status),3),l.task.task_type?(r(),n("span",{key:0,class:D(["px-2 py-1 text-xs rounded-full border",xe[l.task.task_type]||xe.default])},[e("i",{class:D(["mr-1",me[l.task.task_type]||"fa-solid fa-circle"])},null,2),T(" "+t(l.task.task_type),1)],2)):v("",!0)]),e("div",null,[e("label",Oa,t(o(a)("Task Type")),1),e("select",{value:l.task.task_type||"",onChange:k[0]||(k[0]=m=>w(m.target.value)),class:"w-full mt-1 px-2 py-1.5 text-sm border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 focus:outline-none focus:border-orga-500 dark:focus:border-orga-400 focus:ring-1 focus:ring-orga-500 dark:focus:ring-orga-400 cursor-pointer"},[e("option",za,t(o(a)("None")),1),e("option",Ka,t(o(a)("Task")),1),e("option",Ha,t(o(a)("Bug")),1),e("option",Wa,t(o(a)("Feature")),1),e("option",qa,t(o(a)("Research")),1),e("option",Qa,t(o(a)("Meeting")),1)],40,Va)]),e("div",null,[e("label",Xa,t(o(a)("Subject")),1),S.value?(r(),n("div",Ya,[J(e("input",{ref_key:"subjectInputRef",ref:d,"onUpdate:modelValue":k[1]||(k[1]=m=>x.value=m),type:"text",class:"w-full px-2 py-1.5 text-sm font-medium border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 focus:outline-none focus:border-orga-500 dark:focus:border-orga-400 focus:ring-1 focus:ring-orga-500 dark:focus:ring-orga-400",onKeydown:[Z(E,["enter"]),Z(P,["escape"])],onBlur:E},null,544),[[re,x.value]])])):(r(),n("p",{key:1,onClick:p,class:"text-sm text-gray-800 dark:text-gray-200 mt-1 font-medium cursor-text hover:text-orga-600 dark:hover:text-orga-400 transition-colors",title:o(a)("Click to edit")},t(l.task.subject),9,Za)),e("p",Ja,t(l.task.name),1)]),e("div",null,[e("label",es,t(o(a)("Description")),1),ce.value?(r(),n("div",ts,[J(e("textarea",{"onUpdate:modelValue":k[2]||(k[2]=m=>ie.value=m),rows:"3",class:"w-full px-2 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 focus:outline-none focus:border-orga-500 dark:focus:border-orga-400 focus:ring-1 focus:ring-orga-500 dark:focus:ring-orga-400 resize-y",placeholder:o(a)("Add a task description..."),onKeydown:Z(we,["escape"])},null,40,as),[[re,ie.value]]),e("div",ss,[e("button",{onClick:we,class:"px-2 py-1 text-xs font-medium text-gray-600 dark:text-gray-400 bg-gray-100 dark:bg-gray-700 rounded hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"},t(o(a)("Cancel")),1),e("button",{onClick:$e,disabled:se.value,class:"px-2 py-1 text-xs font-medium text-white bg-orga-500 rounded hover:bg-orga-600 transition-colors disabled:opacity-50 flex items-center gap-1"},[se.value?(r(),n("i",os)):v("",!0),T(" "+t(se.value?o(a)("Saving..."):o(a)("Save")),1)],8,rs)])])):(r(),n("div",{key:1,onClick:ge,class:"mt-1 cursor-pointer group",title:o(a)("Click to edit description")},[l.task.description?(r(),n("p",ls,t(l.task.description),1)):(r(),n("p",is,t(o(a)("Click to add description...")),1))],8,ns))]),e("div",ds,[e("label",us,t(o(a)("Task Group")),1),N.value?(r(),n("div",cs,[J(e("input",{ref_key:"groupInputRef",ref:I,"onUpdate:modelValue":k[3]||(k[3]=m=>W.value=m),type:"text",list:"task-group-suggestions",placeholder:"e.g. Pre-work, Finishing...",class:"w-full px-2 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 focus:outline-none focus:border-orga-500 dark:focus:border-orga-400 focus:ring-1 focus:ring-orga-500 dark:focus:ring-orga-400",onKeydown:[Z(F,["enter"]),Z(X,["escape"])],onBlur:F},null,544),[[re,W.value]]),e("datalist",gs,[(r(!0),n(V,null,Q(l.availableGroups,m=>(r(),n("option",{key:m,value:m},null,8,xs))),128))])])):(r(),n("div",{key:1,onClick:G,class:"mt-1 cursor-pointer group flex items-center gap-1.5"},[l.task.task_group?(r(),n("span",ys,[k[15]||(k[15]=e("i",{class:"fa-solid fa-layer-group text-[9px]"},null,-1)),T(" "+t(l.task.task_group),1)])):(r(),n("span",ks,t(o(a)("Click to set group...")),1)),l.task.task_group?(r(),n("button",{key:2,onClick:je(y,["stop"]),class:"text-gray-400 hover:text-red-500 dark:hover:text-red-400 transition-colors opacity-0 group-hover:opacity-100",title:o(a)("Remove from group")},[...k[16]||(k[16]=[e("i",{class:"fa-solid fa-xmark text-[10px]"},null,-1)])],8,ps)):v("",!0)]))]),e("div",fs,[e("label",bs,t(o(a)("Depends on Group")),1),f.value?(r(),n("div",ms,[J(e("input",{ref_key:"dependsOnGroupInputRef",ref:$,"onUpdate:modelValue":k[4]||(k[4]=m=>M.value=m),type:"text",list:"depends-on-group-suggestions",placeholder:"e.g. Pre-work — blocks until all complete",class:"w-full px-2 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 focus:outline-none focus:border-orga-500 dark:focus:border-orga-400 focus:ring-1 focus:ring-orga-500 dark:focus:ring-orga-400",onKeydown:[Z(Y,["enter"]),Z(O,["escape"])],onBlur:Y},null,544),[[re,M.value]]),e("datalist",vs,[(r(!0),n(V,null,Q(l.availableGroups,m=>(r(),n("option",{key:m,value:m},null,8,hs))),128))])])):(r(),n("div",{key:1,onClick:_,class:"mt-1 cursor-pointer group flex items-center gap-1.5"},[l.task.depends_on_group?(r(),n("span",_s,[k[17]||(k[17]=e("i",{class:"fa-solid fa-lock text-[9px]"},null,-1)),T(" "+t(o(a)("Waits for:"))+" "+t(l.task.depends_on_group),1)])):(r(),n("span",ws,t(o(a)("Click to set group dependency...")),1)),l.task.depends_on_group?(r(),n("button",{key:2,onClick:je(ye,["stop"]),class:"text-gray-400 hover:text-red-500 dark:hover:text-red-400 transition-colors opacity-0 group-hover:opacity-100",title:o(a)("Remove group dependency")},[...k[18]||(k[18]=[e("i",{class:"fa-solid fa-xmark text-[10px]"},null,-1)])],8,$s)):v("",!0)]))]),e("div",Cs,[e("label",Ts,t(o(a)("Assigned Contact")),1),e("button",{onClick:k[5]||(k[5]=m=>A.value=!A.value),class:"w-full flex items-center gap-2 mt-1 px-2 py-1.5 rounded-lg border border-transparent hover:border-gray-200 dark:hover:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors text-left",title:o(a)("Click to assign contact")},[C.value?(r(),n(V,{key:0},[ae(Ee,{name:C.value.resource_name,size:"xs",color:"orga"},null,8,["name"]),e("span",Fs,t(C.value.resource_name),1)],64)):l.task.assigned_to_name?(r(),n(V,{key:1},[ae(Ee,{name:l.task.assigned_to_name,image:l.task.assigned_to_image,size:"xs",color:"orga"},null,8,["name","image"]),e("span",Ds,t(l.task.assigned_to_name),1)],64)):(r(),n("span",js,t(o(a)("Unassigned")),1)),k[19]||(k[19]=e("i",{class:"fa-solid fa-chevron-down text-[10px] text-gray-400"},null,-1))],8,Ss),A.value?(r(),n("div",As,[C.value||l.task.assigned_to?(r(),n("button",{key:0,onClick:k[6]||(k[6]=m=>H(null)),class:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors border-b border-gray-100 dark:border-gray-700"},[k[20]||(k[20]=e("i",{class:"fa-solid fa-user-slash text-xs text-gray-400 w-5 text-center"},null,-1)),e("span",null,t(o(a)("Unassign")),1)])):v("",!0),(r(!0),n(V,null,Q(l.contacts,m=>{var Fe,De;return r(),n("button",{key:m.name,onClick:Ge=>H(m.name),class:D(["w-full flex items-center gap-2 px-3 py-2 text-sm transition-colors",((Fe=C.value)==null?void 0:Fe.name)===m.name?"bg-orga-50 dark:bg-orga-900/20 text-orga-700 dark:text-orga-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"])},[ae(Ee,{name:m.resource_name,size:"xs",color:"orga"},null,8,["name"]),e("div",Ps,[e("span",Ms,t(m.resource_name),1),e("span",Ls,t(m.department||m.status),1)]),((De=C.value)==null?void 0:De.name)===m.name?(r(),n("i",Rs)):v("",!0)],10,Bs)}),128)),l.contacts.length?v("",!0):(r(),n("p",Is,t(o(a)("No contacts available")),1))])):v("",!0)]),e("div",Us,[e("div",null,[e("label",Es,t(o(a)("Start Date")),1),e("div",Gs,[e("input",{type:"date",value:l.task.start_date||"",onChange:k[7]||(k[7]=m=>ue("start_date",m.target.value)),class:"w-full px-2 py-1.5 text-sm text-gray-800 dark:text-gray-200 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-orga-500 focus:border-orga-500 transition-colors"},null,40,Ns),l.task.start_date?(r(),n("button",{key:0,onClick:k[8]||(k[8]=m=>ue("start_date","")),class:"absolute right-8 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",title:o(a)("Clear date")},[...k[21]||(k[21]=[e("i",{class:"fa-solid fa-xmark text-xs"},null,-1)])],8,Os)):v("",!0)])]),e("div",null,[e("label",Vs,t(o(a)("Due Date")),1),e("div",zs,[e("input",{type:"date",value:l.task.due_date||"",onChange:k[9]||(k[9]=m=>ue("due_date",m.target.value)),class:"w-full px-2 py-1.5 text-sm text-gray-800 dark:text-gray-200 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-orga-500 focus:border-orga-500 transition-colors"},null,40,Ks),l.task.due_date?(r(),n("button",{key:0,onClick:k[10]||(k[10]=m=>ue("due_date","")),class:"absolute right-8 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",title:o(a)("Clear date")},[...k[22]||(k[22]=[e("i",{class:"fa-solid fa-xmark text-xs"},null,-1)])],8,Hs)):v("",!0)])])]),l.task.start_date?(r(),n("label",{key:0,class:D(["flex items-center gap-2.5 px-3 py-2 rounded-lg cursor-pointer transition-colors",l.task.auto_trail_start?"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800":"bg-gray-50 dark:bg-gray-800/50 border border-gray-100 dark:border-gray-700"])},[e("input",{type:"checkbox",checked:!!l.task.auto_trail_start,onChange:k[11]||(k[11]=m=>_e(m.target.checked)),class:"w-3.5 h-3.5 rounded accent-blue-500 cursor-pointer flex-shrink-0"},null,40,Ws),e("span",qs,[T(t(o(a)("Auto-Trail Start"))+" ",1),e("span",Qs," — "+t(o(a)("trails to today while Open at 0%")),1)])],2)):v("",!0),e("div",Xs,[l.task.estimated_hours?(r(),n("div",Ys,[e("label",Zs,t(o(a)("Estimated")),1),e("p",Js,t(l.task.estimated_hours)+"h",1)])):v("",!0),l.task.actual_hours?(r(),n("div",er,[e("label",tr,t(o(a)("Actual")),1),e("p",ar,t(l.task.actual_hours)+"h",1)])):v("",!0)]),e("div",null,[e("label",sr,t(o(a)("Progress")),1),e("div",rr,[e("div",or,[e("div",{class:D(["h-full transition-all duration-150",fe.value]),style:Ae({width:z.value+"%"})},null,6)]),e("span",nr,t(z.value)+"%",1)]),e("div",lr,[e("div",ir,[e("input",{type:"range",min:"0",max:"100",step:"1",value:z.value,onInput:k[12]||(k[12]=m=>le(m.target.valueAsNumber)),onChange:be,disabled:ne.value,class:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-orga-500 disabled:opacity-50 disabled:cursor-not-allowed"},null,40,dr),e("input",{type:"number",min:"0",max:"100",step:"1",value:z.value,onInput:k[13]||(k[13]=m=>Ie(m.target.value)),onBlur:be,onKeydown:Z(be,["enter"]),disabled:ne.value,class:"w-16 px-2 py-1 text-sm text-center text-gray-800 dark:text-gray-200 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-orga-500 focus:border-orga-500 disabled:opacity-50 disabled:cursor-not-allowed"},null,40,ur)]),e("div",cr,[(r(),n(V,null,Q(Ce,m=>e("button",{key:m,onClick:Fe=>Be(m),disabled:ne.value,class:D(["px-2 py-1 text-xs font-medium rounded-md transition-colors",z.value===m?"bg-orga-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700","disabled:opacity-50 disabled:cursor-not-allowed"])},t(m)+"% ",11,gr)),64)),ke.value?(r(),n("span",xr,[k[23]||(k[23]=e("i",{class:"fa-solid fa-spinner fa-spin mr-1"},null,-1)),T(t(o(a)("Saving...")),1)])):v("",!0)]),ne.value?(r(),n("p",yr,[k[24]||(k[24]=e("i",{class:"fa-solid fa-info-circle mr-1"},null,-1)),T(" "+t(Te.value),1)])):v("",!0)])]),l.task.project?(r(),n("div",kr,[e("label",pr,t(o(a)("Project")),1),e("p",fr,t(l.task.project_name||l.task.project),1)])):v("",!0)]))}}),mr={class:"flex flex-col h-full"},vr={key:0,class:"text-center py-8"},hr={class:"text-sm text-gray-400 dark:text-gray-500 mt-2"},_r={class:"mb-6"},wr={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3 flex items-center gap-2"},$r={key:0,class:"space-y-2"},Cr={key:0,class:"p-2.5 bg-red-50 dark:bg-red-900/20 flex items-center gap-2 text-xs"},Tr={class:"text-red-600 dark:text-red-400 flex-1"},Sr=["onClick"],Fr={key:1,class:"p-2.5 space-y-2 border border-orga-300 dark:border-orga-700 rounded-lg"},Dr={class:"text-xs text-gray-600 dark:text-gray-300 truncate font-medium"},jr={class:"flex items-center gap-2"},Ar={value:"FS"},Br={value:"SS"},Pr={value:"FF"},Mr={value:"SF"},Lr={class:"flex items-center gap-1"},Rr={class:"text-[10px] text-gray-400 whitespace-nowrap"},Ir={class:"flex items-center gap-1.5 justify-end pt-1"},Ur=["onClick","disabled"],Er={key:0,class:"fa-solid fa-spinner fa-spin mr-1"},Gr={key:2,class:"flex items-center gap-2 p-2"},Nr={class:"flex-1 min-w-0"},Or={class:"text-sm text-gray-800 dark:text-gray-200 truncate"},Vr={class:"text-[10px] text-gray-400 dark:text-gray-500"},zr={key:0,class:"ml-1 text-orga-500"},Kr={key:0,class:"flex items-center gap-0.5 shrink-0"},Hr=["onClick","title"],Wr=["onClick","title"],qr={key:1,class:"text-sm text-gray-400 dark:text-gray-500 text-center py-4"},Qr={class:"mb-6"},Xr={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3 flex items-center gap-2"},Yr={key:0,class:"space-y-2"},Zr={class:"flex-1 min-w-0"},Jr={class:"text-sm text-gray-800 dark:text-gray-200 truncate"},eo={class:"text-[10px] text-gray-400 dark:text-gray-500"},to={key:0,class:"ml-1 text-orga-500"},ao={key:1,class:"text-sm text-gray-400 dark:text-gray-500 text-center py-4"},so={key:0,class:"mt-auto pt-4 border-t border-gray-200 dark:border-gray-700"},ro={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3"},oo={class:"flex gap-2"},no={value:"FS"},lo={value:"SS"},io={value:"FF"},uo={value:"SF"},co={value:""},go=["value"],xo=["disabled"],yo=oe({__name:"TaskDependenciesTab",props:{task:{},predecessors:{},successors:{},availableTasks:{},isLoading:{type:Boolean},readonly:{type:Boolean,default:!1}},emits:["add-dependency","update-dependency","remove-dependency"],setup(l,{emit:L}){const s=l,c=L,w=b("FS"),S=b(""),x=b(!1),d=b(null),g=b("FS"),p=b(0),P=b(!1),E=b(null);function N(M){d.value=M.name,g.value=M.dependency_type||"FS",p.value=M.lag_days||0,E.value=null}function W(){d.value=null}function I(M){P.value=!0,c("update-dependency",M,g.value,p.value),d.value=null,P.value=!1}function G(M){E.value=null,c("remove-dependency",M)}function X(){S.value&&(c("add-dependency",s.task.name,S.value,w.value),S.value="")}function F(M){return{FS:a("Must finish before this starts"),SS:a("Must start before this starts"),FF:a("Must finish before this finishes"),SF:a("Must start before this finishes")}[M||"FS"]}function y(M){return{FS:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",SS:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",FF:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400",SF:"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400"}[M||"FS"]}function f(M){const $={Open:"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400","In Progress":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",Review:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",Completed:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",Cancelled:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"};return $[M||"Open"]||$.Open}return(M,$)=>(r(),n("div",mr,[l.isLoading?(r(),n("div",vr,[$[5]||($[5]=e("i",{class:"fa-solid fa-spinner fa-spin text-gray-400 dark:text-gray-500 text-xl"},null,-1)),e("p",hr,t(o(a)("Loading dependencies...")),1)])):(r(),n(V,{key:1},[e("div",_r,[e("h5",wr,[$[6]||($[6]=e("i",{class:"fa-solid fa-arrow-left text-orga-500"},null,-1)),T(" "+t(o(a)("Predecessors (Blocked By)")),1)]),l.predecessors.length?(r(),n("div",$r,[(r(!0),n(V,null,Q(l.predecessors,_=>(r(),n("div",{key:_.name,class:"bg-gray-50 dark:bg-gray-800 rounded-lg overflow-hidden"},[E.value===_.name?(r(),n("div",Cr,[$[8]||($[8]=e("i",{class:"fa-solid fa-triangle-exclamation text-red-500"},null,-1)),e("span",Tr,[T(t(o(a)("Remove dependency on"))+" ",1),e("strong",null,t(_.depends_on_subject||_.depends_on),1),$[7]||($[7]=T("?",-1))]),e("button",{onClick:$[0]||($[0]=O=>E.value=null),class:"px-2.5 py-1 text-gray-600 dark:text-gray-300 rounded border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},t(o(a)("Cancel")),1),e("button",{onClick:O=>G(_.name),class:"px-2.5 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition-colors"},t(o(a)("Remove")),9,Sr)])):d.value===_.name?(r(),n("div",Fr,[e("p",Dr,[$[9]||($[9]=e("i",{class:"fa-solid fa-pen text-orga-500 mr-1"},null,-1)),T(" "+t(_.depends_on_subject||_.depends_on),1)]),e("div",jr,[J(e("select",{"onUpdate:modelValue":$[1]||($[1]=O=>g.value=O),class:"px-2 py-1.5 text-xs border border-gray-200 dark:border-gray-700 rounded bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 flex-1"},[e("option",Ar,t(o(a)("FS (Finish-Start)")),1),e("option",Br,t(o(a)("SS (Start-Start)")),1),e("option",Pr,t(o(a)("FF (Finish-Finish)")),1),e("option",Mr,t(o(a)("SF (Start-Finish)")),1)],512),[[Le,g.value]]),e("div",Lr,[J(e("input",{"onUpdate:modelValue":$[2]||($[2]=O=>p.value=O),type:"number",min:"0",class:"w-14 px-2 py-1.5 text-xs border border-gray-200 dark:border-gray-700 rounded bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 text-center",placeholder:"0"},null,512),[[re,p.value,void 0,{number:!0}]]),e("span",Rr,t(o(a)("d lag")),1)])]),e("div",Ir,[e("button",{onClick:W,class:"px-2.5 py-1 text-xs text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},t(o(a)("Cancel")),1),e("button",{onClick:O=>I(_.name),disabled:P.value,class:"px-2.5 py-1 text-xs bg-orga-500 text-white rounded hover:bg-orga-600 disabled:opacity-50 transition-colors"},[P.value?(r(),n("i",Er)):v("",!0),T(" "+t(o(a)("Save")),1)],8,Ur)])])):(r(),n("div",Gr,[e("span",{class:D(["px-1.5 py-0.5 text-[10px] font-mono rounded shrink-0",y(_.dependency_type)])},t(_.dependency_type||"FS"),3),e("div",Nr,[e("p",Or,t(_.depends_on_subject||_.depends_on),1),e("p",Vr,[T(t(F(_.dependency_type))+" ",1),_.lag_days?(r(),n("span",zr,"+"+t(_.lag_days)+"d lag",1)):v("",!0)])]),e("span",{class:D(["text-[10px] px-1.5 py-0.5 rounded shrink-0",f(_.depends_on_status)])},t(_.depends_on_status),3),l.readonly?v("",!0):(r(),n("div",Kr,[e("button",{onClick:je(O=>N(_),["stop"]),class:"p-1 text-gray-400 dark:text-gray-500 hover:text-orga-500 dark:hover:text-orga-400 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:o(a)("Edit dependency")},[...$[10]||($[10]=[e("i",{class:"fa-solid fa-pen text-[10px]"},null,-1)])],8,Hr),e("button",{onClick:je(O=>E.value=_.name,["stop"]),class:"p-1 text-gray-400 dark:text-gray-500 hover:text-red-500 dark:hover:text-red-400 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:o(a)("Remove dependency")},[...$[11]||($[11]=[e("i",{class:"fa-solid fa-trash-can text-[10px]"},null,-1)])],8,Wr)]))]))]))),128))])):(r(),n("p",qr,t(o(a)("No predecessors - this task can start independently")),1))]),e("div",Qr,[e("h5",Xr,[$[12]||($[12]=e("i",{class:"fa-solid fa-arrow-right text-orga-500"},null,-1)),T(" "+t(o(a)("Successors (Blocking)")),1)]),l.successors.length?(r(),n("div",Yr,[(r(!0),n(V,null,Q(l.successors,_=>(r(),n("div",{key:_.name,class:"flex items-center gap-2 p-2 bg-gray-50 dark:bg-gray-800 rounded-lg"},[e("span",{class:D(["px-1.5 py-0.5 text-[10px] font-mono rounded",y(_.dependency_type)])},t(_.dependency_type||"FS"),3),e("div",Zr,[e("p",Jr,t(_.task_subject||_.task),1),e("p",eo,[T(t(o(a)("Waiting for this task"))+" ",1),_.lag_days?(r(),n("span",to,"+"+t(_.lag_days)+"d lag",1)):v("",!0)])]),e("span",{class:D(["text-[10px] px-1.5 py-0.5 rounded",f(_.task_status)])},t(_.task_status),3)]))),128))])):(r(),n("p",ao,t(o(a)("No successors - no tasks are waiting for this one")),1))]),l.readonly?v("",!0):(r(),n("div",so,[e("h5",ro,t(o(a)("Add Dependency")),1),e("div",oo,[J(e("select",{"onUpdate:modelValue":$[3]||($[3]=_=>w.value=_),class:"px-2 py-1.5 text-xs border border-gray-200 dark:border-gray-700 rounded bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300"},[e("option",no,t(o(a)("FS (Finish-Start)")),1),e("option",lo,t(o(a)("SS (Start-Start)")),1),e("option",io,t(o(a)("FF (Finish-Finish)")),1),e("option",uo,t(o(a)("SF (Start-Finish)")),1)],512),[[Le,w.value]]),J(e("select",{"onUpdate:modelValue":$[4]||($[4]=_=>S.value=_),class:"flex-1 px-2 py-1.5 text-xs border border-gray-200 dark:border-gray-700 rounded bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300"},[e("option",co,t(o(a)("Select task...")),1),(r(!0),n(V,null,Q(l.availableTasks,_=>(r(),n("option",{key:_.name,value:_.name},t(_.subject),9,go))),128))],512),[[Le,S.value]]),e("button",{onClick:X,disabled:!S.value||x.value,class:"px-3 py-1.5 bg-orga-500 text-white rounded text-xs hover:bg-orga-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[e("i",{class:D(["fa-solid",x.value?"fa-spinner fa-spin":"fa-plus"])},null,2)],8,xo)])]))],64))]))}}),ko={class:"space-y-6"},po={class:"bg-gradient-to-br from-orga-50 to-orga-100 dark:from-orga-900/30 dark:to-orga-800/20 rounded-lg p-4"},fo={class:"text-xs font-semibold text-orga-700 dark:text-orga-400 uppercase tracking-wider mb-3"},bo={class:"grid grid-cols-2 gap-4"},mo={class:"text-[10px] text-orga-600 dark:text-orga-500 uppercase"},vo={key:0,class:"flex items-center gap-1 mt-1"},ho={class:"text-sm text-orga-600"},_o=["title"],wo={class:"text-[10px] text-orga-600 dark:text-orga-500 uppercase"},$o={key:0,class:"flex items-center gap-1 mt-1"},Co={class:"text-sm text-orga-600"},To=["title"],So={key:0,class:"mt-3 pt-3 border-t border-orga-200 dark:border-orga-700"},Fo={class:"flex items-center justify-between"},Do={class:"text-xs text-orga-600 dark:text-orga-500"},jo={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3 flex items-center gap-2"},Ao={class:"space-y-3"},Bo={class:"grid grid-cols-2 gap-4"},Po={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3"},Mo={class:"text-[10px] text-gray-500 dark:text-gray-400 uppercase"},Lo={class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},Ro={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3"},Io={class:"text-[10px] text-gray-500 dark:text-gray-400 uppercase"},Uo={class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},Eo={class:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},Go={class:"flex items-center gap-2"},No=["title"],Oo={key:0,class:"fa-solid fa-check text-xs"},Vo={class:"text-sm text-gray-700 dark:text-gray-300"},zo={key:0},Ko={key:0,class:"flex items-center gap-1"},Ho={class:"text-xs text-gray-400"},Wo=["title"],qo={key:0,class:"p-3 bg-green-50 dark:bg-green-900/20 rounded-lg"},Qo={class:"flex items-center justify-between"},Xo={class:"text-sm text-green-700 dark:text-green-400"},Yo={class:"text-lg font-bold text-green-800 dark:text-green-300"},Zo=oe({__name:"TaskFinanceTab",props:{task:{}},emits:["update-finance"],setup(l,{emit:L}){const s=l,{formatCurrency:c,currencySymbol:w}=Ve(),S=L,x=b(null),d=b(0),g=b(null),p=b(!1);function P(F,y){p.value||(x.value=F,d.value=y,pe(()=>{var f;return(f=g.value)==null?void 0:f.focus()}))}function E(){x.value=null}function N(){if(!x.value||p.value)return;p.value=!0;const F=x.value,y=d.value&&d.value>0?d.value:0;x.value=null,S("update-finance",F,y),pe(()=>{p.value=!1})}function W(){p.value||(p.value=!0,S("update-finance","is_billable",!s.task.is_billable),pe(()=>{p.value=!1}))}const I=B(()=>s.task.estimated_cost?(s.task.estimated_cost||0)-(s.task.actual_cost||0):null),G=B(()=>!s.task.estimated_cost||I.value===null?"0":Math.round(I.value/s.task.estimated_cost*100)),X=B(()=>!s.task.is_billable||!s.task.billing_rate?0:(s.task.actual_hours||0)*s.task.billing_rate);return(F,y)=>(r(),n("div",ko,[e("div",po,[e("h5",fo,t(F.__("Cost Summary")),1),e("div",bo,[e("div",null,[e("p",mo,t(F.__("Estimated")),1),x.value==="estimated_cost"?(r(),n("div",vo,[e("span",ho,t(o(w)),1),J(e("input",{ref_key:"editInputRef",ref:g,"onUpdate:modelValue":y[0]||(y[0]=f=>d.value=f),type:"number",min:"0",step:"10",onKeydown:[Z(N,["enter"]),Z(E,["escape"])],onBlur:N,class:"w-full text-lg font-bold bg-transparent border-b-2 border-orga-500 outline-none text-orga-800 dark:text-orga-300"},null,544),[[re,d.value,void 0,{number:!0}]])])):(r(),n("p",{key:1,onClick:y[1]||(y[1]=f=>P("estimated_cost",l.task.estimated_cost||0)),class:"text-xl font-bold text-orga-800 dark:text-orga-300 cursor-text hover:text-orga-600 dark:hover:text-orga-200 transition-colors",title:F.__("Click to edit")},t(o(c)(l.task.estimated_cost||0)),9,_o))]),e("div",null,[e("p",wo,t(F.__("Actual")),1),x.value==="actual_cost"?(r(),n("div",$o,[e("span",Co,t(o(w)),1),J(e("input",{ref_key:"editInputRef",ref:g,"onUpdate:modelValue":y[2]||(y[2]=f=>d.value=f),type:"number",min:"0",step:"10",onKeydown:[Z(N,["enter"]),Z(E,["escape"])],onBlur:N,class:"w-full text-lg font-bold bg-transparent border-b-2 border-orga-500 outline-none text-orga-800 dark:text-orga-300"},null,544),[[re,d.value,void 0,{number:!0}]])])):(r(),n("p",{key:1,onClick:y[3]||(y[3]=f=>P("actual_cost",l.task.actual_cost||0)),class:"text-xl font-bold text-orga-800 dark:text-orga-300 cursor-text hover:text-orga-600 dark:hover:text-orga-200 transition-colors",title:F.__("Click to edit")},t(o(c)(l.task.actual_cost||0)),9,To))])]),I.value!==null?(r(),n("div",So,[e("div",Fo,[e("span",Do,t(F.__("Variance")),1),e("span",{class:D(["text-sm font-semibold",I.value>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"])},t(I.value>=0?"+":"")+t(o(c)(I.value))+" ("+t(G.value)+"%) ",3)])])):v("",!0)]),e("div",null,[e("h5",jo,[y[6]||(y[6]=e("i",{class:"fa-solid fa-clock text-orga-500"},null,-1)),T(" "+t(F.__("Time & Billing")),1)]),e("div",Ao,[e("div",Bo,[e("div",Po,[e("p",Mo,t(F.__("Estimated Hours")),1),e("p",Lo,t(l.task.estimated_hours||0)+"h ",1)]),e("div",Ro,[e("p",Io,t(F.__("Actual Hours")),1),e("p",Uo,t(l.task.actual_hours||0)+"h ",1)])]),e("div",Eo,[e("div",Go,[e("button",{onClick:W,class:D(["w-5 h-5 rounded flex items-center justify-center transition-colors",l.task.is_billable?"bg-green-500 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-400 dark:text-gray-500"]),title:F.__("Toggle billable")},[l.task.is_billable?(r(),n("i",Oo)):v("",!0)],10,No),e("span",Vo,t(F.__("Billable")),1)]),l.task.is_billable?(r(),n("div",zo,[x.value==="billing_rate"?(r(),n("div",Ko,[e("span",Ho,t(o(w)),1),J(e("input",{ref_key:"editInputRef",ref:g,"onUpdate:modelValue":y[4]||(y[4]=f=>d.value=f),type:"number",min:"0",step:"5",onKeydown:[Z(N,["enter"]),Z(E,["escape"])],onBlur:N,class:"w-20 text-sm font-medium bg-transparent border-b-2 border-orga-500 outline-none text-gray-800 dark:text-gray-200 text-right"},null,544),[[re,d.value,void 0,{number:!0}]]),y[7]||(y[7]=e("span",{class:"text-xs text-gray-400"},"/hr",-1))])):(r(),n("span",{key:1,onClick:y[5]||(y[5]=f=>P("billing_rate",l.task.billing_rate||0)),class:"text-sm font-medium text-gray-800 dark:text-gray-200 cursor-text hover:text-orga-600 dark:hover:text-orga-400 transition-colors",title:F.__("Click to edit rate")},t(l.task.billing_rate?`${o(c)(l.task.billing_rate)}/hr`:F.__("Set rate")),9,Wo))])):v("",!0)]),l.task.is_billable&&X.value>0?(r(),n("div",qo,[e("div",Qo,[e("span",Xo,t(F.__("Billable Amount")),1),e("span",Yo,t(o(c)(X.value)),1)])])):v("",!0)])])]))}}),Jo={class:"flex flex-col h-full"},en={key:0,class:"mb-4"},tn={class:"flex items-center justify-between mb-2"},an={class:"text-xs text-gray-500 dark:text-gray-400"},sn={class:"text-sm font-medium text-gray-800 dark:text-gray-200"},rn={class:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},on={key:1,class:"text-center py-8"},nn={class:"text-sm text-gray-400 dark:text-gray-500 mt-2"},ln={key:2,class:"flex-1 overflow-auto space-y-2 mb-3"},dn=["onClick"],un={key:0,class:"fa-solid fa-check text-xs"},cn=["onClick","title"],gn=["onClick","title"],xn={key:0,class:"text-center py-8"},yn={class:"text-sm text-gray-400 dark:text-gray-500"},kn={class:"text-xs text-gray-300 dark:text-gray-600 mt-1"},pn={class:"sticky bottom-0 bg-white dark:bg-gray-900 pt-2 border-t border-gray-100 dark:border-gray-800"},fn={class:"flex gap-2"},bn=["placeholder","disabled"],mn=["disabled","title"],vn=oe({__name:"TaskChecklistTab",props:{checklist:{},isLoading:{type:Boolean},isAdding:{type:Boolean}},emits:["add","toggle","delete","promote"],setup(l,{emit:L}){const s=l,c=L,w=b(""),S=B(()=>{if(!s.checklist.length)return 0;const d=s.checklist.filter(g=>g.is_completed).length;return Math.round(d/s.checklist.length*100)});function x(){w.value.trim()&&!s.isAdding&&(c("add",w.value.trim()),w.value="")}return(d,g)=>(r(),n("div",Jo,[l.checklist.length?(r(),n("div",en,[e("div",tn,[e("span",an,t(d.__("Progress")),1),e("span",sn,t(S.value)+"%",1)]),e("div",rn,[e("div",{class:"h-full bg-orga-500 transition-all duration-300",style:Ae({width:S.value+"%"})},null,4)])])):v("",!0),l.isLoading?(r(),n("div",on,[g[1]||(g[1]=e("i",{class:"fa-solid fa-spinner fa-spin text-gray-400 dark:text-gray-500 text-xl"},null,-1)),e("p",nn,t(d.__("Loading checklist...")),1)])):(r(),n("div",ln,[(r(!0),n(V,null,Q(l.checklist,p=>(r(),n("div",{key:p.name,class:"flex items-center gap-2 group"},[e("button",{onClick:P=>c("toggle",p),class:D(["w-5 h-5 rounded border flex items-center justify-center transition-colors shrink-0",p.is_completed?"bg-orga-500 border-orga-500 text-white":"border-gray-300 dark:border-gray-600 hover:border-orga-500"])},[p.is_completed?(r(),n("i",un)):v("",!0)],10,dn),e("span",{class:D(["text-sm flex-1",p.is_completed?"text-gray-400 dark:text-gray-500 line-through":"text-gray-700 dark:text-gray-300"])},t(p.title),3),p.is_completed?v("",!0):(r(),n("button",{key:0,onClick:P=>c("promote",p),class:"text-gray-300 dark:text-gray-600 hover:text-orga-500 opacity-0 group-hover:opacity-100 transition-opacity",title:d.__("Promote to task")},[...g[2]||(g[2]=[e("i",{class:"fa-solid fa-arrow-up-right-from-square text-xs"},null,-1)])],8,cn)),e("button",{onClick:P=>c("delete",p),class:"text-gray-300 dark:text-gray-600 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",title:d.__("Delete item")},[...g[3]||(g[3]=[e("i",{class:"fa-solid fa-trash-can text-xs"},null,-1)])],8,gn)]))),128)),!l.checklist.length&&!l.isLoading?(r(),n("div",xn,[g[4]||(g[4]=e("i",{class:"fa-solid fa-list-check fa-2x text-gray-300 dark:text-gray-600 mb-3 block"},null,-1)),e("p",yn,t(d.__("No checklist items yet.")),1),e("p",kn,t(d.__("Add items below to track progress.")),1)])):v("",!0)])),e("div",pn,[e("div",fn,[J(e("input",{"onUpdate:modelValue":g[0]||(g[0]=p=>w.value=p),onKeyup:Z(x,["enter"]),type:"text",placeholder:d.__("Add checklist item..."),disabled:l.isAdding,class:"flex-1 px-3 py-2 text-sm border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 rounded-lg focus:border-orga-500 focus:outline-none focus:ring-1 focus:ring-orga-500/20 disabled:opacity-50 placeholder-gray-400 dark:placeholder-gray-500"},null,40,bn),[[re,w.value]]),e("button",{onClick:x,disabled:l.isAdding||!w.value.trim(),class:"px-3 py-2 bg-orga-500 text-white rounded-lg hover:bg-orga-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:d.__("Add item")},[e("i",{class:D(["fa-solid",l.isAdding?"fa-spinner fa-spin":"fa-plus"])},null,2)],8,mn)])])]))}}),hn={class:"flex flex-col h-full"},_n={key:0,class:"text-center py-8"},wn={class:"text-sm text-gray-400 dark:text-gray-500 mt-2"},$n={key:1,class:"flex-1 overflow-auto space-y-1.5 mb-3"},Cn=["href"],Tn={class:"text-xs text-gray-400 dark:text-gray-500 whitespace-nowrap"},Sn=["onClick","title"],Fn={key:0,class:"text-center py-8"},Dn={class:"text-sm text-gray-400 dark:text-gray-500"},jn={class:"text-xs text-gray-300 dark:text-gray-600 mt-1"},An={class:"sticky bottom-0 bg-white dark:bg-gray-900 pt-2 border-t border-gray-100 dark:border-gray-800"},Bn={key:0,class:"mb-2"},Pn={class:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 mb-1"},Mn={key:0},Ln={class:"h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},Rn=["disabled"],In=oe({__name:"TaskAttachmentsTab",props:{attachments:{},isLoading:{type:Boolean},isUploading:{type:Boolean},uploadProgress:{}},emits:["upload","delete"],setup(l,{emit:L}){const s=L;function c(x){var g;const d=x.target;(g=d.files)!=null&&g.length&&(s("upload",d.files[0]),d.value="")}function w(x){const d=x.file_name||"",g=x.file_type||"";return g.includes("pdf")||d.endsWith(".pdf")?"fa-file-pdf text-red-500":g.includes("image")||/\.(png|jpg|jpeg|gif|svg|webp)$/i.test(d)?"fa-file-image text-blue-500":g.includes("word")||/\.(doc|docx)$/i.test(d)?"fa-file-word text-blue-600":g.includes("excel")||/\.(xls|xlsx|csv)$/i.test(d)?"fa-file-excel text-green-600":/\.(dwg|dxf)$/i.test(d)?"fa-drafting-compass text-orange-500":/\.(zip|rar|7z|tar|gz)$/i.test(d)?"fa-file-zipper text-yellow-600":g.includes("text")||/\.(txt|md)$/i.test(d)?"fa-file-lines text-gray-500":"fa-file text-gray-400"}function S(x){if(!x)return"0 B";const d=["B","KB","MB","GB"];let g=0,p=x;for(;p>=1024&&g<d.length-1;)p/=1024,g++;return`${p.toFixed(p<10?1:0)} ${d[g]}`}return(x,d)=>(r(),n("div",hn,[l.isLoading?(r(),n("div",_n,[d[0]||(d[0]=e("i",{class:"fa-solid fa-spinner fa-spin text-gray-400 dark:text-gray-500 text-xl"},null,-1)),e("p",wn,t(x.__("Loading files...")),1)])):(r(),n("div",$n,[(r(!0),n(V,null,Q(l.attachments,g=>(r(),n("div",{key:g.name,class:"flex items-center gap-2 group px-1 py-1.5 rounded hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors"},[e("i",{class:D(["fa-solid text-sm w-4 text-center",w(g)])},null,2),e("a",{href:g.file_url,target:"_blank",class:"text-sm text-gray-700 dark:text-gray-300 hover:text-orga-600 dark:hover:text-orga-400 truncate flex-1 hover:underline"},t(g.file_name),9,Cn),e("span",Tn,t(S(g.file_size)),1),e("button",{onClick:p=>s("delete",g),class:"text-gray-300 dark:text-gray-600 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity shrink-0",title:x.__("Delete file")},[...d[1]||(d[1]=[e("i",{class:"fa-solid fa-trash-can text-xs"},null,-1)])],8,Sn)]))),128)),!l.attachments.length&&!l.isLoading?(r(),n("div",Fn,[d[2]||(d[2]=e("i",{class:"fa-solid fa-paperclip fa-2x text-gray-300 dark:text-gray-600 mb-3 block"},null,-1)),e("p",Dn,t(x.__("No files attached yet.")),1),e("p",jn,t(x.__("Upload files below to attach them to this task.")),1)])):v("",!0)])),e("div",An,[l.isUploading?(r(),n("div",Bn,[e("div",Pn,[d[3]||(d[3]=e("i",{class:"fa-solid fa-spinner fa-spin"},null,-1)),e("span",null,t(x.__("Uploading...")),1),l.uploadProgress>0?(r(),n("span",Mn,t(l.uploadProgress)+"%",1)):v("",!0)]),e("div",Ln,[e("div",{class:"h-full bg-orga-500 transition-all duration-300",style:Ae({width:(l.uploadProgress||0)+"%"})},null,4)])])):v("",!0),e("label",{class:D(["flex items-center justify-center gap-2 px-3 py-2.5 border-2 border-dashed rounded-lg cursor-pointer transition-colors text-sm",l.isUploading?"border-gray-200 dark:border-gray-700 text-gray-300 dark:text-gray-600 cursor-not-allowed":"border-gray-300 dark:border-gray-600 text-gray-500 dark:text-gray-400 hover:border-orga-500 hover:text-orga-500"])},[d[4]||(d[4]=e("i",{class:"fa-solid fa-cloud-arrow-up"},null,-1)),e("span",null,t(x.__("Choose file to upload")),1),e("input",{type:"file",class:"hidden",disabled:l.isUploading,onChange:c},null,40,Rn)],2)])]))}}),Un={class:"space-y-6"},En={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3 flex items-center gap-2"},Gn={class:"flex flex-wrap gap-2"},Nn=["onClick"],On={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3 flex items-center gap-2"},Vn={class:"flex flex-wrap gap-2"},zn=["onClick"],Kn={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3 flex items-center gap-2"},Hn={class:"space-y-2"},Wn={class:"text-sm font-medium text-gray-800 dark:text-gray-200"},qn={class:"text-xs text-gray-500 dark:text-gray-400"},Qn={class:"text-sm font-medium text-gray-800 dark:text-gray-200"},Xn={class:"text-xs text-gray-500 dark:text-gray-400"},Yn={class:"text-sm font-medium text-gray-800 dark:text-gray-200"},Zn={class:"text-xs text-gray-500 dark:text-gray-400"},Jn={class:"text-sm font-medium text-red-700 dark:text-red-400"},el={class:"text-xs text-red-500 dark:text-red-400"},tl=oe({__name:"TaskActionsTab",props:{task:{},columns:{},canDelete:{type:Boolean,default:!0}},emits:["status-change","priority-change","navigate","assign-to-me","duplicate","delete"],setup(l,{emit:L}){const s=L,c=["Low","Medium","High","Urgent"],w={Low:"bg-gray-500 text-white border-gray-500",Medium:"bg-yellow-500 text-white border-yellow-500",High:"bg-orange-500 text-white border-orange-500",Urgent:"bg-red-500 text-white border-red-500"};return(S,x)=>(r(),n("div",Un,[e("div",null,[e("h5",En,[x[4]||(x[4]=e("i",{class:"fa-solid fa-toggle-on text-orga-500"},null,-1)),T(" "+t(o(a)("Change Status")),1)]),e("div",Gn,[(r(!0),n(V,null,Q(l.columns,d=>(r(),n("button",{key:d.id,onClick:g=>s("status-change",d.id),class:D(["px-3 py-1.5 rounded-lg text-xs font-medium transition-colors border",l.task.status===d.id?"bg-orga-500 text-white border-orga-500":"bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-400 border-gray-200 dark:border-gray-700 hover:border-orga-500 hover:text-orga-500"])},t(d.title),11,Nn))),128))])]),e("div",null,[e("h5",On,[x[5]||(x[5]=e("i",{class:"fa-solid fa-flag text-orga-500"},null,-1)),T(" "+t(o(a)("Change Priority")),1)]),e("div",Vn,[(r(),n(V,null,Q(c,d=>e("button",{key:d,onClick:g=>s("priority-change",d),class:D(["px-3 py-1.5 rounded-lg text-xs font-medium transition-colors border",l.task.priority===d?w[d]:"bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-400 border-gray-200 dark:border-gray-700 hover:border-gray-400"])},t(o(a)(d)),11,zn)),64))])]),e("div",null,[e("h5",Kn,[x[6]||(x[6]=e("i",{class:"fa-solid fa-bolt text-orga-500"},null,-1)),T(" "+t(o(a)("Quick Actions")),1)]),e("div",Hn,[e("button",{onClick:x[0]||(x[0]=d=>s("navigate")),class:"w-full flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-left"},[x[7]||(x[7]=e("i",{class:"fa-solid fa-external-link text-gray-400 dark:text-gray-500"},null,-1)),e("div",null,[e("p",Wn,t(o(a)("Open Task Log")),1),e("p",qn,t(o(a)("Audit trail, assignments, version history")),1)])]),e("button",{onClick:x[1]||(x[1]=d=>s("assign-to-me")),class:"w-full flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-left"},[x[8]||(x[8]=e("i",{class:"fa-solid fa-user-plus text-gray-400 dark:text-gray-500"},null,-1)),e("div",null,[e("p",Qn,t(o(a)("Assign to Me")),1),e("p",Xn,t(o(a)("Take ownership of this task")),1)])]),e("button",{onClick:x[2]||(x[2]=d=>s("duplicate")),class:"w-full flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-left"},[x[9]||(x[9]=e("i",{class:"fa-solid fa-copy text-gray-400 dark:text-gray-500"},null,-1)),e("div",null,[e("p",Yn,t(o(a)("Duplicate Task")),1),e("p",Zn,t(o(a)("Create a copy of this task")),1)])]),l.canDelete?(r(),n("button",{key:0,onClick:x[3]||(x[3]=d=>s("delete")),class:"w-full flex items-center gap-3 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors text-left"},[x[10]||(x[10]=e("i",{class:"fa-solid fa-trash text-red-500"},null,-1)),e("div",null,[e("p",Jn,t(o(a)("Delete Task")),1),e("p",el,t(o(a)("Permanently remove this task")),1)])])):v("",!0)])])]))}}),al={class:"space-y-5"},sl={class:"bg-gradient-to-br from-orga-50 to-orga-100 dark:from-orga-900/30 dark:to-orga-800/20 rounded-lg p-4"},rl={key:0,class:"text-center space-y-3"},ol={class:"flex items-center justify-center gap-2 text-xs text-orga-600 dark:text-orga-400 uppercase font-semibold"},nl={class:"text-3xl font-mono font-bold text-orga-700 dark:text-orga-300 m-0 tabular-nums"},ll=["placeholder"],il=["disabled"],dl={key:1,class:"text-center space-y-2"},ul={class:"text-xs text-gray-500 dark:text-gray-400 m-0"},cl={class:"text-sm font-medium text-gray-700 dark:text-gray-300 m-0"},gl=["disabled","title"],xl={key:2,class:"text-center"},yl=["disabled"],kl={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3 flex items-center gap-2"},pl={class:"grid grid-cols-2 gap-3"},fl={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3"},bl={class:"text-[10px] text-gray-500 dark:text-gray-400 uppercase m-0"},ml={class:"text-lg font-semibold text-gray-800 dark:text-gray-200 m-0"},vl={class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3"},hl={class:"text-[10px] text-gray-500 dark:text-gray-400 uppercase m-0"},_l={key:0,class:"mt-3"},wl={class:"flex justify-between text-[10px] text-gray-500 dark:text-gray-400 mb-1"},$l={class:"h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},Cl={class:"flex items-center justify-between mb-3"},Tl={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider m-0 flex items-center gap-2"},Sl={key:0,class:"text-center py-4"},Fl={key:1,class:"text-center py-6"},Dl={class:"text-sm text-gray-400 dark:text-gray-500 m-0"},jl={key:2,class:"space-y-2 max-h-[300px] overflow-y-auto"},Al={class:"flex-1 min-w-0"},Bl={class:"flex items-center gap-2"},Pl={class:"text-sm font-medium text-gray-800 dark:text-gray-200"},Ml={class:"text-xs text-gray-400 dark:text-gray-500"},Ll={key:0,class:"text-xs text-gray-500 dark:text-gray-400 truncate m-0 mt-0.5"},Rl=["onClick","title"],Il=oe({__name:"TaskTimeTab",props:{task:{}},emits:["update","open-manual-entry"],setup(l,{emit:L}){const s=l,c=L,{timerState:w,formattedTime:S,startTimer:x,stopTimer:d,isTrackingTask:g,loading:p}=gt(),P=yt(),E=b([]),N=b(0),W=b(0),I=b(!1),G=b(""),X=B(()=>g(s.task.name)),F=B(()=>w.value.isRunning&&!X.value),y=B(()=>!s.task.estimated_hours||s.task.estimated_hours<=0?0:Math.min(100,Math.round((s.task.actual_hours||0)/s.task.estimated_hours*100))),f=B(()=>(s.task.actual_hours||0)>(s.task.estimated_hours||0)&&(s.task.estimated_hours||0)>0);function M(){return R(this,null,function*(){I.value=!0;try{const A=yield P.getTimeLogs({task:s.task.name,limit:20});E.value=A.logs||[],N.value=(A.logs||[]).reduce((C,H)=>C+(H.hours||0),0),W.value=A.total||0}catch(A){E.value=[]}finally{I.value=!1}})}function $(){return R(this,null,function*(){try{yield x({trackingContext:"task",task:s.task.name})}catch(A){console.error("Failed to start timer:",A)}})}function _(){return R(this,null,function*(){try{const A=yield d();G.value.trim()&&(A!=null&&A.name)&&(yield P.updateTimeLog(A.name,{description:G.value.trim()})),G.value="",yield M(),c("update")}catch(A){console.error("Failed to stop timer:",A)}})}function O(A){return R(this,null,function*(){try{yield P.deleteTimeLog(A),yield M(),c("update")}catch(C){console.error("Failed to delete time log:",C)}})}function Y(A){if(A>=1)return`${A.toFixed(1)}h`;const C=Math.round(A*60);return C>0?`${C}m`:A>0?"< 1m":"0m"}function ye(A){return new Date(A).toLocaleDateString("en-US",{month:"short",day:"numeric"})}return Re(()=>s.task.name,()=>{M()}),xt(()=>{M()}),(A,C)=>(r(),n("div",al,[e("div",sl,[X.value?(r(),n("div",rl,[e("div",ol,[C[2]||(C[2]=e("span",{class:"relative flex h-2 w-2"},[e("span",{class:"animate-ping absolute inline-flex h-full w-full rounded-full bg-orga-400 opacity-75"}),e("span",{class:"relative inline-flex rounded-full h-2 w-2 bg-orga-500"})],-1)),T(" "+t(o(a)("Timer Running")),1)]),e("p",nl,t(o(S)),1),J(e("input",{"onUpdate:modelValue":C[0]||(C[0]=H=>G.value=H),type:"text",placeholder:o(a)("What are you working on?"),class:"w-full px-3 py-1.5 text-sm text-center bg-white/60 dark:bg-gray-800/60 border border-orga-200 dark:border-orga-700 rounded-lg text-gray-800 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 outline-none focus:border-orga-400 dark:focus:border-orga-500"},null,8,ll),[[re,G.value]]),e("button",{onClick:_,disabled:o(p),class:"px-6 py-2 bg-orga-500 text-white text-sm font-medium rounded-lg hover:bg-orga-600 disabled:opacity-50 transition-colors inline-flex items-center gap-2"},[C[3]||(C[3]=e("i",{class:"fa-solid fa-stop text-xs"},null,-1)),T(" "+t(o(a)("Stop & Save")),1)],8,il)])):F.value?(r(),n("div",dl,[e("p",ul,t(o(a)("Timer active on")),1),e("p",cl,t(o(w).contextLabel),1),e("button",{onClick:$,disabled:o(p),class:"mt-2 px-4 py-1.5 bg-orga-500 text-white text-xs font-medium rounded-lg hover:bg-orga-600 disabled:opacity-50 transition-colors inline-flex items-center gap-1.5",title:o(a)("Stops current timer and starts for this task")},[C[4]||(C[4]=e("i",{class:"fa-solid fa-play text-[10px]"},null,-1)),T(" "+t(o(a)("Switch to this task")),1)],8,gl)])):(r(),n("div",xl,[e("button",{onClick:$,disabled:o(p),class:"px-6 py-2 bg-orga-500 text-white text-sm font-medium rounded-lg hover:bg-orga-600 disabled:opacity-50 transition-colors inline-flex items-center gap-2"},[C[5]||(C[5]=e("i",{class:"fa-solid fa-play text-xs"},null,-1)),T(" "+t(o(a)("Start Timer")),1)],8,yl)]))]),e("div",null,[e("h5",kl,[C[6]||(C[6]=e("i",{class:"fa-solid fa-chart-bar text-orga-500"},null,-1)),T(" "+t(o(a)("Time Summary")),1)]),e("div",pl,[e("div",fl,[e("p",bl,t(o(a)("Estimated")),1),e("p",ml,t(l.task.estimated_hours?`${l.task.estimated_hours}h`:"—"),1)]),e("div",vl,[e("p",hl,t(o(a)("Actual")),1),e("p",{class:D(["text-lg font-semibold m-0",f.value?"text-red-600 dark:text-red-400":"text-gray-800 dark:text-gray-200"])},t(Y(l.task.actual_hours||0)),3)])]),l.task.estimated_hours?(r(),n("div",_l,[e("div",wl,[e("span",null,t(o(a)("{0} entries",[W.value])),1),e("span",null,t(y.value)+"%",1)]),e("div",$l,[e("div",{class:D(["h-full rounded-full transition-all",f.value?"bg-red-500":"bg-orga-500"]),style:Ae({width:`${Math.min(y.value,100)}%`})},null,6)])])):v("",!0)]),e("div",null,[e("div",Cl,[e("h5",Tl,[C[7]||(C[7]=e("i",{class:"fa-solid fa-list text-orga-500"},null,-1)),T(" "+t(o(a)("Time Logs")),1)]),e("button",{onClick:C[1]||(C[1]=H=>c("open-manual-entry")),class:"text-xs text-orga-500 dark:text-orga-400 hover:text-orga-600 dark:hover:text-orga-300 font-medium"}," + "+t(o(a)("Log Time")),1)]),I.value?(r(),n("div",Sl,[...C[8]||(C[8]=[e("i",{class:"fa-solid fa-spinner fa-spin text-gray-400"},null,-1)])])):E.value.length===0?(r(),n("div",Fl,[C[9]||(C[9]=e("i",{class:"fa-regular fa-clock text-2xl text-gray-300 dark:text-gray-600 mb-2"},null,-1)),e("p",Dl,t(o(a)("No time logged yet")),1)])):(r(),n("div",jl,[(r(!0),n(V,null,Q(E.value,H=>(r(),n("div",{key:H.name,class:"flex items-center justify-between p-2.5 bg-gray-50 dark:bg-gray-800 rounded-lg group"},[e("div",Al,[e("div",Bl,[e("span",Pl,t(Y(H.hours)),1),e("span",Ml,t(ye(H.log_date)),1)]),H.description?(r(),n("p",Ll,t(H.description),1)):v("",!0)]),e("button",{onClick:ue=>O(H.name),class:"p-1 text-gray-300 dark:text-gray-600 hover:text-red-500 dark:hover:text-red-400 opacity-0 group-hover:opacity-100 transition-all",title:o(a)("Delete")},[...C[10]||(C[10]=[e("i",{class:"fa-solid fa-trash-can text-xs"},null,-1)])],8,Rl)]))),128))]))])]))}}),Ul={key:0,class:"h-full flex flex-col bg-white dark:bg-gray-900 transition-colors"},El={class:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between shrink-0"},Gl={class:"font-semibold text-gray-800 dark:text-gray-100 m-0 flex items-center gap-2"},Nl=["title"],Ol={key:0,class:"p-4"},Vl={class:"p-4"},zl={key:1,class:"text-center py-8 text-gray-400"},Kl={class:"text-sm"},Hl={class:"text-xs mt-2"},Wl={key:0,class:"p-4 border-b border-gray-200 dark:border-gray-700"},ql={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-3 flex items-center gap-2"},Ql={key:0,class:"fixed inset-0 z-[100] flex items-center justify-center p-4"},Xl={class:"relative bg-white dark:bg-gray-900 rounded-xl shadow-2xl w-full max-w-sm border border-gray-200 dark:border-gray-700"},Yl={class:"flex items-center gap-3 p-5 pb-4 border-b border-red-200 dark:border-red-900/50 bg-red-50 dark:bg-red-950/30 rounded-t-xl"},Zl={class:"text-lg font-semibold text-red-900 dark:text-red-200 m-0"},Jl=["disabled"],ei={class:"p-5"},ti={class:"text-sm text-gray-700 dark:text-gray-300 m-0"},ai={class:"text-red-600 dark:text-red-400"},si={class:"flex justify-end gap-3 p-5 pt-0"},ri=["disabled"],oi=["disabled"],ni={key:0,class:"fa-solid fa-spinner fa-spin"},li={key:1,class:"fa-solid fa-trash"},ui=oe({__name:"TaskManager",props:{task:{},columns:{default:()=>[{id:"Open",title:"Open"},{id:"In Progress",title:"In Progress"},{id:"Review",title:"Review"},{id:"Completed",title:"Completed"}]},allTasks:{default:()=>[]},contacts:{default:()=>[]},availableGroups:{default:()=>[]},viewType:{default:"kanban"},project:{},showCascadePreview:{type:Boolean,default:!1}},emits:["close","update","status-change","priority-change","field-update","navigate","preview-cascade","apply-cascade"],setup(l,{emit:L}){const s=l,c=L;ht();const{getChecklist:w,addChecklistItem:S,toggleChecklistItem:x,deleteChecklistItem:d,promoteChecklistToTask:g,getDependencies:p,addDependency:P,updateDependency:E,removeDependency:N,getAttachments:W,deleteAttachment:I,updateTask:G,createTask:X,deleteTask:F}=_t(),{createAssignment:y,deleteAssignment:f,getTaskAssignments:M}=wt(),{success:$,error:_}=$t(),O=b(!1),Y=b(!1),ye=[{id:"details",icon:"fa-file-alt",label:a("Details")},{id:"dependencies",icon:"fa-project-diagram",label:a("Dependencies")},{id:"time",icon:"fa-stopwatch",label:a("Time")},{id:"finance",icon:"fa-euro-sign",label:a("Finance")},{id:"checklist",icon:"fa-list-check",label:a("Checklist")},{id:"discussion",icon:"fa-comments",label:a("Discussion")},{id:"attachments",icon:"fa-paperclip",label:a("Files")},{id:"actions",icon:"fa-bolt",label:a("Actions")}],A=b(!1),C=b(0);function H(){C.value++,c("update")}const ue=B(()=>s.viewType==="gantt"&&be.value?[...ye.slice(0,2),{id:"cascade",icon:"fa-sitemap",label:a("Cascade")},...ye.slice(2)]:ye),_e=b("details"),ce=b([]),ie=b([]),se=b([]),ge=b([]),we=b(!1),$e=b(!1),Ce=b(!1),z=b(!1),ke=b(!1),ee=b(!1),K=b(!1),ne=b(0),Te=b([]),fe=B(()=>s.viewType==="gantt"),le=B(()=>fe.value&&"dependencies_info"in s.task?s.task:null),Ie=B(()=>{var i;return((i=le.value)==null?void 0:i.dependencies_info)||[]}),Be=B(()=>{var i;return((i=le.value)==null?void 0:i.dependents_info)||[]}),be=B(()=>Be.value.length>0||se.value.length>0),Se=B(()=>{var i;return((i=le.value)==null?void 0:i.is_blocked)||!1}),Ue=B(()=>{const i=le.value;return i&&i.budget!==void 0&&i.budget>0}),Pe=B(()=>{const i=new Set([...ie.value.map(u=>u.depends_on),s.task.name]);return s.allTasks.filter(u=>!i.has(u.name))});function xe(){return R(this,null,function*(){var i;if((i=s.task)!=null&&i.name){Ce.value=!0;try{const u=yield w(s.task.name);ce.value=u||[]}catch(u){console.error("Failed to load checklist:",u),ce.value=[]}finally{Ce.value=!1}}})}function me(){return R(this,null,function*(){var i;if((i=s.task)!=null&&i.name){z.value=!0;try{const u=yield p(s.task.name);ie.value=(u==null?void 0:u.predecessors)||[],se.value=(u==null?void 0:u.successors)||[]}catch(u){console.error("Failed to load dependencies:",u),ie.value=[],se.value=[]}finally{z.value=!1}}})}function ve(){return R(this,null,function*(){var i;if((i=s.task)!=null&&i.name){ke.value=!0;try{const u=yield W(s.task.name);Te.value=u||[]}catch(u){console.error("Failed to load attachments:",u),Te.value=[]}finally{ke.value=!1}}})}function h(i){return R(this,null,function*(){if(!(!i.trim()||ee.value)){ee.value=!0;try{yield S(s.task.name,i.trim()),yield xe(),c("update")}catch(u){console.error("Failed to add checklist item:",u)}finally{ee.value=!1}}})}function k(i){return R(this,null,function*(){try{yield x(s.task.name,i.name),yield xe(),c("update")}catch(u){console.error("Failed to toggle checklist item:",u)}})}function m(i){return R(this,null,function*(){try{yield d(s.task.name,i.name),yield xe(),c("update")}catch(u){console.error("Failed to delete checklist item:",u)}})}function Fe(i){return R(this,null,function*(){try{const u=yield g(s.task.name,i.name);yield xe(),$(a("Promoted to task"),a('"{0}" created as a new task.',[u.subject])),c("update")}catch(u){console.error("Failed to promote checklist item:",u),_(a("Promote failed"),u.message||a("Could not promote checklist item to task."))}})}function De(i,u,j){return R(this,null,function*(){try{yield P(i,u,j),yield me(),c("update")}catch(U){console.error("Failed to add dependency:",U)}})}function Ge(i,u,j){return R(this,null,function*(){try{yield E(i,u,j),yield me(),c("update")}catch(U){console.error("Failed to update dependency:",U)}})}function Ne(i){return R(this,null,function*(){try{yield N(i),yield me(),c("update")}catch(u){console.error("Failed to remove dependency:",u)}})}function ze(i){return R(this,null,function*(){var u;if(!(!((u=s.task)!=null&&u.name)||K.value)){K.value=!0,ne.value=0;try{const j=new FormData;j.append("file",i),j.append("doctype","Orga Task"),j.append("docname",s.task.name),j.append("is_private","0");const U=new XMLHttpRequest;U.upload.addEventListener("progress",q=>{q.lengthComputable&&(ne.value=Math.round(q.loaded/q.total*100))}),yield new Promise((q,te)=>{var he;U.onload=()=>{U.status>=200&&U.status<300?q():te(new Error(`Upload failed: ${U.statusText}`))},U.onerror=()=>te(new Error("Upload failed")),U.open("POST","/api/method/upload_file"),U.setRequestHeader("X-Frappe-CSRF-Token",((he=window.frappe)==null?void 0:he.csrf_token)||""),U.send(j)}),yield ve(),c("update")}catch(j){console.error("Failed to upload file:",j)}finally{K.value=!1,ne.value=0}}})}function Ke(i){return R(this,null,function*(){try{yield I(s.task.name,i.name),yield ve(),c("update")}catch(u){console.error("Failed to delete attachment:",u)}})}function He(i){c("navigate",{task_id:i})}function We(i,u){c("field-update",{field:i,value:u||null,task_id:s.task.name})}function qe(i){c("field-update",{field:"progress",value:i,task_id:s.task.name})}function Qe(i){c("field-update",{field:"description",value:i,task_id:s.task.name})}function Xe(i){return R(this,null,function*(){const u=s.task.subject;s.task.subject=i;try{yield G(s.task.name,{subject:i}),c("update")}catch(j){s.task.subject=u,console.error("Failed to update task subject:",j)}})}function Ye(i){c("field-update",{field:"task_group",value:i||"",task_id:s.task.name})}function Ze(i){c("field-update",{field:"depends_on_group",value:i||"",task_id:s.task.name})}function Je(i){c("field-update",{field:"task_type",value:i||"",task_id:s.task.name})}function et(i){c("field-update",{field:"auto_trail_start",value:i?1:0,task_id:s.task.name})}function Oe(i){return R(this,null,function*(){const u=s.task.assigned_to,j=s.task.assigned_to_name,U=s.task.assigned_resource_name;if(!i){s.task.assigned_to="",s.task.assigned_to_name="",s.task.assigned_resource="",s.task.assigned_resource_name="";try{yield G(s.task.name,{assigned_to:""});const te=yield M(s.task.name);for(const he of te)yield f(he.name);c("update")}catch(te){s.task.assigned_to=u,s.task.assigned_to_name=j,s.task.assigned_resource_name=U,console.error("Failed to unassign contact:",te)}return}const q=s.contacts.find(te=>te.name===i);if(q){s.task.assigned_resource=i,s.task.assigned_resource_name=q.resource_name,q.user&&(s.task.assigned_to=q.user,s.task.assigned_to_name=q.resource_name);try{q.user&&(yield G(s.task.name,{assigned_to:q.user}));const te=yield M(s.task.name);for(const he of te)yield f(he.name);yield y(s.task.name,i),c("update")}catch(te){s.task.assigned_to=u,s.task.assigned_to_name=j,s.task.assigned_resource_name=U,console.error("Failed to assign contact:",te)}}})}function tt(){c("preview-cascade",{changes:ge.value})}function at(){$e.value=!0,c("apply-cascade",{task_id:s.task.name,changes:ge.value}),ge.value=[],we.value=!1,$e.value=!1}function st(){ge.value=[],we.value=!1}function rt(i){c("status-change",s.task,i)}function ot(i){c("priority-change",s.task,i)}function nt(){window.open(`/app/orga-task/${s.task.name}`,"_blank")}function lt(){return R(this,null,function*(){var i,u;try{const U=(u=(i=window.frappe)==null?void 0:i.session)==null?void 0:u.user;if(!U)return;const q=s.contacts.find(te=>te.user===U);q?yield Oe(q.name):(yield G(s.task.name,{assigned_to:U}),c("update"))}catch(j){console.error("Failed to assign task:",j)}})}function it(){return R(this,null,function*(){try{yield X({subject:a("{0} (Copy)",[s.task.subject]),project:s.task.project,description:s.task.description,priority:s.task.priority,status:"Open",estimated_hours:s.task.estimated_hours}),$(a("Task duplicated"),a('A copy of "{0}" has been created.',[s.task.subject])),c("update")}catch(i){console.error("Failed to duplicate task:",i),_(a("Duplicate failed"),i.message||a("Could not duplicate the task. Please try again."))}})}function dt(){O.value=!0}function ut(){return R(this,null,function*(){if(!Y.value){Y.value=!0;try{yield F(s.task.name),O.value=!1,$(a("Task deleted"),a('"{0}" has been permanently deleted.',[s.task.subject])),c("close"),c("update")}catch(i){console.error("Failed to delete task:",i),_(a("Delete failed"),i.message||a("Could not delete the task. Please try again."))}finally{Y.value=!1}}})}function ct(i,u){return R(this,null,function*(){const j=s.task[i];s.task[i]=u;try{yield G(s.task.name,{[i]:u}),i==="actual_cost"&&c("update")}catch(U){s.task[i]=j,console.error("Failed to update finance field:",U)}})}return Re(()=>{var i;return(i=s.task)==null?void 0:i.name},i=>{i&&(xe(),me(),ve())},{immediate:!0}),(i,u)=>l.task?(r(),n("div",Ul,[e("div",El,[e("h3",Gl,[u[10]||(u[10]=e("i",{class:"fa-solid fa-sliders text-orga-500"},null,-1)),e("span",null,t(o(a)("Manager")),1)]),e("button",{onClick:u[0]||(u[0]=j=>c("close")),class:"p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",title:o(a)("Close")},[...u[11]||(u[11]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])],8,Nl)]),ae(kt,{tabs:ue.value,"default-tab":_e.value,"storage-key":"task-manager","section-label":"TASK",onChange:u[1]||(u[1]=j=>_e.value=j)},null,8,["tabs","default-tab"]),ae(pt,{"active-tab":_e.value,tabs:ue.value,class:"flex-1"},ft({details:de(()=>[ae(br,{task:l.task,contacts:l.contacts,"available-groups":l.availableGroups,onDateChange:We,onProgressChange:qe,onDescriptionChange:Qe,onSubjectChange:Xe,onAssignContact:Oe,onTaskGroupChange:Ye,onTaskTypeChange:Je,onDependsOnGroupChange:Ze,onAutoTrailChange:et},null,8,["task","contacts","available-groups"])]),dependencies:de(()=>[fe.value&&le.value?(r(),n("div",Ol,[ae(la,{"task-id":l.task.name,"task-name":l.task.subject,dependencies:Ie.value,dependents:Be.value,"is-blocked":Se.value,"available-tasks":Pe.value,onNavigate:He,onAdd:De,onRemove:u[2]||(u[2]=j=>Ne(j))},null,8,["task-id","task-name","dependencies","dependents","is-blocked","available-tasks"])])):(r(),Me(yo,{key:1,task:l.task,predecessors:ie.value,successors:se.value,"available-tasks":Pe.value,"is-loading":z.value,onAddDependency:De,onUpdateDependency:Ge,onRemoveDependency:Ne},null,8,["task","predecessors","successors","available-tasks","is-loading"]))]),time:de(()=>[(r(),Me(Il,{key:C.value,task:l.task,onUpdate:u[3]||(u[3]=j=>H()),onOpenManualEntry:u[4]||(u[4]=j=>A.value=!0)},null,8,["task"]))]),finance:de(()=>[fe.value&&Ue.value&&le.value?(r(),n("div",Wl,[e("h5",ql,[u[13]||(u[13]=e("i",{class:"fa-solid fa-chart-line text-orga-500"},null,-1)),T(" "+t(o(a)("Budget Burn Rate")),1)]),ae(Ea,{budget:le.value.budget||0,spent:le.value.spent||0,"show-labels":!0,size:"md"},null,8,["budget","spent"])])):v("",!0),ae(Zo,{task:l.task,onUpdateFinance:ct},null,8,["task"])]),checklist:de(()=>[ae(vn,{checklist:ce.value,"is-loading":Ce.value,"is-adding":ee.value,onAdd:h,onToggle:k,onDelete:m,onPromote:Fe},null,8,["checklist","is-loading","is-adding"])]),discussion:de(()=>[ae(bt,{doctype:"Orga Task",docname:l.task.name},null,8,["docname"])]),attachments:de(()=>[ae(In,{attachments:Te.value,"is-loading":ke.value,"is-uploading":K.value,"upload-progress":ne.value,onUpload:ze,onDelete:Ke},null,8,["attachments","is-loading","is-uploading","upload-progress"])]),actions:de(()=>[ae(tl,{task:l.task,columns:l.columns,onStatusChange:rt,onPriorityChange:ot,onNavigate:nt,onAssignToMe:lt,onDuplicate:it,onDelete:dt},null,8,["task","columns"])]),_:2},[fe.value&&be.value?{name:"cascade",fn:de(()=>[e("div",Vl,[ge.value.length>0?(r(),Me(wa,{key:0,changes:ge.value,loading:$e.value,onPreview:tt,onApply:at,onCancel:st},null,8,["changes","loading"])):(r(),n("div",zl,[u[12]||(u[12]=e("i",{class:"fa-solid fa-sitemap text-3xl mb-3 opacity-50"},null,-1)),e("p",Kl,t(o(a)("No pending cascade changes")),1),e("p",Hl,t(o(a)("Date changes on this task will show cascade impact here")),1)]))])]),key:"0"}:void 0]),1032,["active-tab","tabs"]),ae(mt,{show:A.value,"default-context":"task","default-task":l.task.name,onClose:u[5]||(u[5]=j=>A.value=!1),onCreated:u[6]||(u[6]=j=>H())},null,8,["show","default-task"]),(r(),Me(vt,{to:"body"},[O.value?(r(),n("div",Ql,[e("div",{class:"absolute inset-0 bg-black/60",onClick:u[7]||(u[7]=j=>!Y.value&&(O.value=!1))}),e("div",Xl,[e("div",Yl,[u[15]||(u[15]=e("div",{class:"w-10 h-10 rounded-full bg-red-100 dark:bg-red-900/50 flex items-center justify-center flex-shrink-0"},[e("i",{class:"fa-solid fa-triangle-exclamation text-red-600 dark:text-red-400 text-lg"})],-1)),e("h3",Zl,t(o(a)("Delete Task")),1),e("button",{onClick:u[8]||(u[8]=j=>O.value=!1),disabled:Y.value,class:"ml-auto text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors disabled:opacity-50"},[...u[14]||(u[14]=[e("i",{class:"fa-solid fa-xmark text-lg"},null,-1)])],8,Jl)]),e("div",ei,[e("p",ti,[T(t(o(a)("This will permanently delete"))+' "',1),e("strong",null,t(l.task.subject),1),T('". '+t(o(a)("This action"))+" ",1),e("strong",ai,t(o(a)("cannot be undone")),1),u[16]||(u[16]=T(". ",-1))])]),e("div",si,[e("button",{onClick:u[9]||(u[9]=j=>O.value=!1),disabled:Y.value,class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors disabled:opacity-50"},t(o(a)("Cancel")),9,ri),e("button",{onClick:ut,disabled:Y.value,class:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2 disabled:opacity-75 disabled:cursor-not-allowed"},[Y.value?(r(),n("i",ni)):(r(),n("i",li)),T(" "+t(Y.value?o(a)("Deleting..."):o(a)("Delete")),1)],8,oi)])])])):v("",!0)]))])):v("",!0)}});export{ui as _};
