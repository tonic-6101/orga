var $=(I,R,T)=>new Promise((S,N)=>{var P=m=>{try{_(T.next(m))}catch(f){N(f)}},k=m=>{try{_(T.throw(m))}catch(f){N(f)}},_=m=>m.done?S(m.value):Promise.resolve(m.value).then(P,k);_((T=T.apply(I,R)).next())});import{d as W,w as le,b as n,k as ne,c as d,e,t as s,u as o,_ as t,F as D,f as V,v as B,r as M,i as v,p as O,T as de,q as g,s as G,N as H,A as K,z as ie,o as ce,g as q,n as ue,h as ge}from"./main-BV0KycqK.js";const pe={key:0,class:"fixed inset-0 z-[100] flex items-center justify-center p-4"},me={class:"relative bg-white dark:bg-gray-900 rounded-xl shadow-2xl w-full max-w-md border border-gray-200 dark:border-gray-700"},ye={class:"flex items-center gap-3 p-5 pb-4 border-b border-gray-200 dark:border-gray-700"},xe={class:"flex-1 min-w-0"},fe={class:"text-lg font-semibold text-gray-900 dark:text-gray-100 m-0"},be={class:"text-xs text-gray-500 dark:text-gray-400 m-0 mt-0.5"},ve=["disabled"],ke={class:"p-5 space-y-4"},_e={key:0,class:"text-center py-4"},he={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},we=["disabled"],Ce={value:""},Te=["value"],$e={key:0,class:"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-3 space-y-1"},je={class:"text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider m-0"},Ae={class:"list-none p-0 m-0 space-y-1"},Ee={class:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300"},De={class:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300"},Oe={key:0,class:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300"},Se={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ne=["disabled"],Fe={value:""},Ue=["value"],Le={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},Ve={class:"flex justify-end gap-3 p-5 pt-3 border-t border-gray-200 dark:border-gray-700"},Ie=["disabled"],Re=["disabled"],Pe={key:0,class:"fa-solid fa-spinner fa-spin"},Me={key:1,class:"fa-solid fa-play"},Be=W({__name:"ApplyTemplateModal",props:{isOpen:{type:Boolean},templateName:{}},emits:["close","applied"],setup(I,{emit:R}){const T=I,S=R,{getTemplates:N,applyTemplate:P}=H(),{getProjects:k}=ie(),{success:_,error:m}=K(),f=g([]),j=g([]),b=g(""),h=g(""),x=g(!1),w=g(!1),y=G(()=>f.value.find(c=>c.name===b.value)),A=G(()=>b.value&&h.value&&!x.value);le(()=>T.isOpen,c=>$(null,null,function*(){c&&(b.value=T.templateName||"",h.value="",x.value=!1,yield F())}));function F(){return $(this,null,function*(){w.value=!0;try{const[c,i]=yield Promise.all([N({limit:100}),k({status:"Planning",limit:100})]);f.value=c.templates||[];const p=yield k({status:"Active",limit:100});j.value=[...i.projects||[],...p.projects||[]]}catch(c){console.error("Failed to load data:",c)}finally{w.value=!1}})}function E(){return $(this,null,function*(){if(A.value){x.value=!0;try{const c=yield P(h.value,b.value);_(t("Template applied"),t("Created {0} tasks, {1} milestones, and {2} dependencies.",[c.tasks_created,c.milestones_created,c.dependencies_created])),S("applied")}catch(c){console.error("Failed to apply template:",c),m(t("Apply failed"),c.message||t("Could not apply the template. Please try again.")),x.value=!1}}})}function U(){x.value||S("close")}return(c,i)=>(n(),ne(de,{to:"body"},[I.isOpen?(n(),d("div",pe,[e("div",{class:"absolute inset-0 bg-black/60",onClick:U}),e("div",me,[e("div",ye,[i[3]||(i[3]=e("div",{class:"w-10 h-10 rounded-full bg-orga-100 dark:bg-orga-900/50 flex items-center justify-center flex-shrink-0"},[e("i",{class:"fa-solid fa-play text-orga-600 dark:text-orga-400 text-lg"})],-1)),e("div",xe,[e("h2",fe,s(o(t)("Apply Template")),1),e("p",be,s(o(t)("Create tasks and milestones from a template")),1)]),e("button",{onClick:U,disabled:x.value,class:"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors disabled:opacity-50"},[...i[2]||(i[2]=[e("i",{class:"fa-solid fa-xmark text-lg"},null,-1)])],8,ve)]),e("div",ke,[w.value?(n(),d("div",_e,[...i[4]||(i[4]=[e("i",{class:"fa-solid fa-spinner fa-spin text-orga-500 text-xl"},null,-1)])])):(n(),d(D,{key:1},[e("div",null,[e("label",he,s(o(t)("Template"))+" *",1),V(e("select",{"onUpdate:modelValue":i[0]||(i[0]=p=>b.value=p),disabled:x.value,class:"w-full px-3 py-2 text-sm border rounded-lg transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600 focus:border-orga-500 dark:focus:border-orga-400 focus:ring-1 focus:ring-orga-500 dark:focus:ring-orga-400 focus:outline-none disabled:opacity-50"},[e("option",Ce,s(o(t)("Select a template...")),1),(n(!0),d(D,null,M(f.value,p=>(n(),d("option",{key:p.name,value:p.name},s(p.template_name)+" ("+s(p.task_count)+" tasks) ",9,Te))),128))],8,we),[[B,b.value]])]),y.value?(n(),d("div",$e,[e("p",je,s(o(t)("Will create:")),1),e("ul",Ae,[e("li",Ee,[i[5]||(i[5]=e("i",{class:"fa-solid fa-list-check text-xs w-4 text-center text-orga-500"},null,-1)),v(" "+s(y.value.task_count)+" "+s(y.value.task_count===1?o(t)("task"):o(t)("tasks")),1)]),e("li",De,[i[6]||(i[6]=e("i",{class:"fa-solid fa-flag text-xs w-4 text-center text-orga-500"},null,-1)),v(" "+s(y.value.milestone_count)+" "+s(y.value.milestone_count===1?o(t)("milestone"):o(t)("milestones")),1)]),y.value.dependency_count?(n(),d("li",Oe,[i[7]||(i[7]=e("i",{class:"fa-solid fa-link text-xs w-4 text-center text-orga-500"},null,-1)),v(" "+s(y.value.dependency_count)+" "+s(y.value.dependency_count===1?o(t)("dependency"):o(t)("dependencies")),1)])):O("",!0)])])):O("",!0),e("div",null,[e("label",Se,s(o(t)("Target Project"))+" *",1),V(e("select",{"onUpdate:modelValue":i[1]||(i[1]=p=>h.value=p),disabled:x.value,class:"w-full px-3 py-2 text-sm border rounded-lg transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600 focus:border-orga-500 dark:focus:border-orga-400 focus:ring-1 focus:ring-orga-500 dark:focus:ring-orga-400 focus:outline-none disabled:opacity-50"},[e("option",Fe,s(o(t)("Select a project...")),1),(n(!0),d(D,null,M(j.value,p=>(n(),d("option",{key:p.name,value:p.name},s(p.project_name)+" ("+s(p.status)+") ",9,Ue))),128))],8,Ne),[[B,h.value]]),e("p",Le,s(o(t)("Dates will be relative to the project's start date.")),1)])],64))]),e("div",Ve,[e("button",{onClick:U,disabled:x.value,class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors disabled:opacity-50"},s(o(t)("Cancel")),9,Ie),e("button",{onClick:E,disabled:!A.value,class:"px-4 py-2 text-sm font-medium text-white bg-orga-500 rounded-lg hover:bg-orga-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"},[x.value?(n(),d("i",Pe)):(n(),d("i",Me)),v(" "+s(x.value?o(t)("Applying..."):o(t)("Apply Template")),1)],8,Re)])])])):O("",!0)]))}}),Je={class:"p-6 bg-white dark:bg-gray-950 min-h-full"},ze={class:"flex justify-between items-center mb-6"},Ge={class:"flex items-center gap-3"},qe={class:"text-2xl font-semibold text-gray-800 dark:text-gray-100 m-0"},We={key:0,class:"px-2 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 rounded-full text-xs font-medium"},He=["disabled"],Ke={key:0,class:"fa-solid fa-spinner fa-spin"},Qe={key:1,class:"fa-solid fa-file-import"},Xe={class:"flex gap-4 mb-6"},Ye={value:""},Ze=["value"],et={key:0,class:"flex items-center justify-center py-12"},tt={class:"text-center"},at={class:"text-gray-500 dark:text-gray-400"},st={key:1,class:"bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 rounded-lg p-6"},ot={class:"flex items-center gap-3"},rt={class:"text-red-800 dark:text-red-300 font-medium"},lt={class:"text-red-600 dark:text-red-400 text-sm"},nt={key:2,class:"text-center py-12"},dt={class:"text-lg font-medium text-gray-800 dark:text-gray-100 mb-2"},it={class:"text-gray-500 dark:text-gray-400 mb-4"},ct={key:3,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5"},ut={key:0,class:"space-y-3"},gt=["placeholder"],pt=["placeholder"],mt=["value"],yt={class:"flex justify-end gap-2"},xt=["disabled"],ft=["disabled"],bt={key:0,class:"fa-solid fa-spinner fa-spin mr-1"},vt={class:"flex justify-between items-start mb-3"},kt={class:"text-base font-semibold text-gray-800 dark:text-gray-100 m-0 truncate flex-1 mr-2"},_t={key:0,class:"text-sm text-gray-500 dark:text-gray-400 mb-3 line-clamp-2"},ht={class:"flex gap-4 mb-3 text-sm text-gray-600 dark:text-gray-300"},wt={class:"flex items-center gap-1"},Ct={class:"flex items-center gap-1"},Tt={key:1,class:"text-xs text-gray-500 dark:text-gray-400 mb-3"},$t={class:"flex justify-between items-center text-xs text-gray-500 dark:text-gray-400 mb-4"},jt={key:0},At={key:1},Et={class:"flex justify-between items-center pt-3 border-t border-gray-200 dark:border-gray-700"},Dt=["onClick"],Ot={class:"flex gap-1"},St=["onClick","title"],Nt=["onClick","title"],Ft=["onClick","title"],Vt=W({__name:"Templates",setup(I){const{getTemplates:R,deleteTemplate:T,exportTemplate:S,importTemplate:N,updateTemplate:P}=H(),{success:k,error:_}=K(),m=g([]),f=g(!0),j=g(null),b=g(""),h=g(!1),x=g(void 0),w=g(null),y=g(""),A=g(""),F=g("General"),E=g(!1),U=g(null),c=g(!1),i=["General","Marketing","Engineering","Operations","Other"];function p(r){const a={General:"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300",Marketing:"bg-purple-100 dark:bg-purple-900/40 text-purple-600 dark:text-purple-400",Engineering:"bg-blue-100 dark:bg-blue-900/40 text-blue-600 dark:text-blue-400",Operations:"bg-orange-100 dark:bg-orange-900/40 text-orange-600 dark:text-orange-400",Other:"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300"};return a[r]||a.Other}function Q(r){return r?new Date(r).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):""}function L(){return $(this,null,function*(){f.value=!0,j.value=null;try{const r={};b.value&&(r.category=b.value);const a=yield R(r);m.value=a.templates||[]}catch(r){console.error("Failed to load templates:",r),j.value=r.message||"Failed to load templates"}finally{f.value=!1}})}function X(r){return $(this,null,function*(){try{const a=yield S(r.name),l=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),u=URL.createObjectURL(l),C=document.createElement("a");C.href=u,C.download=`${r.template_name.replace(/\s+/g,"_").toLowerCase()}.json`,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(u),k(t("Exported"),t('Template "{0}" downloaded as JSON.',[r.template_name]))}catch(a){console.error("Failed to export template:",a),_(t("Export failed"),a.message||t("Could not export the template."))}})}function Y(r){return $(this,null,function*(){if(confirm(`Delete template "${r.template_name}"? This cannot be undone.`))try{yield T(r.name),k(t("Deleted"),t('Template "{0}" has been deleted.',[r.template_name])),yield L()}catch(a){console.error("Failed to delete template:",a),_(t("Delete failed"),a.message||t("Could not delete the template."))}})}function Z(r){x.value=r.name,h.value=!0}function ee(r){w.value=r.name,y.value=r.template_name,A.value=r.description||"",F.value=r.category}function te(){w.value=null}function ae(){return $(this,null,function*(){if(!(!w.value||!y.value.trim())){E.value=!0;try{yield P(w.value,{template_name:y.value.trim(),description:A.value.trim(),category:F.value}),k(t("Updated"),t("Template updated successfully.")),w.value=null,yield L()}catch(r){console.error("Failed to update template:",r),_(t("Update failed"),r.message||t("Could not update the template."))}finally{E.value=!1}}})}function J(){var r;(r=U.value)==null||r.click()}function se(r){return $(this,null,function*(){var u;const a=r.target,l=(u=a.files)==null?void 0:u[0];if(l){c.value=!0;try{const C=yield l.text(),re=JSON.parse(C),z=yield N(re);k(t("Imported"),t('Template "{0}" imported with {1} tasks.',[z.template_name,z.task_count])),yield L()}catch(C){console.error("Failed to import template:",C),_(t("Import failed"),C.message||t("Could not import the template. Please check the file format."))}finally{c.value=!1,a&&(a.value="")}}})}function oe(){h.value=!1,k(t("Template applied"),t("Tasks, milestones, and dependencies have been created."))}return ce(L),(r,a)=>(n(),d("div",Je,[e("div",ze,[e("div",Ge,[e("h1",qe,s(o(t)("Templates")),1),m.value.length>0?(n(),d("span",We,s(m.value.length),1)):O("",!0)]),e("button",{onClick:J,disabled:c.value,class:"px-4 py-2 bg-orga-500 text-white rounded hover:bg-orga-600 flex items-center gap-2 disabled:opacity-50"},[c.value?(n(),d("i",Ke)):(n(),d("i",Qe)),v(" "+s(o(t)("Import Template")),1)],8,He),e("input",{ref_key:"fileInputRef",ref:U,type:"file",accept:".json",class:"hidden",onChange:se},null,544)]),e("div",Xe,[V(e("select",{"onUpdate:modelValue":a[0]||(a[0]=l=>b.value=l),onChange:L,class:"px-3 py-2 border border-gray-200 dark:border-gray-600 rounded text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"},[e("option",Ye,s(o(t)("All Categories")),1),(n(),d(D,null,M(i,l=>e("option",{key:l,value:l},s(l),9,Ze)),64))],544),[[B,b.value]])]),f.value?(n(),d("div",et,[e("div",tt,[a[5]||(a[5]=e("i",{class:"fa-solid fa-spinner fa-spin text-3xl text-orga-500 mb-3"},null,-1)),e("p",at,s(o(t)("Loading templates...")),1)])])):j.value?(n(),d("div",st,[e("div",ot,[a[6]||(a[6]=e("i",{class:"fa-solid fa-exclamation-triangle text-red-500 text-xl"},null,-1)),e("div",null,[e("h3",rt,s(o(t)("Error loading templates")),1),e("p",lt,s(j.value),1)])]),e("button",{onClick:L,class:"mt-4 px-4 py-2 bg-red-100 dark:bg-red-900/40 text-red-700 dark:text-red-300 rounded hover:bg-red-200 dark:hover:bg-red-900/60"},s(o(t)("Try Again")),1)])):m.value.length===0?(n(),d("div",nt,[a[8]||(a[8]=e("i",{class:"fa-solid fa-copy text-5xl text-gray-300 dark:text-gray-600 mb-4"},null,-1)),e("h3",dt,s(o(t)("No templates yet")),1),e("p",it,s(o(t)("Save a project as a template, or import one from a JSON file.")),1),e("button",{onClick:J,class:"px-4 py-2 bg-orga-500 text-white rounded hover:bg-orga-600"},[a[7]||(a[7]=e("i",{class:"fa-solid fa-file-import mr-2"},null,-1)),v(" "+s(o(t)("Import Template")),1)])])):(n(),d("div",ct,[(n(!0),d(D,null,M(m.value,l=>(n(),d("div",{key:l.name,class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-5 hover:shadow-lg dark:hover:shadow-gray-950/50 transition-shadow"},[w.value===l.name?(n(),d("div",ut,[V(e("input",{"onUpdate:modelValue":a[1]||(a[1]=u=>y.value=u),type:"text",class:"w-full px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:border-orga-500 focus:outline-none",placeholder:o(t)("Template name")},null,8,gt),[[q,y.value]]),V(e("textarea",{"onUpdate:modelValue":a[2]||(a[2]=u=>A.value=u),rows:"2",class:"w-full px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:border-orga-500 focus:outline-none",placeholder:o(t)("Description")},null,8,pt),[[q,A.value]]),V(e("select",{"onUpdate:modelValue":a[3]||(a[3]=u=>F.value=u),class:"w-full px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:border-orga-500 focus:outline-none"},[(n(),d(D,null,M(i,u=>e("option",{key:u,value:u},s(u),9,mt)),64))],512),[[B,F.value]]),e("div",yt,[e("button",{onClick:te,disabled:E.value,class:"px-3 py-1 text-xs text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200"},s(o(t)("Cancel")),9,xt),e("button",{onClick:ae,disabled:!y.value.trim()||E.value,class:"px-3 py-1 text-xs bg-orga-500 text-white rounded hover:bg-orga-600 disabled:opacity-50"},[E.value?(n(),d("i",bt)):O("",!0),v(" "+s(o(t)("Save")),1)],8,ft)])])):(n(),d(D,{key:1},[e("div",vt,[e("h3",kt,s(l.template_name),1),e("span",{class:ue(["px-2 py-1 rounded-xl text-xs font-medium whitespace-nowrap",p(l.category)])},s(l.category),3)]),l.description?(n(),d("p",_t,s(l.description),1)):O("",!0),e("div",ht,[e("span",wt,[a[9]||(a[9]=e("i",{class:"fa-solid fa-list-check text-xs text-gray-400"},null,-1)),v(" "+s(l.task_count===1?o(t)("1 task"):o(t)("{0} tasks",[l.task_count])),1)]),e("span",Ct,[a[10]||(a[10]=e("i",{class:"fa-solid fa-flag text-xs text-gray-400"},null,-1)),v(" "+s(l.milestone_count===1?o(t)("1 milestone"):o(t)("{0} milestones",[l.milestone_count])),1)])]),l.dependency_count?(n(),d("div",Tt,[a[11]||(a[11]=e("i",{class:"fa-solid fa-link text-xs mr-1"},null,-1)),v(" "+s(l.dependency_count===1?o(t)("1 dependency"):o(t)("{0} dependencies",[l.dependency_count])),1)])):O("",!0),e("div",$t,[l.source_project_name?(n(),d("span",jt,s(o(t)("From: {0}",[l.source_project_name])),1)):(n(),d("span",At,"Â ")),e("span",null,s(Q(l.modified)),1)]),e("div",Et,[e("button",{onClick:u=>Z(l),class:"px-3 py-1.5 text-xs font-medium bg-orga-500 text-white rounded hover:bg-orga-600 transition-colors flex items-center gap-1"},[a[12]||(a[12]=e("i",{class:"fa-solid fa-play text-[10px]"},null,-1)),v(" "+s(o(t)("Apply")),1)],8,Dt),e("div",Ot,[e("button",{onClick:u=>X(l),class:"p-1.5 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",title:o(t)("Export JSON")},[...a[13]||(a[13]=[e("i",{class:"fa-solid fa-download text-sm"},null,-1)])],8,St),e("button",{onClick:u=>ee(l),class:"p-1.5 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",title:o(t)("Edit")},[...a[14]||(a[14]=[e("i",{class:"fa-solid fa-pen text-sm"},null,-1)])],8,Nt),e("button",{onClick:u=>Y(l),class:"p-1.5 text-gray-400 dark:text-gray-500 hover:text-red-500 dark:hover:text-red-400 transition-colors",title:o(t)("Delete")},[...a[15]||(a[15]=[e("i",{class:"fa-solid fa-trash text-sm"},null,-1)])],8,Ft)])])],64))]))),128))])),ge(Be,{"is-open":h.value,"template-name":x.value,onClose:a[4]||(a[4]=l=>h.value=!1),onApplied:oe},null,8,["is-open","template-name"])]))}});export{Vt as default};
